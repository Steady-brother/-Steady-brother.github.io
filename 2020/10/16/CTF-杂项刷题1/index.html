<!DOCTYPE html>
<html lang=zh>
<head>
  <meta charset="utf-8">
  
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1, user-scalable=no, minimal-ui">
  <meta name="renderer" content="webkit">
  <meta http-equiv="Cache-Control" content="no-transform" />
  <meta http-equiv="Cache-Control" content="no-siteapp" />
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  <meta name="format-detection" content="telephone=no,email=no,adress=no">
  <!-- Color theme for statusbar -->
  <meta name="theme-color" content="#000000" />
  <!-- 强制页面在当前窗口以独立页面显示,防止别人在框架里调用页面 -->
  <meta http-equiv="window-target" content="_top" />
  
  
  <title>CTF-杂项刷题2 | Hexo</title>
  <meta name="description" content="中国移动音频隐写SYN01 powpow拿到一个mp4文件，首先想到分帧。 1ffmpeg -i flag.mp4 -f image2 image%d.jpg  拿到200+图片，但是查看图片没有什么异常，查看文件属性，有一串base64，解密： 1http:&#x2F;&#x2F;steghide.sourceforge.net&#x2F;  提示steghide，但是该工具只能使用jpg，想到">
<meta property="og:type" content="article">
<meta property="og:title" content="CTF-杂项刷题2">
<meta property="og:url" content="http://s1eady.top/2020/10/16/CTF-%E6%9D%82%E9%A1%B9%E5%88%B7%E9%A2%981/index.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:description" content="中国移动音频隐写SYN01 powpow拿到一个mp4文件，首先想到分帧。 1ffmpeg -i flag.mp4 -f image2 image%d.jpg  拿到200+图片，但是查看图片没有什么异常，查看文件属性，有一串base64，解密： 1http:&#x2F;&#x2F;steghide.sourceforge.net&#x2F;  提示steghide，但是该工具只能使用jpg，想到">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://steady-1302023625.cos.ap-beijing.myqcloud.com/makedown/58.png">
<meta property="og:image" content="https://steady-1302023625.cos.ap-beijing.myqcloud.com/makedown/40.png">
<meta property="og:image" content="https://steady-1302023625.cos.ap-beijing.myqcloud.com/makedown/41.png">
<meta property="og:image" content="https://steady-1302023625.cos.ap-beijing.myqcloud.com/makedown/42.png">
<meta property="og:image" content="https://steady-1302023625.cos.ap-beijing.myqcloud.com/makedown/43.png">
<meta property="og:image" content="https://steady-1302023625.cos.ap-beijing.myqcloud.com/makedown/44.png">
<meta property="og:image" content="https://steady-1302023625.cos.ap-beijing.myqcloud.com/makedown/46.png">
<meta property="article:published_time" content="2020-10-15T18:20:17.000Z">
<meta property="article:modified_time" content="2020-11-06T11:28:43.695Z">
<meta property="article:author" content="John Doe">
<meta property="article:tag" content="CTF-杂项">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://steady-1302023625.cos.ap-beijing.myqcloud.com/makedown/58.png">
  <!-- Canonical links -->
  <link rel="canonical" href="http://s1eady.top/2020/10/16/CTF-%E6%9D%82%E9%A1%B9%E5%88%B7%E9%A2%981/index.html">
  
    <link rel="alternate" href="/atom.xml" title="Hexo" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png" type="image/x-icon">
  
  
<link rel="stylesheet" href="/css/style.css">

  
  
  
  
<meta name="generator" content="Hexo 5.2.0"></head>


<body class="main-center theme-black" itemscope itemtype="http://schema.org/WebPage">
  <header class="header" itemscope itemtype="http://schema.org/WPHeader">
  <div class="slimContent">
    <div class="navbar-header">
      
      
      <div class="profile-block text-center">
        <a id="avatar" href="https://github.com/cofess" target="_blank">
          <img class="img-circle img-rotate" src="/images/1.jpg" width="200" height="200">
        </a>
        <h2 id="name" class="hidden-xs hidden-sm">果冻</h2>
        <h3 id="title" class="hidden-xs hidden-sm hidden-md">Penetration Testing</h3>
        <small id="location" class="text-muted hidden-xs hidden-sm"><i class="icon icon-map-marker"></i> 中国 南京</small>
      </div>
      
      <div class="search" id="search-form-wrap">

    <form class="search-form sidebar-form">
        <div class="input-group">
            <input type="text" class="search-form-input form-control" placeholder="搜索" />
            <span class="input-group-btn">
                <button type="submit" class="search-form-submit btn btn-flat" onclick="return false;"><i class="icon icon-search"></i></button>
            </span>
        </div>
    </form>
    <div class="ins-search">
  <div class="ins-search-mask"></div>
  <div class="ins-search-container">
    <div class="ins-input-wrapper">
      <input type="text" class="ins-search-input" placeholder="想要查找什么..." x-webkit-speech />
      <button type="button" class="close ins-close ins-selectable" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">×</span></button>
    </div>
    <div class="ins-section-wrapper">
      <div class="ins-section-container"></div>
    </div>
  </div>
</div>


</div>
      <button class="navbar-toggle collapsed" type="button" data-toggle="collapse" data-target="#main-navbar" aria-controls="main-navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
    </div>
    <nav id="main-navbar" class="collapse navbar-collapse" itemscope itemtype="http://schema.org/SiteNavigationElement" role="navigation">
      <ul class="nav navbar-nav main-nav ">
        
        
        <li class="menu-item menu-item-home">
          <a href="/.">
            
            <i class="icon icon-home-fill"></i>
            
            <span class="menu-title">首页</span>
          </a>
        </li>
        
        
        <li class="menu-item menu-item-archives">
          <a href="/archives">
            
            <i class="icon icon-archives-fill"></i>
            
            <span class="menu-title">归档</span>
          </a>
        </li>
        
        
        <li class="menu-item menu-item-categories">
          <a href="/categories">
            
            <i class="icon icon-folder"></i>
            
            <span class="menu-title">分类</span>
          </a>
        </li>
        
        
        <li class="menu-item menu-item-about">
          <a href="/about">
            
            <i class="icon icon-cup-fill"></i>
            
            <span class="menu-title">关于</span>
          </a>
        </li>
        
      </ul>
      
	
    <ul class="social-links">
    	
        <li><a href="/GXA111666" target="_blank" title="VX" data-toggle=tooltip data-placement=top><i class="icon icon-VX"></i></a></li>
        
        <li><a href="/1252195810" target="_blank" title="QQ" data-toggle=tooltip data-placement=top><i class="icon icon-QQ"></i></a></li>
        
        <li><a href="/1252195810@qq.com" target="_blank" title="E-Mail" data-toggle=tooltip data-placement=top><i class="icon icon-E-mail"></i></a></li>
        
        <li><a href="/atom.xml" target="_blank" title="Rss" data-toggle=tooltip data-placement=top><i class="icon icon-rss"></i></a></li>
        
    </ul>

    </nav>
  </div>
</header>

  
    <aside class="sidebar" itemscope itemtype="http://schema.org/WPSideBar">
  <div class="slimContent">
    
      <div class="widget">
    <h3 class="widget-title">公告</h3>
    <div class="widget-body">
        <div id="board">
            <div class="content">
                <p>深山夕照深秋雨 一往情深深几许</p>
            </div>
        </div>
    </div>
</div>

    
  </div>
</aside>

  
  
<aside class="sidebar sidebar-toc collapse" id="collapseToc" itemscope itemtype="http://schema.org/WPSideBar">
  <div class="slimContent">
    <nav id="toc" class="article-toc">
      <h3 class="toc-title">文章目录</h3>
      <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%B8%AD%E5%9B%BD%E7%A7%BB%E5%8A%A8"><span class="toc-number">1.</span> <span class="toc-text">中国移动</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%9F%B3%E9%A2%91%E9%9A%90%E5%86%99"><span class="toc-number">1.1.</span> <span class="toc-text">音频隐写</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#SYN01-powpow"><span class="toc-number">1.1.1.</span> <span class="toc-text">SYN01 powpow</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#SYN03-binwalk"><span class="toc-number">1.1.2.</span> <span class="toc-text">SYN03 binwalk</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#SYN02-Easy-stegano"><span class="toc-number">1.1.3.</span> <span class="toc-text">SYN02 Easy_stegano</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#slowed"><span class="toc-number">1.1.4.</span> <span class="toc-text">slowed</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%85%B6%E4%BB%96%E9%9A%90%E5%86%99"><span class="toc-number">1.2.</span> <span class="toc-text">其他隐写</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#FRA05-syclovergeek"><span class="toc-number">1.2.1.</span> <span class="toc-text">FRA05 syclovergeek</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#FRA04-godwave"><span class="toc-number">1.2.2.</span> <span class="toc-text">FRA04 godwave</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#FRA06-Ogrewatch"><span class="toc-number">1.2.3.</span> <span class="toc-text">FRA06 Ogrewatch</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E8%93%9D%E9%B2%B8%E5%AE%89%E5%85%A8"><span class="toc-number">2.</span> <span class="toc-text">蓝鲸安全</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%9D%82%E9%A1%B9"><span class="toc-number">2.1.</span> <span class="toc-text">杂项</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%88%91%E4%BB%AC%E4%B8%8D%E4%B8%80%E6%A0%B7"><span class="toc-number">2.1.1.</span> <span class="toc-text">我们不一样</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#BuuCtf"><span class="toc-number">3.</span> <span class="toc-text">BuuCtf</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%9D%82%E9%A1%B9-1"><span class="toc-number">3.1.</span> <span class="toc-text">杂项</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%87%91%E4%B8%89%E8%83%96"><span class="toc-number">3.1.1.</span> <span class="toc-text">金三胖</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BA%8C%E7%BB%B4%E7%A0%81"><span class="toc-number">3.1.2.</span> <span class="toc-text">二维码</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#N%E7%A7%8D%E6%96%B9%E6%B3%95%E8%A7%A3%E5%86%B3"><span class="toc-number">3.1.3.</span> <span class="toc-text">N种方法解决</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%A4%A7%E7%99%BD"><span class="toc-number">3.1.4.</span> <span class="toc-text">大白</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BD%A0%E7%AB%9F%E7%84%B6%E8%B5%B6%E6%88%91%E8%B5%B0"><span class="toc-number">3.1.5.</span> <span class="toc-text">你竟然赶我走</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9F%BA%E7%A1%80%E7%A0%B4%E8%A7%A3"><span class="toc-number">3.1.6.</span> <span class="toc-text">基础破解</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B9%8C%E9%95%87%E5%B3%B0%E4%BC%9A%E7%A7%8D%E5%9B%BE"><span class="toc-number">3.1.7.</span> <span class="toc-text">乌镇峰会种图</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#LSB"><span class="toc-number">3.1.8.</span> <span class="toc-text">LSB</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%96%87%E4%BB%B6%E4%B8%AD%E7%9A%84%E7%A7%98%E5%AF%86"><span class="toc-number">3.1.9.</span> <span class="toc-text">文件中的秘密</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#wireshark"><span class="toc-number">3.1.10.</span> <span class="toc-text">wireshark</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ningen"><span class="toc-number">3.1.11.</span> <span class="toc-text">ningen</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%95%9C%E5%AD%90%E9%87%8C%E9%9D%A2%E7%9A%84%E4%B8%96%E7%95%8C"><span class="toc-number">3.1.12.</span> <span class="toc-text">镜子里面的世界</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%A2%AB%E5%97%85%E6%8E%A2%E7%9A%84%E6%B5%81%E9%87%8F"><span class="toc-number">3.1.13.</span> <span class="toc-text">被嗅探的流量</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B0%8F%E6%98%8E%E7%9A%84%E4%BF%9D%E9%99%A9%E7%AE%B1"><span class="toc-number">3.1.14.</span> <span class="toc-text">小明的保险箱</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%88%B1%E5%9B%A0%E6%96%AF%E5%9D%A6"><span class="toc-number">3.1.15.</span> <span class="toc-text">爱因斯坦</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8F%A6%E5%A4%96%E4%B8%80%E4%B8%AA%E4%B8%96%E7%95%8C"><span class="toc-number">3.1.16.</span> <span class="toc-text">另外一个世界</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#FLAG"><span class="toc-number">3.1.17.</span> <span class="toc-text">FLAG</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%81%87%E5%A6%82%E7%BB%99%E6%88%91%E4%B8%89%E5%A4%A9%E5%85%89%E6%98%8E"><span class="toc-number">3.1.18.</span> <span class="toc-text">假如给我三天光明</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%9A%90%E8%97%8F%E7%9A%84%E5%AF%86%E7%A0%81"><span class="toc-number">3.1.19.</span> <span class="toc-text">隐藏的密码</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#BJDCTF-2nd-%E6%9C%80%E7%AE%80%E5%8D%95%E7%9A%84misc-y1ng"><span class="toc-number">3.1.20.</span> <span class="toc-text">[BJDCTF 2nd]最简单的misc-y1ng</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#BJDCTF-2nd-A-Beautiful-Picture"><span class="toc-number">3.1.21.</span> <span class="toc-text">[BJDCTF 2nd]A_Beautiful_Picture</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%A5%9E%E7%A7%98%E9%BE%99%E5%8D%B7%E9%A3%8E"><span class="toc-number">3.1.22.</span> <span class="toc-text">神秘龙卷风</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%BD%E5%B8%A6%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2"><span class="toc-number">3.1.23.</span> <span class="toc-text">宽带信息泄露</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9D%A5%E9%A6%96%E6%AD%8C%E6%9B%B2"><span class="toc-number">3.1.24.</span> <span class="toc-text">来首歌曲</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E5%8C%85%E4%B8%AD%E7%9A%84%E7%BA%BF%E7%B4%A2"><span class="toc-number">3.1.25.</span> <span class="toc-text">数据包中的线索</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B9%9D%E8%BF%9E%E7%8E%AF"><span class="toc-number">3.1.26.</span> <span class="toc-text">九连环</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%9D%A2%E5%85%B7%E4%B8%8B%E7%9A%84flag"><span class="toc-number">3.1.27.</span> <span class="toc-text">面具下的flag</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%B7%E6%96%B0%E8%BF%87%E7%9A%84%E5%9B%BE%E7%89%87"><span class="toc-number">3.1.28.</span> <span class="toc-text">刷新过的图片</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A2%85%E8%8A%B1%E9%A6%99%E4%B9%8B%E8%8B%A6%E5%AF%92%E6%9D%A5"><span class="toc-number">3.1.29.</span> <span class="toc-text">梅花香之苦寒来</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#BJDCTF-2nd-%E5%9C%A3%E7%81%AB%E6%98%AD%E6%98%AD-y1ng"><span class="toc-number">3.1.30.</span> <span class="toc-text">[BJDCTF 2nd]圣火昭昭-y1ng</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#BJDCTF2020-%E8%AE%A4%E7%9C%9F%E4%BD%A0%E5%B0%B1%E8%BE%93%E4%BA%86"><span class="toc-number">3.1.31.</span> <span class="toc-text">[BJDCTF2020]认真你就输了</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#BJDCTF-2nd-EasyBaBa"><span class="toc-number">3.1.32.</span> <span class="toc-text">[BJDCTF 2nd]EasyBaBa</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#SWPU2019-%E7%A5%9E%E5%A5%87%E7%9A%84%E4%BA%8C%E7%BB%B4%E7%A0%81"><span class="toc-number">3.1.33.</span> <span class="toc-text">[SWPU2019]神奇的二维码</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#BJDCTF2020-%E4%BD%A0%E7%8C%9C%E6%88%91%E6%98%AF%E4%B8%AA%E5%95%A5"><span class="toc-number">3.1.34.</span> <span class="toc-text">[BJDCTF2020]你猜我是个啥</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#BJDCTF2020-%E4%B8%80%E5%8F%B6%E9%9A%9C%E7%9B%AE"><span class="toc-number">3.1.35.</span> <span class="toc-text">[BJDCTF2020]一叶障目</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#BJDCTF2020-%E9%B8%A1%E4%BD%A0%E5%A4%AA%E7%BE%8E"><span class="toc-number">3.1.36.</span> <span class="toc-text">[BJDCTF2020]鸡你太美</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ACTF%E6%96%B0%E7%94%9F%E8%B5%9B2020-outguess"><span class="toc-number">3.1.37.</span> <span class="toc-text">[ACTF新生赛2020]outguess</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%B0%81%E8%B5%A2%E4%BA%86%E6%AF%94%E8%B5%9B%EF%BC%9F"><span class="toc-number">3.1.38.</span> <span class="toc-text">谁赢了比赛？</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%96%B5%E5%96%B5%E5%96%B5"><span class="toc-number">3.1.39.</span> <span class="toc-text">喵喵喵</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#BJDCTF-2nd-TARGZ-y1ng"><span class="toc-number">3.1.40.</span> <span class="toc-text">[BJDCTF 2nd]TARGZ-y1ng</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#GXYCTF2019-gakki"><span class="toc-number">3.1.41.</span> <span class="toc-text">[GXYCTF2019]gakki</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#HBNIS2018-excel%E7%A0%B4%E8%A7%A3"><span class="toc-number">3.1.42.</span> <span class="toc-text">[HBNIS2018]excel破解</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#SWPU2019-%E4%BC%9F%E5%A4%A7%E7%9A%84%E4%BE%A6%E6%8E%A2"><span class="toc-number">3.1.43.</span> <span class="toc-text">[SWPU2019]伟大的侦探</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%BC%B1%E5%8F%A3%E4%BB%A4"><span class="toc-number">3.1.44.</span> <span class="toc-text">弱口令</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ACTF%E6%96%B0%E7%94%9F%E8%B5%9B2020-base64%E9%9A%90%E5%86%99"><span class="toc-number">3.1.45.</span> <span class="toc-text">[ACTF新生赛2020]base64隐写</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#HBNIS2018-%E6%9D%A5%E9%A2%98%E4%B8%AD%E7%AD%89%E7%9A%84%E5%90%A7"><span class="toc-number">3.1.46.</span> <span class="toc-text">[HBNIS2018]来题中等的吧</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%BB%91%E5%AE%A2%E5%B8%9D%E5%9B%BD"><span class="toc-number">3.1.47.</span> <span class="toc-text">黑客帝国</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#WUSTCTF2020-find-me"><span class="toc-number">3.1.48.</span> <span class="toc-text">[WUSTCTF2020]find_me</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#MRCTF2020-%E4%BD%A0%E8%83%BD%E7%9C%8B%E6%87%82%E9%9F%B3%E7%AC%A6%E5%90%97"><span class="toc-number">3.1.49.</span> <span class="toc-text">[MRCTF2020]你能看懂音符吗</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%9C%8B%E7%BD%91%E8%AF%BE"><span class="toc-number">3.1.50.</span> <span class="toc-text">看网课</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#HBNIS2018-%E4%BD%8E%E4%B8%AA%E5%A4%B4"><span class="toc-number">3.1.51.</span> <span class="toc-text">[HBNIS2018]低个头</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%97%B4%E8%B0%8D%E5%90%AF%E7%A4%BA%E5%BD%95"><span class="toc-number">3.1.52.</span> <span class="toc-text">间谍启示录</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%88%91%E5%90%83%E4%B8%89%E6%98%8E%E6%B2%BB"><span class="toc-number">3.1.53.</span> <span class="toc-text">我吃三明治</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#DDCTF2018-%E2%95%AF%C2%B0%E2%96%A1%C2%B0%EF%BC%89%E2%95%AF%EF%B8%B5-%E2%94%BB%E2%94%81%E2%94%BB"><span class="toc-number">3.1.54.</span> <span class="toc-text">[DDCTF2018](╯°□°）╯︵ ┻━┻</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%99%BE%E9%87%8C%E6%8C%91%E4%B8%80"><span class="toc-number">3.1.55.</span> <span class="toc-text">百里挑一</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#WUSTCTF2020-alison-likes-jojo"><span class="toc-number">3.1.56.</span> <span class="toc-text">[WUSTCTF2020]alison_likes_jojo</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%89%E6%B4%B5%E6%9D%AF-2019-Attack"><span class="toc-number">3.1.57.</span> <span class="toc-text">[安洵杯 2019]Attack</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#USB"><span class="toc-number">3.1.58.</span> <span class="toc-text">USB</span></a></li></ol></li></ol></li></ol>
    </nav>
  </div>
</aside>

<main class="main" role="main">
  <div class="content">
  <article id="post-CTF-杂项刷题1" class="article article-type-post" itemscope itemtype="http://schema.org/BlogPosting">
    
    <div class="article-header">
      
        
  
    <h1 class="article-title" itemprop="name">
      CTF-杂项刷题2
    </h1>
  

      
      <div class="article-meta">
        <span class="article-date">
    <i class="icon icon-calendar-check"></i>
	<a href="/2020/10/16/CTF-%E6%9D%82%E9%A1%B9%E5%88%B7%E9%A2%981/" class="article-date">
	  <time datetime="2020-10-15T18:20:17.000Z" itemprop="datePublished">2020-10-16</time>
	</a>
</span>
        
  <span class="article-category">
    <i class="icon icon-folder"></i>
    <a class="article-category-link" href="/categories/CTF-%E6%9D%82%E9%A1%B9/">CTF-杂项</a>
  </span>

        
  <span class="article-tag">
    <i class="icon icon-tags"></i>
	<a class="article-tag-link-link" href="/tags/CTF-%E6%9D%82%E9%A1%B9/" rel="tag">CTF-杂项</a>
  </span>


        

        <span class="post-comment"><i class="icon icon-comment"></i> <a href="/2020/10/16/CTF-%E6%9D%82%E9%A1%B9%E5%88%B7%E9%A2%981/#comments" class="article-comment-link">评论</a></span>
        
      </div>
    </div>
    <div class="article-entry marked-body" itemprop="articleBody">
      
        <h1 id="中国移动"><a href="#中国移动" class="headerlink" title="中国移动"></a>中国移动</h1><h2 id="音频隐写"><a href="#音频隐写" class="headerlink" title="音频隐写"></a>音频隐写</h2><h3 id="SYN01-powpow"><a href="#SYN01-powpow" class="headerlink" title="SYN01 powpow"></a>SYN01 powpow</h3><p>拿到一个mp4文件，首先想到分帧。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ffmpeg -i flag.mp4 -f image2 image%d.jpg</span><br></pre></td></tr></table></figure>

<p>拿到200+图片，但是查看图片没有什么异常，查看文件属性，有一串base64，解密：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:&#x2F;&#x2F;steghide.sourceforge.net&#x2F;</span><br></pre></td></tr></table></figure>

<p>提示steghide，但是该工具只能使用jpg，想到分离出来的jpg，但是文件太多也不现实。直接binwalk分析MP4</p>
<p>文件。</p>
<p>藏有一个png，使用工具将png转化为jpg，然后使用steghide，密码为password。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">stepic -d -i image.png  &gt; image.jpg</span><br><span class="line">steghide extract -sf image.jpg -p password</span><br><span class="line">wrote extracted data to &quot;base64.txt&quot;</span><br></pre></td></tr></table></figure>

<p>python base85拿到flag。</p>
<h3 id="SYN03-binwalk"><a href="#SYN03-binwalk" class="headerlink" title="SYN03 binwalk"></a>SYN03 binwalk</h3><p>提示binwalk，直接分离分离出两张图片，盲水印、compare、stegsolve都试过了，然后最后<code>zsteg</code>拿到flag。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">b8,bgr,msb,yX,prime .. text: &quot;~r0&gt;2Paj()z&quot;</span><br><span class="line">b1,r,lsb,xY         .. text: &quot;ISG&#123;E4sY_StEg4n0gR4pHy&#125;&quot;</span><br><span class="line">b2,r,lsb,xY         .. text: &quot;&gt;PUUUUUUUU&quot;</span><br><span class="line">b2,g,msb,xY         .. file: BIOS (ia32) ROM Ext. (252*512)</span><br></pre></td></tr></table></figure>

<p>可以看到在r的0通道拿到flag。所以直接<code>stegsolve</code>的<code>data extract</code>。</p>
<h3 id="SYN02-Easy-stegano"><a href="#SYN02-Easy-stegano" class="headerlink" title="SYN02 Easy_stegano"></a>SYN02 Easy_stegano</h3><p>拿到一个gif，本能的分离，分离出三张图片发现没有太大的信息。直接binwalkgif。分理处一个压缩包，解压一共六个文件。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">steady@steady:~&#x2F;桌面&#x2F;steady&#x2F;1$ ls</span><br><span class="line">1.png  2.jpg  3.jpg  4.jpg  5.jpg  6.jpg  strange_file.png</span><br></pre></td></tr></table></figure>

<p>挨个文件查看。</p>
<p>第一个，在文件的最后：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">steady@steady:~&#x2F;桌面&#x2F;steady&#x2F;1$ strings 1.png </span><br><span class="line">tvUZIHDQ</span><br><span class="line">IEND</span><br><span class="line">Lets begin:</span><br><span class="line">3tKdX</span><br></pre></td></tr></table></figure>

<p>第二个提示另一种方式，使用outguess，</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">steady@steady:~&#x2F;桌面&#x2F;steady&#x2F;1$ strings 2.jpg</span><br><span class="line">Di$60</span><br><span class="line">WM(&amp;</span><br><span class="line">Dont be stupid</span><br><span class="line">Use another method</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">steady@steady:~/桌面/steady/<span class="number">1</span>$ outguess -r <span class="number">2.j</span>pg out &amp;&amp; cat out</span><br><span class="line">Reading <span class="number">2.j</span>pg....</span><br><span class="line">Extracting usable bits:   <span class="number">2315</span> bits</span><br><span class="line">Steg retrieve: seed: <span class="number">32</span>, len: <span class="number">16</span></span><br><span class="line">N0LWF</span><br><span class="line">Dont stop</span><br></pre></td></tr></table></figure>

<p>第三章图片，查看有PK字段，binwalk分离，</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">steady@steady:~&#x2F;桌面&#x2F;steady&#x2F;1$ strings 3.jpg</span><br><span class="line">994PK</span><br><span class="line">995PK</span><br><span class="line">996PK</span><br><span class="line">997PK</span><br><span class="line">998PK</span><br><span class="line">999PK</span><br></pre></td></tr></table></figure>

<p>拿到许多文件，文件都在压缩包内，查看CRC是不是有不同的，其中一个名字为386的文件的CRC与别的不一样。也可以计算文件的md5，可以看到文件386的md5与其他文件不一样。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">steady@steady:~&#x2F;桌面&#x2F;steady&#x2F;output&#x2F;zip&#x2F;_3.jpg.extracted$ md5sum * | sort -k1</span><br></pre></td></tr></table></figure>



<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">steady@steady:~&#x2F;桌面&#x2F;steady&#x2F;1$ strings &#x2F;home&#x2F;steady&#x2F;桌面&#x2F;steady&#x2F;368</span><br><span class="line">GoOd 3RlZ30&#x3D;</span><br></pre></td></tr></table></figure>

<p>第四个exitfool工具,</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">steady@steady:~/桌面/steady/<span class="number">1</span>$ exiftool /home/steady/桌面/steady/<span class="number">1</span>/<span class="number">4.j</span>pg</span><br><span class="line">ExifTool Version Number         : <span class="number">12.07</span></span><br><span class="line">File Name                       : <span class="number">4.j</span>pg</span><br><span class="line">Directory                       : /home/steady/桌面/steady/<span class="number">1</span></span><br><span class="line">File Size                       : <span class="number">6.9</span> kB</span><br><span class="line">File Modification Date/Time     : <span class="number">2015</span>:<span class="number">01</span>:<span class="number">18</span> <span class="number">21</span>:<span class="number">14</span>:<span class="number">24</span>+<span class="number">08</span>:<span class="number">00</span></span><br><span class="line">File Access Date/Time           : <span class="number">2020</span>:<span class="number">11</span>:<span class="number">03</span> <span class="number">14</span>:<span class="number">23</span>:<span class="number">47</span>+<span class="number">08</span>:<span class="number">00</span></span><br><span class="line">File Inode Change Date/Time     : <span class="number">2020</span>:<span class="number">11</span>:<span class="number">03</span> <span class="number">14</span>:<span class="number">23</span>:<span class="number">45</span>+<span class="number">08</span>:<span class="number">00</span></span><br><span class="line">File Permissions                : rwxrw-rw-</span><br><span class="line">File Type                       : JPEG</span><br><span class="line">File Type Extension             : jpg</span><br><span class="line">MIME Type                       : image/jpeg</span><br><span class="line">JFIF Version                    : <span class="number">1.01</span></span><br><span class="line">Resolution Unit                 : <span class="literal">None</span></span><br><span class="line">X Resolution                    : <span class="number">1</span></span><br><span class="line">Y Resolution                    : <span class="number">1</span></span><br><span class="line">Exif Byte Order                 : Little-endian (Intel, II)</span><br><span class="line"><span class="comment">#flag</span></span><br><span class="line">Artist                          : If you insist here <span class="keyword">is</span> your gift: ZmxhZ</span><br><span class="line">Comment                         : </span><br><span class="line">Image Width                     : <span class="number">187</span></span><br><span class="line">Image Height                    : <span class="number">186</span></span><br><span class="line">Encoding Process                : Baseline DCT, Huffman coding</span><br><span class="line">Bits Per Sample                 : <span class="number">8</span></span><br><span class="line">Color Components                : <span class="number">3</span></span><br><span class="line">Y Cb Cr Sub Sampling            : YCbCr4:<span class="number">2</span>:<span class="number">0</span> (<span class="number">2</span> <span class="number">2</span>)</span><br><span class="line">Image Size                      : <span class="number">187</span>x186</span><br><span class="line">Megapixels                      : <span class="number">0.035</span></span><br></pre></td></tr></table></figure>

<p>第五个，</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">steady@steady:~&#x2F;桌面&#x2F;steady&#x2F;1$ strings  &#x2F;home&#x2F;steady&#x2F;桌面&#x2F;steady&#x2F;1&#x2F;5.jpg</span><br><span class="line">&#x3D;Bvz</span><br><span class="line">;&#x3D;Bvz</span><br><span class="line">9!Y$</span><br><span class="line">So easy</span><br><span class="line">Just Look Carefully</span><br></pre></td></tr></table></figure>

<p>仔细看图片图片上有<code>TaU1w</code>。</p>
<p>第六个，</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">steady@steady:~&#x2F;桌面&#x2F;steady&#x2F;1$ strings  &#x2F;home&#x2F;steady&#x2F;桌面&#x2F;steady&#x2F;1&#x2F;6.jpg</span><br><span class="line">Here is your last gift</span><br><span class="line">TGUtU</span><br><span class="line">Now form the flag :)</span><br></pre></td></tr></table></figure>

<p>最后把字符串组成一组。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[&quot;3tKdX&quot;,&quot;N0LWF&quot;,&quot;ZmxhZ&quot;,&quot;TaU1w&quot;,&quot;TGUtU&quot;，&quot;3RlZ30&#x3D;&quot;]</span><br></pre></td></tr></table></figure>

<p>组合起来是<code>3tKdXN0LWF3RlZ30=ZmxhZTGUtU</code>，不是一个正常的base64，想到栅栏，把=号移动到最后面但是最终还是没拿到flag。观察这几串字符，被分成几块，而且=号这一块一定是在最后面的，所以flag很可能就是这几个块随机组合。所以上python脚本。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> itertools</span><br><span class="line"><span class="keyword">from</span> base64 <span class="keyword">import</span> b64decode</span><br><span class="line"></span><br><span class="line">d = [<span class="string">&quot;3tKdX&quot;</span>,<span class="string">&quot;N0LWF&quot;</span>,<span class="string">&quot;ZmxhZ&quot;</span>,<span class="string">&quot;TaU1w&quot;</span>,<span class="string">&quot;TGUtU&quot;</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> x <span class="keyword">in</span> itertools.permutations(d):</span><br><span class="line">        print(b64decode(<span class="string">&#x27;&#x27;</span>.join(x) + <span class="string">&quot;3RlZ30=&quot;</span>))</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python3 &#x2F;home&#x2F;steady&#x2F;桌面&#x2F;steady&#x2F;1&#x2F;1.py | grep &quot;flag&quot;</span><br></pre></td></tr></table></figure>

<p>最后拿到flag。</p>
<h3 id="slowed"><a href="#slowed" class="headerlink" title="slowed"></a>slowed</h3><p>题目提示slow，打开之后听音乐，发现很慢，使用sox变快一点<code>steady@steady:~/桌面/steady$ sox slowed.wav fast.wav speed 3.2</code>。</p>
<p>听到了字母的语音。使用Audacity查看频谱图，发现频谱图中有数据，通过修改频率也是看不清，直接使用sox。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sox slowed.wav -n spectrogram</span><br></pre></td></tr></table></figure>

<p><img src="https://steady-1302023625.cos.ap-beijing.myqcloud.com/makedown/58.png" alt="58"></p>
<p>可以看到不太清楚，直接使用sox再次优化。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sox slowed.wav -n spectrogram -z 30 -Z -20 -x 1600</span><br></pre></td></tr></table></figure>

<p>最后拿到一个下载地址。</p>
<h2 id="其他隐写"><a href="#其他隐写" class="headerlink" title="其他隐写"></a>其他隐写</h2><h3 id="FRA05-syclovergeek"><a href="#FRA05-syclovergeek" class="headerlink" title="FRA05 syclovergeek"></a>FRA05 syclovergeek</h3><p>MP3隐写，文件名字就是密码。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">C:\Users\<span class="number">12521</span>\Desktop\CTFTools\信息隐藏\MP3Stego_1_1_18\MP3Stego&gt;MP3StegoDecode.exe -X -P syclovergeek C:\Users\<span class="number">12521</span>\Desktop\syclovergeek.mp3</span><br><span class="line">MP3StegoEncoder <span class="number">1.1</span><span class="number">.17</span></span><br><span class="line">See README file <span class="keyword">for</span> copyright info</span><br><span class="line">Input file = <span class="string">&#x27;C:\Users\12521\Desktop\syclovergeek.mp3&#x27;</span>  output file = <span class="string">&#x27;C:\Users\12521\Desktop\syclovergeek.mp3.pcm&#x27;</span></span><br><span class="line">Will attempt to extract hidden information. Output: C:\Users\<span class="number">12521</span>\Desktop\syclovergeek.mp3.txt</span><br><span class="line">the bit stream file C:\Users\<span class="number">12521</span>\Desktop\syclovergeek.mp3 <span class="keyword">is</span> a BINARY file</span><br><span class="line">HDR: s=FFF, id=<span class="number">1</span>, l=<span class="number">3</span>, ep=off, br=<span class="number">9</span>, sf=<span class="number">0</span>, pd=<span class="number">1</span>, pr=<span class="number">0</span>, m=<span class="number">0</span>, js=<span class="number">0</span>, c=<span class="number">0</span>, o=<span class="number">0</span>, e=<span class="number">0</span></span><br><span class="line">alg.=MPEG<span class="number">-1</span>, layer=III, tot bitrate=<span class="number">128</span>, sfrq=<span class="number">44.1</span></span><br><span class="line">mode=stereo, sblim=<span class="number">32</span>, jsbd=<span class="number">32</span>, ch=<span class="number">2</span></span><br><span class="line">[Frame <span class="number">5932</span>]Frame cannot be located</span><br><span class="line">Input stream may be empty</span><br><span class="line">Avg slots/frame = <span class="number">417.962</span>; b/smp = <span class="number">2.90</span>; br = <span class="number">128.001</span> kbps</span><br><span class="line">Decoding of <span class="string">&quot;C:\Users\12521\Desktop\syclovergeek.mp3&quot;</span> <span class="keyword">is</span> finished</span><br><span class="line">The decoded PCM output file name <span class="keyword">is</span> <span class="string">&quot;C:\Users\12521\Desktop\syclovergeek.mp3.pcm&quot;</span></span><br></pre></td></tr></table></figure>

<h3 id="FRA04-godwave"><a href="#FRA04-godwave" class="headerlink" title="FRA04 godwave"></a>FRA04 godwave</h3><p>使用脚本进行转化。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> wave</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">import</span> numpy</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">wav = wave.open(<span class="string">&#x27;/root/桌面/11/godwave.wav&#x27;</span>,<span class="string">&#x27;rb&#x27;</span>)</span><br><span class="line">params = wav.getparams()</span><br><span class="line">nchannels, sampwidth, framerate, nframes = params[:<span class="number">4</span>]</span><br><span class="line">strData = wav.readframes(nframes)</span><br><span class="line">waveData = numpy.fromstring(strData, dtype=numpy.int16)</span><br><span class="line">waveData = waveData*<span class="number">1.0</span>/(max(abs(waveData)))</span><br><span class="line">string = <span class="string">&#x27;&#x27;</span></span><br><span class="line">norm = <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1735680</span>):</span><br><span class="line">    norm = norm+abs(waveData[i])</span><br><span class="line">    <span class="keyword">if</span> (i+<span class="number">1</span>) % <span class="number">64</span> == <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">if</span> norm &gt; <span class="number">10</span>:</span><br><span class="line">            string += <span class="string">&#x27;1&#x27;</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            string += <span class="string">&#x27;0&#x27;</span></span><br><span class="line">        norm = <span class="number">0</span></span><br><span class="line"><span class="keyword">with</span> open(<span class="string">&#x27;01output.txt&#x27;</span>,<span class="string">&#x27;w&#x27;</span>) <span class="keyword">as</span> output:</span><br><span class="line">    output.writelines(string)</span><br></pre></td></tr></table></figure>

<p>拿到一串二进制，进行曼切斯特解密，八个一组转换为ascii，发现是一张png，扫码拿到flag。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line">file_in = open(<span class="string">&#x27;01output.txt&#x27;</span>,<span class="string">&#x27;r&#x27;</span>)</span><br><span class="line">code = file_in.readline()</span><br><span class="line">file_in.close()</span><br><span class="line">le = len(str(code))</span><br><span class="line"><span class="keyword">print</span> le</span><br><span class="line"><span class="keyword">print</span> code</span><br><span class="line"></span><br><span class="line">result = <span class="string">&#x27;&#x27;</span></span><br><span class="line">count = <span class="number">0</span></span><br><span class="line">res = <span class="number">0</span></span><br><span class="line"><span class="keyword">while</span> code != <span class="string">&#x27;&#x27;</span>:</span><br><span class="line">    cp = code[:<span class="number">2</span>]</span><br><span class="line">    <span class="keyword">if</span> cp != <span class="string">&#x27;&#x27;</span>:</span><br><span class="line">        <span class="keyword">if</span> cp[<span class="number">0</span>] == <span class="string">&#x27;0&#x27;</span> <span class="keyword">and</span> cp[<span class="number">1</span>] == <span class="string">&#x27;1&#x27;</span>:</span><br><span class="line">            res = (res&lt;&lt;<span class="number">1</span>)|<span class="number">0</span></span><br><span class="line">            count +=<span class="number">1</span></span><br><span class="line">        <span class="keyword">if</span> cp[<span class="number">0</span>] == <span class="string">&#x27;1&#x27;</span> <span class="keyword">and</span> cp[<span class="number">1</span>] == <span class="string">&#x27;0&#x27;</span>:</span><br><span class="line">            res = (res&lt;&lt;<span class="number">1</span>)|<span class="number">1</span></span><br><span class="line">            count +=<span class="number">1</span></span><br><span class="line">        <span class="keyword">if</span> count == <span class="number">8</span>:</span><br><span class="line">            result += chr(res)</span><br><span class="line">            count = <span class="number">0</span></span><br><span class="line">            res = <span class="number">0</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">print</span> <span class="string">&#x27;Unexpected cp, exit!&#x27;</span> <span class="comment"># found &#x27;00&#x27; or &#x27;11&#x27;, stop the script directly</span></span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    code = code[<span class="number">2</span>:]</span><br><span class="line">print(result)</span><br></pre></td></tr></table></figure>

<h3 id="FRA06-Ogrewatch"><a href="#FRA06-Ogrewatch" class="headerlink" title="FRA06 Ogrewatch"></a>FRA06 Ogrewatch</h3><p>那个一个文件不知道后缀名，使用Linux查看一下，放入linux之后可以直接打开是一个视频，但不是mp4格式。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">root@root:~&#x2F;桌面&#x2F;flag# file &#39;&#x2F;root&#x2F;桌面&#x2F;flag&#x2F;ogreman&#39; </span><br><span class="line">&#x2F;root&#x2F;桌面&#x2F;flag&#x2F;ogreman: Matroska data</span><br></pre></td></tr></table></figure>

<p>百度了一下是一个MKV文件，也是视频格式的一种，在win下修改后缀为<code>mkv</code>。使用<code>ffmpeg </code>提取文件。分理出一个文件使用命令提取flag。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ffmpeg -i ogreman -map <span class="number">0</span>:s:<span class="number">0</span> ogreman-subs.srt</span><br><span class="line">grep <span class="string">&quot;font size&quot;</span> ogreman-subs.srt | cut -d<span class="string">&quot;&gt;&quot;</span> -f2</span><br></pre></td></tr></table></figure>

<h1 id="蓝鲸安全"><a href="#蓝鲸安全" class="headerlink" title="蓝鲸安全"></a>蓝鲸安全</h1><h2 id="杂项"><a href="#杂项" class="headerlink" title="杂项"></a>杂项</h2><h3 id="我们不一样"><a href="#我们不一样" class="headerlink" title="我们不一样"></a>我们不一样</h3><p>一张图片，提示我们，尝试binwalk拿到一样的图片。不一样需要进行比较，可以使用stegsolve，但是没有发现什么东西。</p>
<p>尝试kali–compare。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">root@root:~&#x2F;桌面&#x2F;flag# compare &#39;&#x2F;root&#x2F;桌面&#x2F;flag&#x2F;1.png&#39;  &#39;&#x2F;root&#x2F;桌面&#x2F;flag&#x2F;2.png&#39;  out.png</span><br></pre></td></tr></table></figure>

<p>拿到一张图片有异常，在图的左下角，有一块红色区域。使用python将这两个图片不一样的部分的像素打印出来。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"></span><br><span class="line">img1 = Image.open(<span class="string">&quot;00000000.png&quot;</span>)</span><br><span class="line">im1 = img1.load()</span><br><span class="line"></span><br><span class="line">img2 = Image.open(<span class="string">&quot;00006909.png&quot;</span>)</span><br><span class="line">im2 = img2.load()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">a=<span class="string">&#x27;&#x27;</span></span><br><span class="line">i=<span class="number">0</span></span><br><span class="line">s=<span class="string">&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> y <span class="keyword">in</span> range(img1.size[<span class="number">1</span>]):</span><br><span class="line">    <span class="keyword">for</span> x <span class="keyword">in</span> range(img1.size[<span class="number">0</span>]):</span><br><span class="line">        <span class="keyword">if</span>(im1[x,y]!=im2[x,y]):</span><br><span class="line">            print(im1[x,y],im2[x,y])</span><br></pre></td></tr></table></figure>

<p>输出</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">(1, 0, 42) (1, 0, 1)</span><br><span class="line">(1, 0, 42) (1, 0, 1)</span><br><span class="line">(2, 1, 43) (2, 1, 1)</span><br><span class="line">(2, 1, 43) (2, 1, 1)</span><br><span class="line">(2, 1, 43) (2, 1, 0)</span><br><span class="line">(2, 1, 43) (2, 1, 1)</span><br></pre></td></tr></table></figure>

<p>发现rgb的b通道都是0或者1，提取出来八个一组转化为二进制。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"></span><br><span class="line">img1 = Image.open(<span class="string">&quot;1.png&quot;</span>)</span><br><span class="line">im1 = img1.load()</span><br><span class="line"></span><br><span class="line">img2 = Image.open(<span class="string">&quot;2.png&quot;</span>)</span><br><span class="line">im2 = img2.load()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">a=<span class="string">&#x27;&#x27;</span></span><br><span class="line">i=<span class="number">0</span></span><br><span class="line">s=<span class="string">&#x27;&#x27;</span></span><br><span class="line">flag=<span class="string">&quot;&quot;</span></span><br><span class="line">flag1=<span class="string">&quot;&quot;</span></span><br><span class="line"><span class="keyword">for</span> y <span class="keyword">in</span> range(img1.size[<span class="number">1</span>]):</span><br><span class="line">    <span class="keyword">for</span> x <span class="keyword">in</span> range(img1.size[<span class="number">0</span>]):</span><br><span class="line">        <span class="keyword">if</span>(im1[x,y]!=im2[x,y]):</span><br><span class="line">            flag+=str(im2[x,y][<span class="number">2</span>])</span><br><span class="line">print(flag)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>,len(flag),<span class="number">8</span>):</span><br><span class="line">    flag1+=chr(int(flag[i:i+<span class="number">8</span>],<span class="number">2</span>))</span><br><span class="line">print(flag1)</span><br></pre></td></tr></table></figure>

<p>拿到flag。</p>
<h1 id="BuuCtf"><a href="#BuuCtf" class="headerlink" title="BuuCtf"></a>BuuCtf</h1><h2 id="杂项-1"><a href="#杂项-1" class="headerlink" title="杂项"></a>杂项</h2><h3 id="金三胖"><a href="#金三胖" class="headerlink" title="金三胖"></a>金三胖</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">root@root:~&#x2F;桌面&#x2F;flag&#x2F;1# convert aaa.gif flag.png</span><br></pre></td></tr></table></figure>

<p>从分理出的图片拿到flag。</p>
<h3 id="二维码"><a href="#二维码" class="headerlink" title="二维码"></a>二维码</h3><p>扫码提示<code>secret is here</code>。</p>
<p>binwalk分离拿到一个压缩包，名字为<code>4number</code>暴力破解拿到密码<code>7639</code>。</p>
<h3 id="N种方法解决"><a href="#N种方法解决" class="headerlink" title="N种方法解决"></a>N种方法解决</h3><p>拿到一个exe程序，直接<code>root@root:~/桌面/flag# strings &#39;/root/桌面/flag/output/zip/KEY.exe&#39; </code>。</p>
<p>拿到一个图片base64，放入浏览器解码。是个二维码扫描得到flag。</p>
<h3 id="大白"><a href="#大白" class="headerlink" title="大白"></a>大白</h3><p>直接PNG修改高度。</p>
<h3 id="你竟然赶我走"><a href="#你竟然赶我走" class="headerlink" title="你竟然赶我走"></a>你竟然赶我走</h3><p>binwalk分离不出东西来，直接<code>strings</code>，拿到flag。</p>
<h3 id="基础破解"><a href="#基础破解" class="headerlink" title="基础破解"></a>基础破解</h3><p>一个压缩包题目提示破解，四位数字，拿到密码之后，打开是base64解码拿到flag。</p>
<p><code>ZmxhZ3s3MDM1NDMwMGE1MTAwYmE3ODA2ODgwNTY2MWI5M2E1Y30=</code></p>
<h3 id="乌镇峰会种图"><a href="#乌镇峰会种图" class="headerlink" title="乌镇峰会种图"></a>乌镇峰会种图</h3><p><code>strings</code>命令拿到flag。</p>
<h3 id="LSB"><a href="#LSB" class="headerlink" title="LSB"></a>LSB</h3><p>提示LSB直接使用kali的zsteg。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">root@root:~/桌面/flag<span class="comment"># zsteg &#x27;/root/桌面/flag/output/zip/flag11.png&#x27; </span></span><br><span class="line">imagedata           .. text: <span class="string">&quot;00010,&amp;&amp;\&quot;&quot;</span></span><br><span class="line">b1,rgb,lsb,xy       .. file: PNG image data, <span class="number">280</span> x <span class="number">280</span>, <span class="number">8</span>-bit/color RGB, non-interlaced</span><br></pre></td></tr></table></figure>

<p>可以看到rgb的lsb通道有一个PNG，直接上stegsolve，使用save bin功能，不要用save Text功能，保存为1.png。拿到二维码扫描得到flag。</p>
<h3 id="文件中的秘密"><a href="#文件中的秘密" class="headerlink" title="文件中的秘密"></a>文件中的秘密</h3><p>文件属性拿到flag。</p>
<h3 id="wireshark"><a href="#wireshark" class="headerlink" title="wireshark"></a>wireshark</h3><p>直接过滤http流量，找到一个登录界面拿到flag。</p>
<h3 id="ningen"><a href="#ningen" class="headerlink" title="ningen"></a>ningen</h3><p>拿到一张图片，为jpg，提示密码是四位数字，想到steghide，但是不会爆破，binwalk分析，有一个zip，尝试foremost分离，分离出好多的文件夹，就是没有文件，尝试dd命令，拿到压缩包，爆破密码，拿到flag。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">root@root:~&#x2F;桌面&#x2F;flag&#x2F;output# dd if&#x3D;&#39;&#x2F;root&#x2F;桌面&#x2F;flag&#x2F;1.jpg&#39;  of&#x3D;flag.zip skip&#x3D;38689 bs&#x3D;1</span><br></pre></td></tr></table></figure>

<h3 id="镜子里面的世界"><a href="#镜子里面的世界" class="headerlink" title="镜子里面的世界"></a>镜子里面的世界</h3><p>png图片直接上zsteg。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">root@root:~&#x2F;桌面&#x2F;flag&#x2F;output# zsteg &#39;&#x2F;root&#x2F;桌面&#x2F;flag&#x2F;steg.png&#39; </span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">meta date:create    .. text: &quot;2013-01-17T17:35:32-05:00&quot;</span><br><span class="line">meta date:modify    .. [same as &quot;meta date:create&quot;]</span><br><span class="line">imagedata           .. text: &quot;\&quot;&amp;&amp;\&quot;4&amp;$&gt;8:&quot;</span><br><span class="line">b1,rgb,lsb,xy       .. text: &quot;Hey I think we can write safely in this file without anyone seeing it. Anyway, the secret key is: st3g0_saurus_wr3cks&quot;</span><br><span class="line">b2,r,msb,xy         .. text: [&quot;U&quot; repeated 178 times]</span><br><span class="line">b2,g,msb,xy         .. text: [&quot;U&quot; repeated 178 times]</span><br><span class="line">b2,b,msb,xy         .. text: [&quot;U&quot; repeated 178 times]</span><br><span class="line">b2,rgb,msb,xy       .. text: [&quot;U&quot; repeated 22 times]</span><br><span class="line">b2,bgr,msb,xy       .. text: [&quot;U&quot; repeated 22 times]</span><br><span class="line">b4,r,msb,xy         .. text: [&quot;w&quot; repeated 100 times]</span><br><span class="line">b4,g,msb,xy         .. file: MPEG ADTS, layer I, v2, 112 kbps, JntStereo</span><br><span class="line">b4,b,msb,xy         .. text: [&quot;w&quot; repeated 100 times]</span><br></pre></td></tr></table></figure>

<h3 id="被嗅探的流量"><a href="#被嗅探的流量" class="headerlink" title="被嗅探的流量"></a>被嗅探的流量</h3><p>提示找文件，打开文件，查看总体协议分级。有http流量，直接过滤http。</p>
<p><img src="https://steady-1302023625.cos.ap-beijing.myqcloud.com/makedown/40.png" alt="40"></p>
<p>右键-&gt;显示分组字节流-&gt;显示为图像。对图片<code>strings</code>命令拿到flag。</p>
<h3 id="小明的保险箱"><a href="#小明的保险箱" class="headerlink" title="小明的保险箱"></a>小明的保险箱</h3><p>使用<code>string</code>命令，可以看到有RAR文件。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">root@root:~&#x2F;桌面&#x2F;flag&#x2F;output# strings &#39;&#x2F;root&#x2F;桌面&#x2F;flag&#x2F;1.jpg&#39; </span><br><span class="line">Rar!</span><br><span class="line">2.txt~</span><br><span class="line">fi#E</span><br><span class="line">-s%n</span><br></pre></td></tr></table></figure>

<p><code>foremost</code>分离拿到rar，爆破拿到flag。</p>
<h3 id="爱因斯坦"><a href="#爱因斯坦" class="headerlink" title="爱因斯坦"></a>爱因斯坦</h3><p>拿到一个图片，binwalk分离得到一个压缩包，需要密码。<code>strings jpg</code>，看到有<code>&lt;?xpacket begin=</code>信息，说明图片属性有信息，查看图片属性发现一个字符串，作为密码解压拿到flag。</p>
<p>一个流量包，打开之后发现只有TCP协议，协议分析发现也带有数据(Data)。</p>
<p><img src="https://steady-1302023625.cos.ap-beijing.myqcloud.com/makedown/41.png" alt="41"></p>
<p><img src="https://steady-1302023625.cos.ap-beijing.myqcloud.com/makedown/42.png" alt="42"></p>
<p>接着查看每个数据包，发现有的数据包有Data字段，第一个为F，第二个为L。正好是flag字段，尝试<code>tshark</code>提取。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">steady@steady:~$ tshark -r easycap.pcap -T fields -e &quot;data.data&quot; | tr &quot;\n&quot; &quot; &quot; | sort -u</span><br></pre></td></tr></table></figure>

<p>截取到十六进制，转ascii拿到flag。</p>
<h3 id="另外一个世界"><a href="#另外一个世界" class="headerlink" title="另外一个世界"></a>另外一个世界</h3><p><code>strings</code>图片，末尾有二进制数据，查看长度为56，为八的倍数，直接转化字符串，得到flag。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">steady=<span class="string">&quot;01101011011011110110010101101011011010100011001101110011&quot;</span></span><br><span class="line">flag=<span class="string">&quot;&quot;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>,len(steady),<span class="number">8</span>):</span><br><span class="line">    flag+=chr(int(steady[i:i+<span class="number">8</span>],<span class="number">2</span>))</span><br><span class="line">print(flag)</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">koekj3s</span><br></pre></td></tr></table></figure>

<h3 id="FLAG"><a href="#FLAG" class="headerlink" title="FLAG"></a>FLAG</h3><p>png图片。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">root@root:~/桌面/flag<span class="comment"># zsteg &#x27;/root/桌面/flag/2.png&#x27; </span></span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">root@root:~&#x2F;桌面&#x2F;flag# zsteg &#39;&#x2F;root&#x2F;桌面&#x2F;flag&#x2F;2.png&#39;  --all</span><br><span class="line">imagedata           .. text: &quot;KK&lt;220\r\r&quot;</span><br><span class="line">b1,rgb,lsb,xy       .. file: Zip archive data, at least v2.0 to extract</span><br><span class="line">b1,bgr,msb,xy       .. text: &quot;saZ$S:&#39;6&quot;</span><br><span class="line">b2,r,msb,xy         .. file: PGP\011Secret Sub-key -</span><br></pre></td></tr></table></figure>

<p>有zip文件，stegsolve提取出来，有一个没有后缀的文件。</p>
<p>放入winhex，发现是个<code>ELF文件</code>。</p>
<h3 id="假如给我三天光明"><a href="#假如给我三天光明" class="headerlink" title="假如给我三天光明"></a>假如给我三天光明</h3><p>盲文拿到密码，拿到一个音频。音频是一个短杠、长杆，短杠为.，长杠为-。拿到莫斯解码，拿到flag。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">-.-. - ..-. .-- .--. . .. ----- ---.. --... ...-- ..--- ..--.. ..--- ...-- -.. --..</span><br></pre></td></tr></table></figure>

<h3 id="隐藏的密码"><a href="#隐藏的密码" class="headerlink" title="隐藏的密码"></a>隐藏的密码</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">root@root:~&#x2F;桌面&#x2F;flag# strings &#39;&#x2F;root&#x2F;桌面&#x2F;flag&#x2F;隐藏的钥匙.jpg&#39; | grep &quot;flag&quot;</span><br><span class="line">flag:base64:(Mzc3Y2JhZGRhMWVjYTJmMmY3M2QzNjI3Nzc4MWYwMGE&#x3D;)</span><br></pre></td></tr></table></figure>

<h3 id="BJDCTF-2nd-最简单的misc-y1ng"><a href="#BJDCTF-2nd-最简单的misc-y1ng" class="headerlink" title="[BJDCTF 2nd]最简单的misc-y1ng"></a>[BJDCTF 2nd]最简单的misc-y1ng</h3><p>伪加密，解压一个没有后缀的文件，放入。winhex，有点像PNG，但是缺少头加入<code>89 50 4E 47 0D 0A 1A 0A</code>。</p>
<p>一定要注意，不能先修改文件后缀，要在原始的文件上修改，然后在修改名字。拿到一串数字。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">424A447B79316E677A756973687561697D</span><br></pre></td></tr></table></figure>

<p>一开始以为是md5，尝试十六进制解码，拿到flag。</p>
<h3 id="BJDCTF-2nd-A-Beautiful-Picture"><a href="#BJDCTF-2nd-A-Beautiful-Picture" class="headerlink" title="[BJDCTF 2nd]A_Beautiful_Picture"></a>[BJDCTF 2nd]A_Beautiful_Picture</h3><p><code>zsteg</code>分析没有信息，尝试binwalk，分理出一个图片，在linux打开打不开，提示CRC有问题。但是在win上可以打开。肯定是CRC爆破。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> struct</span><br><span class="line"><span class="keyword">import</span> binascii</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line">p=<span class="number">0</span></span><br><span class="line">m = open(<span class="string">&quot;1.png&quot;</span>,<span class="string">&quot;rb&quot;</span>).read()</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">5000</span>):</span><br><span class="line">    <span class="keyword">if</span>(p==<span class="number">1</span>):</span><br><span class="line">    	<span class="keyword">break</span></span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> range(<span class="number">5000</span>):</span><br><span class="line">        c = m[<span class="number">12</span>:<span class="number">16</span>] + struct.pack(<span class="string">&#x27;&gt;i&#x27;</span>, i) + struct.pack(<span class="string">&#x27;&gt;i&#x27;</span>, j)+m[<span class="number">24</span>:<span class="number">29</span>]</span><br><span class="line">        crc = binascii.crc32(c) &amp; <span class="number">0xffffffff</span></span><br><span class="line">        <span class="keyword">if</span> crc == <span class="number">0xC2C143B3</span>:</span><br><span class="line">            p=<span class="number">1</span></span><br><span class="line">            <span class="comment">#print(c)</span></span><br><span class="line">            print(hex(i),hex(j))</span><br><span class="line">            <span class="keyword">break</span></span><br></pre></td></tr></table></figure>

<p>一定要查看CRC值，然后修改脚本，别忘了修改。</p>
<h3 id="神秘龙卷风"><a href="#神秘龙卷风" class="headerlink" title="神秘龙卷风"></a>神秘龙卷风</h3><p>爆破压缩包，解密brainfuck解码。</p>
<h3 id="宽带信息泄露"><a href="#宽带信息泄露" class="headerlink" title="宽带信息泄露"></a>宽带信息泄露</h3><p>RouterPassView解密。</p>
<h3 id="来首歌曲"><a href="#来首歌曲" class="headerlink" title="来首歌曲"></a>来首歌曲</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">..... -... -.-. ----. ..--- ..... -.... ....- ----. -.-. -... ----- .---- ---.. ---.. ..-. ..... ..--- . -.... .---- --... -.. --... ----- ----. ..--- ----. .---- ----. .---- -.-.</span><br></pre></td></tr></table></figure>

<p>莫斯密码，拿到flag。</p>
<h3 id="数据包中的线索"><a href="#数据包中的线索" class="headerlink" title="数据包中的线索"></a>数据包中的线索</h3><p>打开分析协议，有http协议，发现有数据，很多字符，最有有一个=，考虑base64图片，加入头放入浏览器显示错误。</p>
<p>直接解密base64，转化为图片拿到flag。</p>
<p><img src="https://steady-1302023625.cos.ap-beijing.myqcloud.com/makedown/43.png" alt="43"></p>
<h3 id="九连环"><a href="#九连环" class="headerlink" title="九连环"></a>九连环</h3><p>binwalk 分理出压缩包，伪加密，拿到两个压缩包。拿到一张图片，尝试setghide。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">steghide.exe extract -sf C:\Users\12521\Desktop\good-已合并.jpg</span><br><span class="line">Enter passphrase:</span><br><span class="line">wrote extracted data to &quot;ko.txt&quot;.</span><br></pre></td></tr></table></figure>

<p>拿到另一个压缩包密码，解密拿到flag。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bV1g6t5wZDJif^J7</span><br></pre></td></tr></table></figure>

<h3 id="面具下的flag"><a href="#面具下的flag" class="headerlink" title="面具下的flag"></a>面具下的flag</h3><p>binwalk 分离出一个vmdk文件，使用7z解压，拿到文件，文件中有brainfuck，解密。</p>
<p><code>flag&#123;N7F5_AD5</code>。</p>
<p>另一半在文件<code>where_is_flag_part_two.txt</code>中，但是提示flag不在这里，很可能是ntf隐写。使用7z压缩也你能看到具有隐写数据。使用工具提取隐写数据，是ook编码，直接解码拿到flag。</p>
<p><img src="https://steady-1302023625.cos.ap-beijing.myqcloud.com/makedown/44.png" alt="44"></p>
<h3 id="刷新过的图片"><a href="#刷新过的图片" class="headerlink" title="刷新过的图片"></a>刷新过的图片</h3><p>提示刷新，F5隐写。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">java Extract C:\Users\12521\Desktop\Misc.jpg</span><br><span class="line">Huffman decoding starts</span><br><span class="line">Permutation starts</span><br><span class="line">309504 indices shuffled</span><br><span class="line">Extraction starts</span><br><span class="line">Length of embedded file: 190 bytes</span><br><span class="line">(1, 31, 5) code used</span><br></pre></td></tr></table></figure>

<p>拿到一个压缩包，伪加密，拿到flag。</p>
<h3 id="梅花香之苦寒来"><a href="#梅花香之苦寒来" class="headerlink" title="梅花香之苦寒来"></a>梅花香之苦寒来</h3><p><code>strings</code>分析一下，最后末尾有十六进制。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">root@root:~&#x2F;桌面&#x2F;flag# strings &#39;&#x2F;root&#x2F;桌面&#x2F;flag&#x2F;meihuai.jpg&#39; | grep &quot;7312c31&quot; &gt; q.txt</span><br></pre></td></tr></table></figure>

<p>放入notepadd++，十六进制转换ascii。一群坐标画图 ，可以使用脚本，也可以使用kali的<code>gnuplot</code>,主要该工具去需要去掉<code>（）</code>、以及逗号变成空格。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gnuplot&gt; plot &#39;&#x2F;root&#x2F;q.txt&#39;</span><br></pre></td></tr></table></figure>

<h3 id="BJDCTF-2nd-圣火昭昭-y1ng"><a href="#BJDCTF-2nd-圣火昭昭-y1ng" class="headerlink" title="[BJDCTF 2nd]圣火昭昭-y1ng"></a>[BJDCTF 2nd]圣火昭昭-y1ng</h3><p>jpg文件，<code>stings</code>看到有图片附加属性直接，查看找到编码<code>諸壽隸僧壽降吽壽諸壽陀壽摩隸僧缽薩願心壽咤壽囉寂壽闍諸壽哆壽慧壽聞壽色吽愍壽所壽蜜如</code>，解码拿到密码。<code>gemlovecom</code>,根据题目提示去掉com。</p>
<p>jpg、拿到密码。想到<code>steghide</code>、<code>jphsiwn</code>都不好使，最后outguess解密。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">root@root:~&#x2F;桌面&#x2F;flag# outguess -k &quot;gemlove&quot; -r &#39;&#x2F;root&#x2F;桌面&#x2F;flag&#x2F;sheng_huo_zhao_zhao.jpg&#39; .&#x2F;out.txt</span><br></pre></td></tr></table></figure>

<p>菜刀666</p>
<p>提示菜刀，应该与链接shell有关直接，搜索http流量，追踪TCP，第七个流可以看到，z2参数是一个图片的十六进制。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">FFD8FFE000104A46494600010101007800780000FFDB00430001010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101FFDB00430101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101FFC0001108013901E203012200021101031101FFC4001F0000010501010101010100000000000000000102030405060708090A0BFFC400B5100002010303020403050504040000017D01020300041105122131410613516107227114328191A1082342B1C11552D1F02433627282090A161718191A25262728292A3435363738393A434445464748494A535455565758595A636465666768696A737475767778797A838485868788898A92939495969798999AA2A3A4A5A6A7A8A9AAB2B3B4B5B6B7B8B9BAC2C3C4C5C6C7C8C9CAD2D3D4D5D6D7D8D9DAE1E2E3E4E5E6E7E8E9EAF1F2F3F4F5F6F7F8F9FAFFC4001F0100030101010101010101010000000000000102030405060708090A0BFFC400B51100020102040403040705040400010277000102031104052131061241510761711322328108144291A1B1C109233352F0156272D10A162434E125F11718191A262728292A35363738393A434445464748494A535455565758595A636465666768696A737475767778797A82838485868788898A92939495969798999AA2A3A4A5A6A7A8A9AAB2B3B4B5B6B7B8B9BAC2C3C4C5C6C7C8C9CAD2D3D4D5D6D7D8D9DAE2E3E4E5E6E7E8E9EAF2F3F4F5F6F7F8F9FAFFDA000C03010002110311003F00FC18823DB907E62481211D6493F86143D914E012BCF5E30056C4310192E7D0CC40EFFC30478E3B0DFF00FD8F352DA3DBB0AF0769F2C1FF00964839699CF3866C9C11CF719E33AD6F1B7C840EB930AB71C672D7327B0C1D99EC0632179FF49A8C75F376FF002FB9DFAD9BE65D66EDFE56D79EFADBB3D9AB5BE4AC95FB69D5455EDC28724C9C703CD238D89FC30A1F523AE3D4F6539D88632E4EE013080CA57FE58C5FC31A7FD34933F377E7DCD54B78F714DA0B00711038F9DC7DF9DFFD95E703FA6EAD98101D8A83702FF20FF9ED3779187FCF34391CF5F539AF568C36EFDF7BAD36F5BBDBBE9F146DE3D79F4DDAFBAFA2F93D1EFA2B35B4657B90A6428036314F7C5BC1F967CC7DDCF7391D0B1C6CDBA6D0BB70A4292B9FF963177918FF00CF47E3033B88C6324A8AAB020551D24F9B1EF7336781D4131A13C738C7BB606BDBC4064B82FF0030DF8EB34BD5635C7F021C671DBA0C9435EA528EDE56FF0087D3F357B745A42FE4566B5F3EFADB656B3F5B5B4ECDABD465BB78CFC85540620B421B811A1FBD7327FB47036E4F5E47DD4AD7B78F732141F2AFFA856EE73FBCB993B0C6D2573C63D81354E14C96DDF32EE5F39971FBC906365B45D72A300311C71E8A2B6A353921B19E3CE65FE151F72DA3C74E061B6F4C73F74E7D6A11DB4ED7B697DBEE4ADD3E1B69750478D5A5ABD6FA7E76F4BEEBD6FAD9CED1B70A9F9047F30DC7C956E3CD9070F3B8FEEA9FBBBBD30790D5A70C61400079997C2E7ADCCFD0B9C9E638B2703EEFA9059B15E24DBB830D8DB479C47FCB284E36C080E7E77380D9FA1CE18D694319272C446760DDD48B780F0101EF2CB9C63A9CF62C71D96D52D36DBB256F5B7CF6B59E91A89F0DDEBAE8DAEFEF6D6775BEFBADEF74BDEA76B3146A796CBA87191D4DCDC765F689339EA3D7A30AD2452C4863B81606661FF2DA5FE18131D634E99E871C7F05578D1890061095C8E9FE8D6F9E588FF9EB27FDF4739C7231A50AE31B1761DA7C90DD228BF8E77E9991F1F29FCB036D633F5BEB6DB7DBBBBBED67D1D9FC53B1DAD6FCB5F77B2E8F5D34D2F1D234D132A80AE1B9191F6865C7CEF91E5DAC479000C00D8E383D768274228FEF997E5F957CF2BFC080FC96B10E992061B1C7639C1CD6817E68D93E5C026DD58E3681FEB2EE5E31938F97F4E0569449911845DDC9F20360177FE3BA9472768C1DBBB8E3BED6AC65E7E49F7D96BFD6AEFDE7A5C6EBF0FD2FDED64BD15B4BAA7EFCF1A925B71F2C8502523FE5DE0E36DBC7C9FDEC9FC407AF3D58D68C719C8C811B6C191DAD6D880428FF00A6D367A9E72D83C9E2181154290BBF2FFB907ACF3FF14CF9CFEEE3C9DBDB8C673BB1A10A0C8209972FC64737574739FF00B631E7BFB74DD9ACDAEB7F56AFBBB79BE8FA6FAB5ACA08B4ECBBF65F774FD1EBF65E91A97B51272368F2D8A7C993C5B5B7F148DEB2C808E7A927B6401A502636140148563086E9145FC7732678DCDD573CF1D32AA6ABC49B465BF7A0BE6423ADD5C725625EE618F8071818E9D462FA2E776FF9BE651315FF0096B20FB96D191C045230D8F4CE385AC24EDAAFC7A256D55BBFE9A69185ED6AD2FBBF0EFD3A6BFCD696B29DA68D598C6B12F393F6753D80FF0059792FE5F213D303070B83A512AA04D8371DC7C80DFF002D661F7EE65CF444E4A0ED800F462628D02EFDE493F2FDA5978FFAE76916327A0F9B1C0E49CEDE6F221258B9DA428F3D97FE5945C7976B1FFB4C461B1CF639C3679DEFE9AF6B6DF75B97ABD1AEBC8EF69A6D6FDD6FAEDF377BF6D6FD1CD5A7823CED0BFBD01C9894FF00CBD5CE7E69E4073FB</span><br></pre></td></tr></table></figure>

<p>保存之后是一个密码。</p>
<p>第九个流最后数据返回包是一个压缩包。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">-&gt;|PK...........KQ...4...(.......flag.txtC......cS...J..Ea.v....&amp;e$K..2%..$..,..&#x3D;.J..1p..p46.PK..?..........KQ...4...(.....$....... .......flag.txt</span><br><span class="line">. .........J. ..p..	.o2.p..	.o2.p..PK..........Z...Z.....well,you need passwd!.|&lt;-</span><br></pre></td></tr></table></figure>

<p><code>|&lt;-</code>是菜刀的标志，十六进制标志为<code>2D3E7C</code>。</p>
<h3 id="BJDCTF2020-认真你就输了"><a href="#BJDCTF2020-认真你就输了" class="headerlink" title="[BJDCTF2020]认真你就输了"></a>[BJDCTF2020]认真你就输了</h3><h3 id="BJDCTF-2nd-EasyBaBa"><a href="#BJDCTF-2nd-EasyBaBa" class="headerlink" title="[BJDCTF 2nd]EasyBaBa"></a>[BJDCTF 2nd]EasyBaBa</h3><p>拿到一个图片，文件大小很大，所以直接<code>foremost</code>。拿到一个压缩包，解压里面还有个jpg图片。打开之后发现损坏，放入winhex，尝试修补头，但是发现是个avi文件。视频隐写。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ffmpeg -i flag.mp4 -f image2 image%d.jpg</span><br></pre></td></tr></table></figure>

<p>扫描二维码得到flag。</p>
<h3 id="SWPU2019-神奇的二维码"><a href="#SWPU2019-神奇的二维码" class="headerlink" title="[SWPU2019]神奇的二维码"></a>[SWPU2019]神奇的二维码</h3><p>扫码，假flag。binwalk分析。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">steady@steady:~&#x2F;桌面&#x2F;steady$ binwalk -e &#x2F;home&#x2F;steady&#x2F;桌面&#x2F;steady&#x2F;BitcoinPay.png</span><br><span class="line"></span><br><span class="line">DECIMAL       HEXADECIMAL     DESCRIPTION</span><br><span class="line">--------------------------------------------------------------------------------</span><br><span class="line">0             0x0             PNG image, 400 x 400, 8-bit&#x2F;color RGBA, non-interlaced</span><br><span class="line">28932         0x7104          RAR archive data, version 5.x</span><br><span class="line">29034         0x716A          RAR archive data, version 5.x</span><br><span class="line">94226         0x17012         RAR archive data, version 5.x</span><br></pre></td></tr></table></figure>

<p>其中一个文件–<code>YXNkZmdoamtsMTIzNDU2Nzg5MA==</code>解码<code>asdfghjkl1234567890</code>，另一个压缩包的密码，得到一个jpg。</p>
<p>flag.doc文件，一串很长的字符串，<code>Vm0wd2QyUXlVWGxWV0d4V1YwZDRWMVl3WkRSV01WbDNXa1JTVjAxV2JETlhhMUpUVjBaS2RHVkdXbFpOYWtFeFZtcEJlRll5U2tWVWJHaG9UV3N3ZUZadGNFZFpWMDE1VTJ0V1ZXSkhhRzlVVjNOM1pVWmFjVkZ0UmxSTmF6RTFWVEowVjFaWFNraGhSemxWVmpOT00xcFZXbUZrUjA1R1pFWlNUbFpVVmtwV2JURXdWakZXZEZOc1dsaGlSa3BZV1ZkMGQyUnNjRmRYYlVaclVsUkdWbFpYZUZOVWJVWTJVbFJHVjJFeVVYZFdha1pYWkVaT2NscEdhR2xTTW1ob1YxZDBZVll3TUhoalJscFlZbFZhY2xWcVFURlNNVlY1VFZSU1ZrMXJjRmhWTW5SM1ZqSktWVkpZWkZwV1JWcHlWVEJhVDJOc2NFaGpSazVYVWpOb2IxWXhaRFJWTVVsNVZXNU9XR0pIVWxsWmJGWmhZMnhXY1ZGVVJsTk5WMUo1VmpJMWExWXdNVVZTYkdSYVRVWmFNMVpxU2t0V1ZrcFpXa1p3YkdFelFrbFdiWEJIVkRKU1YxWnVUbGhpVjJoeldXeG9iMkl4V25STldHUlZUV3RzTlZWdGRHdGhiRXAwVld4c1dtSkdXbWhaTW5oWFl6RldjbHBHWkdsU2JrSmFWMnhXYjJFeFdYZE5WVlpUWVRGd1YxbHJXa3RUUmxweFUydGFiRlpzV2xwWGExcDNZa2RGZWxGcmJGaFhTRUpJVmtSS1UxWXhXblZVYkdocFZqTm9WVlpHWTNoaU1sSnpWMjVTVGxkSFVsWlVWM1J6VGxaV2RHUkhkRmhTTUhCSlZsZDRjMWR0U2tkWGJXaGFUVlp3YUZwRlpGTlRSa3B5VGxaT2FXRXdjRWxXYlhCTFRrWlJlRmRzYUZSaE1sSnhWVzB4TkdGR1ZYZGhSVTVUVW14d2VGVXlkR0ZpUmxwelUyeHdXbFpXY0hKV1ZFWkxWMVpHY21KR1pGZE5NRXBKVm10U1MxVXhXWGhYYmxaV1lsZG9WRmxZY0ZkbGJHUllaVWM1YVUxWFVraFdNalZUVkd4T1NHRkdRbFppVkVVd1ZtcEdVMVp0UmtoUFZtaFRUVWhDTlZaSGVHRmpNV1IwVTJ0a1dHSlhhR0ZVVnpWdlYwWnNObEpzWkdwaVNFSklWMnRrYzFVeVNuSlRiVVpYVFc1b1dGbHFTa1psUm1SWldrVTFWMVpzY0ZWWFYzUnJWVEZzVjFWc1dsaGliVkp6V1d0YWQyVkdWblJOVldSVlRXdHdSMVl5ZUhkWGJGcFhZMGRvV21FeVVrZGFWM2hIWTIxS1IxcEdaRTVOUlhCS1ZtMTBVMU14VlhoWFdHaFlZbXhhVmxsclpHOWpSbHB4VkcwNWEySkdjRWhXYlRBMVZXc3hXRlZ1Y0ZkTmFsWk1WakJrUzFOR1ZuUlNiR1JvWVRGd1NWWkhkR0ZaVm1SSVZXdG9hMUl5YUhCVmJHaENaREZhYzFwRVVtcE5WMUl3VlRKMGIyRkdTbk5UYkdoVlZteHdNMVl3V25KbFJtUnlaRWR3YVZacmNFbFdiR1EwWVRKR1YxTnVVbEJXUlRWWVZGYzFiMWRHYkhGVGExcHNVbTFTV2xkclZURldNVnB6WTBaV1dGWXpVbkpXVkVaelZqRldjMWRzYUdsaVZrcDZWMWQwWVdReVZrZFdibEpPVmxkU1ZsUlhkSGRTTVZsNVpVaGtXR0pHY0ZoWk1HaExWakZhUmxkcmVGZE5WbkJJV1RJeFMxSXhjRWRhUlRWT1VsaENTMVp0TVRCVk1VMTRWbGhvV0ZkSGFGbFpiWGhoVm14c2NscEhPV3BTYkhCNFZrY3dOVll4V25SVmJHaFhWak5OTVZaWGMzaFhSbFp5WVVaa1RtRnNXbFZXYTJRMFdWWktjMVJ1VG1oU2JGcFlWRlJLYjFOV1draGxSMFphVm0xU1IxUnNXbUZWUmxwMFZXczVXbFpGTlVSVWJGcGhVMGRXU0ZKdGNFNVdNVWwzVmxSS01HRXhaRWhUYkdob1VqQmFWbFp1Y0Zka2JGbDNWMjVPVDJKRmNIcFhhMlIzWVZaT1JsTnJiRmhXYkZweVdYcEdWbVF3TVVsaFJrNW9Za2hDV1ZkV1pEQmtiVkY0VjJ4V1UySkdjSE5WYlRGVFRWWlZlV042UmxkTlZuQjZXVEJhVjFkR1duTlRhMmhoVWtWYWNsVnFTa3RUVmxKMFlVWk9iR0pZYUZGV2ExcGhXVmRSZVZaclpGZGliRXBQVm14a1UxWXhVbGhrU0dSWFRWZDRlVlpYTVVkWFJrbDNWbXBTV2sxR1NsQldha3BIWTJ4a2NtVkdaR2hoTTBKUlZsUkNhMUl4U1hsU2EyaHBVbXMxY0ZsVVFuZE5iRnAwVFZSQ1ZrMVZNVFJXVm1oelZsWmtTR1ZHV2xwV1JWb3pXVlZhVjJOV1RuUlBWbVJUWWtWd1dsWkhlR3BPVmxsNFYyNU9hbEpYYUZsV2ExVXhaR3hzVjFaWWFGaFNiRm94V1RCYWExUnNXWGxoUkVwWFlXdEtjbFY2Um10V01WcDFVMnhDVjJKSVFuZFdiWFJYVm0xUmVGZHVSbEppVlZwaFZtMHhVMU5XV2xoa1J6bG9UVlZzTlZsVmFFTldiVXBJWVVWT1lWSkZXbWhaZWtaM1VsWldkR05GTlZkTlZXd3pWbXhTUzAxSFNYbFNhMlJVWW1zMVZWbHNWbUZXYkZwMFpVaGtUazFXY0hsV01qRkhZV3hhY21ORVJsaGhNWEJRVmtkNFlXTnRUa1ZXYkdSVFRUSm9iMVpyVWt0U01WbDRWRzVXVm1KRlNsaFZiRkpYVjFaa1YxVnJaR3ROYTFwSVZqSjRWMVV5UlhoalNFNVdZbFJHVkZwWGVITldiR1J6Vkcxb1UxWkZXalpXVkVreFlURlplRmRZY0ZaaVYyaFhXbGQwWVZsV2NGWlhiR1JxVFd0YVIxUXhXbXRoUjFaelYycGFWMDFYVVhkWFZtUlNaVlphY2xwR1pHbGlSWEJRVm0xNGExVXhXWGhWYkdoclUwZFNXRlJXV25kTlJtdDNXa1ZrV0ZJd2NFaFpNRnB2VjJzeFNGVnVXbGROYm1ob1ZqQmFWMk5zY0VoU2JHUlhUVlZ3VWxac1pIZFRNVTE0VTFoc1UyRXlVbTlWYlhoTFZrWmFjMkZGVGxSTlZuQjRWVzB4UjFack1WWk5WRkpYVm0xb2VsWnNXbXRUUjBaSVlVWmFUbEp1UW05V2JURTBZekpPYzFwSVNtdFNNMEpVV1d0YWQwNUdXbGhOVkVKT1VteHNORll5TlU5aGJFcFlZVVpvVjJGck5WUldSVnB6VmxaR1dXRkdUbGRoTTBJMlZtdGtORmxXVlhsVGExcFlWMGhDV0Zac1duZFNNVkY0VjJ0T1ZtSkZTbFpVVlZGM1VGRTlQUT09</code>。</p>
<p>循环base64解密，拿到第二个<code>comEON_YOuAreSOSoS0great</code>，使用改密码解压一个文件夹拿到一个<code>good.MP3</code>。</p>
<p>对于good文件，先导出文件，然后使用工具，拿到莫斯密码。导出文件。</p>
<p><img src="https://steady-1302023625.cos.ap-beijing.myqcloud.com/makedown/46.png" alt="46"></p>
<p>使用工具解码。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">steady@steady:~$ morse2ascii /home/steady/桌面/steady/_BitcoinPay.png.extracted/<span class="number">55.</span>wav</span><br><span class="line">MORSE2ASCII <span class="number">0.2</span></span><br><span class="line">by Luigi Auriemma</span><br><span class="line">e-mail: aluigi@autistici.org</span><br><span class="line">web:    aluigi.org</span><br><span class="line"></span><br><span class="line">- open /home/steady/桌面/steady/_BitcoinPay.png.extracted/<span class="number">55.</span>wav</span><br><span class="line">  wave size      <span class="number">577010</span></span><br><span class="line">  format tag     <span class="number">1</span></span><br><span class="line">  channels:      <span class="number">1</span></span><br><span class="line">  samples/sec:   <span class="number">8000</span></span><br><span class="line">  avg/bytes/sec: <span class="number">16000</span></span><br><span class="line">  block align:   <span class="number">2</span></span><br><span class="line">  bits:          <span class="number">16</span></span><br><span class="line">  samples:       <span class="number">288505</span></span><br><span class="line">  bias adjust:   <span class="number">-162</span></span><br><span class="line">  volume peaks:  <span class="number">-23125</span> <span class="number">23125</span></span><br><span class="line">  normalize:     <span class="number">9642</span></span><br><span class="line">  resampling to  <span class="number">8000</span>hz</span><br><span class="line"></span><br><span class="line">- decoded morse data:</span><br><span class="line">tt  ttt  ete  eee  e  ee  eee  eeet  e  ete  tett  eeet  e  ete  tett  e  et  eee  tett </span><br></pre></td></tr></table></figure>

<p><code>t</code>换<code>-</code>，<code>e</code>换<code>.</code>，转码得<code>morseisveryveryeasy</code>，即flag。</p>
<h3 id="BJDCTF2020-你猜我是个啥"><a href="#BJDCTF2020-你猜我是个啥" class="headerlink" title="[BJDCTF2020]你猜我是个啥"></a>[BJDCTF2020]你猜我是个啥</h3><p>根据题目名称。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">steady@steady:~$ file &#x2F;home&#x2F;steady&#x2F;桌面&#x2F;steady&#x2F;_BitcoinPay.png.extracted&#x2F;flag.zip</span><br><span class="line">&#x2F;home&#x2F;steady&#x2F;桌面&#x2F;steady&#x2F;_BitcoinPay.png.extracted&#x2F;flag.zip: PNG image data, 245 x 256, 8-bit&#x2F;color RGBA, non-interlaced</span><br></pre></td></tr></table></figure>

<p>修改PNG后缀，一个二维码。扫描假flag。</p>
<p>使用<code>strings</code>查看到flag。</p>
<h3 id="BJDCTF2020-一叶障目"><a href="#BJDCTF2020-一叶障目" class="headerlink" title="[BJDCTF2020]一叶障目"></a>[BJDCTF2020]一叶障目</h3><p>CRC爆破修改高度。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#coding=utf-8</span></span><br><span class="line"><span class="keyword">import</span> zlib</span><br><span class="line"><span class="keyword">import</span> struct</span><br><span class="line"><span class="comment">#读文件</span></span><br><span class="line">file = <span class="string">&#x27;1.png&#x27;</span>  <span class="comment">#注意，1.png图片要和脚本在同一个文件夹下哦~</span></span><br><span class="line">fr = open(file,<span class="string">&#x27;rb&#x27;</span>).read()</span><br><span class="line">data = bytearray(fr[<span class="number">12</span>:<span class="number">29</span>])</span><br><span class="line">crc32key = eval(str(fr[<span class="number">29</span>:<span class="number">33</span>]).replace(<span class="string">&#x27;\\x&#x27;</span>,<span class="string">&#x27;&#x27;</span>).replace(<span class="string">&quot;b&#x27;&quot;</span>,<span class="string">&#x27;0x&#x27;</span>).replace(<span class="string">&quot;&#x27;&quot;</span>,<span class="string">&#x27;&#x27;</span>))</span><br><span class="line"><span class="comment">#crc32key = 0xCBD6DF8A #补上0x，copy hex value</span></span><br><span class="line"><span class="comment">#data = bytearray(b&#x27;\x49\x48\x44\x52\x00\x00\x01\xF4\x00\x00\x01\xF1\x08\x06\x00\x00\x00&#x27;)  #hex下copy grep hex</span></span><br><span class="line">n = <span class="number">4095</span> <span class="comment">#理论上0xffffffff,但考虑到屏幕实际，0x0fff就差不多了</span></span><br><span class="line"><span class="keyword">for</span> w <span class="keyword">in</span> range(n):<span class="comment">#高和宽一起爆破</span></span><br><span class="line">    width = bytearray(struct.pack(<span class="string">&#x27;&gt;i&#x27;</span>, w))<span class="comment">#q为8字节，i为4字节，h为2字节</span></span><br><span class="line">    <span class="keyword">for</span> h <span class="keyword">in</span> range(n):</span><br><span class="line">        height = bytearray(struct.pack(<span class="string">&#x27;&gt;i&#x27;</span>, h))</span><br><span class="line">        <span class="keyword">for</span> x <span class="keyword">in</span> range(<span class="number">4</span>):</span><br><span class="line">            data[x+<span class="number">4</span>] = width[x]</span><br><span class="line">            data[x+<span class="number">8</span>] = height[x]</span><br><span class="line">            <span class="comment">#print(data)</span></span><br><span class="line">        crc32result = zlib.crc32(data)</span><br><span class="line">        <span class="keyword">if</span> crc32result == crc32key:</span><br><span class="line">            print(width,height)</span><br><span class="line">            <span class="comment">#写文件</span></span><br><span class="line">            newpic = bytearray(fr)</span><br><span class="line">            <span class="keyword">for</span> x <span class="keyword">in</span> range(<span class="number">4</span>):</span><br><span class="line">                newpic[x+<span class="number">16</span>] = width[x]</span><br><span class="line">                newpic[x+<span class="number">20</span>] = height[x]</span><br><span class="line">            fw = open(file+<span class="string">&#x27;.png&#x27;</span>,<span class="string">&#x27;wb&#x27;</span>)<span class="comment">#保存副本</span></span><br><span class="line">            fw.write(newpic)</span><br><span class="line">            fw.close</span><br></pre></td></tr></table></figure>





<p>使用binwalk分离。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">root@root:~&#x2F;桌面&#x2F;flag# binwalk -e ezbb_r.png </span><br><span class="line"></span><br><span class="line">DECIMAL       HEXADECIMAL     DESCRIPTION</span><br><span class="line">--------------------------------------------------------------------------------</span><br><span class="line">0             0x0             JPEG image data, JFIF standard 1.01</span><br><span class="line">30            0x1E            TIFF image data, big-endian, offset of first image directory: 8</span><br><span class="line">28673         0x7001          End of Zip archive</span><br><span class="line"></span><br><span class="line">root@root:~&#x2F;桌面&#x2F;flag# dd if&#x3D;&#39;&#x2F;root&#x2F;桌面&#x2F;flag&#x2F;ezbb_r.jpg&#39;  of&#x3D;flag.zip skip&#x3D;28673 bs&#x3D;1</span><br><span class="line">记录了22+0 的读入</span><br><span class="line">记录了22+0 的写出</span><br></pre></td></tr></table></figure>

<p>可以看到有压缩包，进而使用dd命令。但是分离出来的压缩包是错误的。</p>
<p>使用<code>strings</code>命令没有发现，直接拖入winhex查看原因，搜索FFD9或者504B，发现jpg结尾有一个504B，修改后面的值为zip压缩头，解压拿到一个文件。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">                                                              </span><br><span class="line">                                                              </span><br><span class="line">##############    ##      ##    ##########  ##############    </span><br><span class="line">##          ##  ####  ####  ######  ##      ##          ##    </span><br><span class="line">##  ######  ##    ######      ##    ##      ##  ######  ##    </span><br><span class="line">##  ######  ##  ####  ##  ##      ##        ##  ######  ##    </span><br><span class="line">##  ######  ##      ##  ##      ##  ####    ##  ######  ##    </span><br><span class="line">##          ##  ##  ##        ####          ##          ##    </span><br><span class="line">##############  ##  ##  ##  ##  ##  ##  ##  ##############    </span><br><span class="line">                        ##    ##        ##                    </span><br><span class="line">##########  ##########  ####  ##  ##  ######  ##  ##  ##      </span><br><span class="line">##    ####    ##  ##      ##    ##  ######  ##############    </span><br><span class="line">####      ######  ##  ####  ####    ##    ##    ####  ##      </span><br><span class="line">######  ####    ########    ######        ##########  ##      </span><br><span class="line">####  ########    ##  ##  ##  ######              ######      </span><br><span class="line">####      ##  ########  ##  ##  ##  ####  ##########  ####    </span><br><span class="line">    ##########  ##        ##  ##        ####  ##    ####      </span><br><span class="line">##########    ####  ##  ##    ##    ######    ##  ##  ##      </span><br><span class="line">######    ####          ####  ##  ####            ####        </span><br><span class="line">########        ##        ####      ######  ##  ####  ####    </span><br><span class="line">##  ##  ########      ####    ##    ##                        </span><br><span class="line">##    ##      ##      ##      ####  ######  ####  ##    ##    </span><br><span class="line">##  ####    ####      ##        ######################  ##    </span><br><span class="line">                ####    ####    ######  ##      ##  ######    </span><br><span class="line">##############  ######    ######      ####  ##  ##            </span><br><span class="line">##          ##    ####  ####  ##      ####      ##            </span><br><span class="line">##  ######  ##  ####    ##  ####  ####  ##################    </span><br><span class="line">##  ######  ##  ##                        ##          ####    </span><br><span class="line">##  ######  ##  ##########    ##          ####  ####  ##      </span><br><span class="line">##          ##  ########    ##  ##    ####  ##  ##    ##      </span><br><span class="line">##############  ########      ##########  ####  ##  ##        </span><br><span class="line">                                                              </span><br><span class="line">                                                             </span><br></pre></td></tr></table></figure>

<p>像一个二维码，放入notepad++，把空格替换为0，把#替换为1。使用脚本进行转换。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line"></span><br><span class="line">length = <span class="number">58</span></span><br><span class="line">img = Image.new(<span class="string">&#x27;RGB&#x27;</span>, (length*<span class="number">5</span>, length*<span class="number">5</span>))</span><br><span class="line"><span class="comment">#黑点为1白点为0</span></span><br><span class="line">data = <span class="string">&quot;1111111111111100001100000011000011111111110011111111111111111111111111110000110000001100001111111111001111111111111111000000000011001111001111001111110011000000110000000000111100000000001100111100111100111111001100000011000000000011110011111100110000111111000000110000110000001100111111001111001111110011000011111100000011000011000000110011111100111100111111001100111100110011000000110000000011001111110011110011111100110011110011001100000011000000001100111111001111001111110011000000110011000000110011110000110011111100111100111111001100000011001100000011001111000011001111110011110000000000110011001100000000111100000000001100000000001111000000000011001100110000000011110000000000110000000000111111111111111100110011001100110011001100110011111111111111111111111111110011001100110011001100110011001111111111111100000000000000000000000011000011000000001100000000000000000000000000000000000000001100001100000000110000000000000000111111111100111111111100111100110011001111110011001100110011111111110011111111110011110011001100111111001100110011001100001111000011001100000011000011001111110011111111111111110000111100001100110000001100001100111111001111111111111111110000001111110011001111001111000011000011000011110011001111000000111111001100111100111100001100001100001111001100111111001111000011111111000011111100000000111111111100110011111100111100001111111100001111110000000011111111110011001111001111111100001100110011001111110000000000000011111100111100111111110000110011001100111111000000000000001111110011110000001100111111110011001100110011110011111111110011111111000000110011111111001100110011001111001111111111001111000011111111110011000000001100110000000011110011000011110000001111111111001100000000110011000000001111001100001111001111111111000011110011001100001100001111110000110011001100111111111100001111001100110000110000111111000011001100110011111100001111000000000011110011001111000000000000111100001111110000111100000000001111001100111100000000000011110000111111110000000011000000001111000000111111001100111100111111111111000000001100000000111100000011111100110011110011111100110011111111000000111100001100001100000000000000000000110011001111111100000011110000110000110000000000000000000011000011000000110000001100000011110011111100111100110000111100001100000011000000110000001111001111110011110011000011110011110000111100000011000000001111111111111111111111001111001111000011110000001100000000111111111111111111111100110000000000000000111100001111000011111100110000001100111111000000000000000011110000111100001111110011000000110011111111111111111111001111110000111111000000111100110011000000001111111111111100111111000011111100000011110011001100000000110000000000110000111100111100110000001111000000110000000011000000000011000011110011110011000000111100000011000000001100111111001100111100001100111100111100111111111111111111110011111100110011110000110011110011110011111111111111111111001111110011001100000000000000000000000011000000000011111100111111001100110000000000000000000000001100000000001111110011111100110011111111110000110000000000111100111100110011001111110011001111111111000011000000000011110011110011001100000000001100111111110000110011000011110011001100001100110000000000110011111111000011001100001111001100110000110011111111111111001111111100000011111111110011110011001100001111111111111100111111110000001111111111001111001100110000&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> x <span class="keyword">in</span> range(length):</span><br><span class="line">    <span class="keyword">for</span> y <span class="keyword">in</span> range(length):</span><br><span class="line">        <span class="keyword">if</span> data[x*length+y] == <span class="string">&#x27;1&#x27;</span>:</span><br><span class="line">            <span class="keyword">for</span> xx <span class="keyword">in</span> range(x*<span class="number">5</span>, x*<span class="number">5</span>+<span class="number">5</span>):</span><br><span class="line">                <span class="keyword">for</span> yy <span class="keyword">in</span> range(y*<span class="number">5</span>, y*<span class="number">5</span>+<span class="number">5</span>):</span><br><span class="line">                    img.putpixel([xx, yy], (<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>))</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">for</span> xx <span class="keyword">in</span> range(x*<span class="number">5</span>, x*<span class="number">5</span>+<span class="number">5</span>):</span><br><span class="line">                <span class="keyword">for</span> yy <span class="keyword">in</span> range(y*<span class="number">5</span>, y*<span class="number">5</span>+<span class="number">5</span>):</span><br><span class="line">                    img.putpixel([xx, yy], (<span class="number">255</span>,<span class="number">255</span>,<span class="number">255</span>))</span><br><span class="line">img.save(<span class="string">&#x27;out.png&#x27;</span>)</span><br></pre></td></tr></table></figure>

<p>扫描之后拿到<code>od -vtx1 ./draw.png | head -56 | tail -28</code>。</p>
<p>放入kali执行。od是一个linux命令。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">0000700 01 00 02 10 03 10 00 00 01 ee c0 b8 a6 00 00 00</span><br><span class="line">0000720 ff ff ff 00 ff ff ff ff 00 ff ff 00 00 00 ff ff</span><br><span class="line">0000740 ff 00 ff 00 00 00 ff 00 00 ff 00 ff 00 00 ff 00</span><br><span class="line">0000760 ff 00 ff 00 00 00 ff 00 00 ff 00 ff 00 00 ff 00</span><br><span class="line">0001000 ff ff 00 00 00 00 ff 00 00 ff 00 ff 00 ff 00 00</span><br><span class="line">0001020 ff 00 ff 00 00 00 ff 00 00 ff 00 ff 00 00 ff 00</span><br><span class="line">0001040 ff 00 ff 00 ff 00 ff 00 00 ff 00 ff 00 00 ff 00</span><br><span class="line">0001060 ff ff ff 00 ff ff ff 00 00 ff ff 00 00 00 ff ff</span><br><span class="line">0001100 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00</span><br><span class="line">0001120 ff ff ff 00 ff ff ff 00 ff ff ff 00 ff ff 00 00</span><br><span class="line">0001140 ff 00 00 00 00 00 ff 00 00 00 ff 00 00 ff 00 00</span><br><span class="line">0001160 ff ff ff 00 00 00 ff 00 ff ff ff 00 00 ff 00 00</span><br><span class="line">0001200 00 00 ff 00 00 00 ff 00 ff 00 00 00 00 ff 00 00</span><br><span class="line">0001220 ff ff ff 00 00 00 ff 00 ff ff ff 00 ff ff ff 00</span><br><span class="line">0001240 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00</span><br><span class="line">0001260 ff ff ff 00 ff 00 ff 00 ff ff ff 00 ff ff ff 00</span><br><span class="line">0001300 ff 00 00 00 ff 00 ff 00 ff 00 ff 00 00 00 ff 00</span><br><span class="line">0001320 ff ff ff 00 ff ff ff 00 ff ff ff 00 00 00 ff 00</span><br><span class="line">0001340 00 00 ff 00 00 00 ff 00 00 00 ff 00 00 00 ff 00</span><br><span class="line">0001360 ff ff ff 00 00 00 ff 00 ff ff ff 00 00 00 ff 00</span><br><span class="line">0001400 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00</span><br><span class="line">0001420 ff ff ff 00 ff ff 00 00 00 00 00 00 00 00 00 00</span><br><span class="line">0001440 ff 00 00 00 00 ff 00 00 00 00 00 00 00 00 00 00</span><br><span class="line">0001460 ff ff ff 00 00 ff 00 00 00 00 00 00 00 00 00 00</span><br><span class="line">0001500 ff 00 ff 00 00 ff ff 00 00 00 00 00 00 00 00 00</span><br><span class="line">0001520 ff 00 ff 00 00 ff 00 00 00 00 00 00 00 00 00 00</span><br><span class="line">0001540 ff ff ff 00 00 ff 00 00 00 00 00 00 00 00 00 00</span><br><span class="line">0001560 00 00 00 00 ff ff 00 63 da e9 3c 36 b1 aa 93 59</span><br></pre></td></tr></table></figure>

<p>把 ff 高亮一下显示发现并不是二维码，直接显示的是 flag 的图像了，结果是 BJD{572154976}。</p>
<h3 id="BJDCTF2020-鸡你太美"><a href="#BJDCTF2020-鸡你太美" class="headerlink" title="[BJDCTF2020]鸡你太美"></a>[BJDCTF2020]鸡你太美</h3><p>两个gif文件，一个损坏。</p>
<p>先对正常的进行分帧，没有发现异常。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">convert flag.gif flag.png</span><br></pre></td></tr></table></figure>

<p>查看损坏的gif，使用<code>file</code>命令查看文件类型。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">root@root:~&#x2F;桌面&#x2F;flag&#x2F;output# file &#39;&#x2F;root&#x2F;桌面&#x2F;flag&#x2F;output&#x2F;篮球副本.gif&#39; </span><br><span class="line">&#x2F;root&#x2F;桌面&#x2F;flag&#x2F;output&#x2F;篮球副本.gif: data</span><br></pre></td></tr></table></figure>

<p>放入winhex，发现少头，补充头部<code>47 49 46 38</code>。</p>
<h3 id="ACTF新生赛2020-outguess"><a href="#ACTF新生赛2020-outguess" class="headerlink" title="[ACTF新生赛2020]outguess"></a>[ACTF新生赛2020]outguess</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">root@root:~&#x2F;桌面&#x2F;flag&#x2F;output# exif &#39;&#x2F;root&#x2F;桌面&#x2F;flag&#x2F;output&#x2F;mmm.jpg&#39; </span><br><span class="line">‘&#x2F;root&#x2F;桌面&#x2F;flag&#x2F;output&#x2F;mmm.jpg’中的EXIF 信息标识(‘摩托罗拉’字节顺序):</span><br><span class="line">--------------------+----------------------------------------------------------</span><br><span class="line">信息标识                |值</span><br><span class="line">--------------------+----------------------------------------------------------</span><br><span class="line">XP Comment          |公正民主公正文明公正和谐</span><br><span class="line">Padding             |2060 bytes undefined data</span><br><span class="line">X-Resolution        |72</span><br><span class="line">Y-Resolution        |72</span><br><span class="line">Resolution Unit     |英寸</span><br><span class="line">Padding             |2060 bytes undefined data</span><br><span class="line">Exif Version        |Exif版本2.1</span><br><span class="line">FlashPixVersion     |FlashPix版本 1.0</span><br><span class="line">色彩空间                |Internal error (unknown value 65535)</span><br><span class="line">--------------------+----------------------------------------------------------</span><br></pre></td></tr></table></figure>

<p>社会注意核心价值观，解码为abc。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">root@root:~&#x2F;桌面&#x2F;flag&#x2F;output# outguess -k abc -r &#39;&#x2F;root&#x2F;桌面&#x2F;flag&#x2F;output&#x2F;mmm.jpg&#39; out.txt</span><br><span class="line">Reading &#x2F;root&#x2F;桌面&#x2F;flag&#x2F;output&#x2F;mmm.jpg....</span><br><span class="line">Extracting usable bits:   17550 bits</span><br><span class="line">Steg retrieve: seed: 93, len: 23</span><br><span class="line">root@root:~&#x2F;桌面&#x2F;flag&#x2F;output# cat out.txt </span><br><span class="line">ACTF&#123;gue33_Gu3Ss!2020&#125;</span><br></pre></td></tr></table></figure>



<p>直接<code>stings</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">root@root:~&#x2F;桌面&#x2F;flag&#x2F;output# strings &#39;&#x2F;root&#x2F;桌面&#x2F;flag&#x2F;output&#x2F;attachment.exe&#39; </span><br><span class="line">; ;$;(;,;0;4;8;&lt;;@;D;H;L;T;X;\;&#96;;d;</span><br><span class="line">Rar!</span><br><span class="line">CMT;</span><br><span class="line">Silent&#x3D;1</span><br><span class="line">1.txt</span><br><span class="line">ntfs      </span><br><span class="line">flag.txt</span><br><span class="line">:flag.txt</span><br><span class="line">G3JV&quot;</span><br></pre></td></tr></table></figure>

<p>发现很多信息，ntf、rar、flag.txt。使用binwalk，都没有什么发现，最后直接运行exe，生成一个txt，内容为：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ntfs      </span><br><span class="line">flag.txt</span><br></pre></td></tr></table></figure>

<p>尝试ntfs隐写。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">C:\Users\12521\Desktop\CTF&gt;notepad 1.txt:flag.txt</span><br></pre></td></tr></table></figure>

<p>直接拿到flag。</p>
<h3 id="谁赢了比赛？"><a href="#谁赢了比赛？" class="headerlink" title="谁赢了比赛？"></a>谁赢了比赛？</h3><p>发现一个rar。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">root@root:~&#x2F;桌面&#x2F;flag# zsteg &#39;&#x2F;root&#x2F;桌面&#x2F;flag&#x2F;who_won_the_game.png&#39; </span><br><span class="line">[?] 187692 bytes of extra data after image end (IEND), offset &#x3D; 0x15d2dc</span><br><span class="line">extradata:0         .. file: RAR archive data, v4, os: Win32</span><br><span class="line">    00000000: 52 61 72 21 1a 07 00 cf  90 73 00 00 0d 00 00 00  |Rar!.....s......|</span><br><span class="line">    00000010: 00 00 00 00 95 d3 74 44  94 35 00 90 dc 02 00 de  |......tD.5......|</span><br><span class="line">    00000020: 3c 03 00 02 46 d1 ab e2  bd 6a 13 47 1d 33 08 00  |&lt;...F....j.G.3..|</span><br><span class="line">    00000030: 20 00 00 00 68 65 68 65  2e 67 69 66 00 04 f8 fe  | ...hehe.gif....|</span><br><span class="line">    00000040: 42 6c d0 8d 00 b0 74 6c  37 34 b2 f5 0e 79 c4 24  |Bl....tl74...y.$|</span><br><span class="line">    00000050: 44 d5 0c 9d ba eb 18 46  c1 5d 76 a2 36 18 a2 cf  |D......F.]v.6...|</span><br><span class="line">    00000060: 38 6a 95 46 83 30 71 d7  67 36 ac 72 31 e3 b9 92  |8j.F.0q.g6.r1...|</span><br><span class="line">    00000070: b5 2f c7 b9 55 a9 59 ed  54 a8 23 d6 80 2a 42 ff  |.&#x2F;..U.Y.T.#..*B.|</span><br><span class="line">    00000080: 18 04 c2 f4 ba 07 9e 81  5e a3 4f 87 0c f1 50 47  |........^.O...PG|</span><br><span class="line">    00000090: 3d e9 c8 7d 35 bb a0 63  32 38 20 9a 38 c9 72 aa  |&#x3D;..&#125;5..c28 .8.r.|</span><br><span class="line">    000000a0: 9e 11 56 90 86 73 45 c5  50 51 0f 6a 67 80 9d 47  |..V..sE.PQ.jg..G|</span><br><span class="line">    000000b0: 28 05 51 20 25 33 bf ba  a2 0e 02 a8 a0 2d 43 fa  |(.Q %3.......-C.|</span><br><span class="line">    000000c0: 4b 8d 1a bb fd 33 4b 83  2d aa 14 0b 9c 32 34 ef  |K....3K.-....24.|</span><br><span class="line">    000000d0: 3f f5 46 75 00 61 44 b5  77 cc d9 e9 7e 36 ee da  |?.Fu.aD.w...~6..|</span><br><span class="line">    000000e0: 54 3d d0 20 e5 a1 75 57  3f 47 a6 d5 b3 60 8e 4b  |T&#x3D;. ..uW?G...&#96;.K|</span><br><span class="line">    000000f0: 38 6f 6a 1e 14 bc a0 f6  bb 7b 46 5e 90 49 36 d6  |8oj......&#123;F^.I6.|</span><br><span class="line">imagedata           .. text: &quot;888999999&quot;</span><br></pre></td></tr></table></figure>

<p>压缩包爆破拿到密码。</p>
<p>一个gif。分帧。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">root@root:~&#x2F;桌面&#x2F;flag# convert &#39;&#x2F;root&#x2F;桌面&#x2F;flag&#x2F;hehe.gif&#39;  flag.png</span><br></pre></td></tr></table></figure>

<p>其中有一个png文件。写有where flag？</p>
<p>对其进行分析。在red 0通道发现二维码扫描，拿到flag。<code>使用zsteg</code>发现不了二维码。</p>
<h3 id="喵喵喵"><a href="#喵喵喵" class="headerlink" title="喵喵喵"></a>喵喵喵</h3><p>使用<code>zsteg</code>，发现red 0有猫腻，直接data extract提取数据，发现是个png，二维码。保存修改高度，扫码。</p>
<p>rbg0、msb、bgr通道。用stegsolve进行颜色对换后得到一张正常的二维码，扫描后下载百度网盘的文件：flag.rar。</p>
<p>flag.txt内容：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag不在这里哦  你猜猜flag在哪里呢？  找找看吧</span><br></pre></td></tr></table></figure>

<p>ntf隐写，使用rar解压，ntfs工具。拿到一个pyc文件，反编译。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">steady@steady:~$ &#x2F;home&#x2F;steady&#x2F;桌面&#x2F;tools&#x2F;python-uncompyle6-master&#x2F;bin&#x2F;uncompyle6 &#x2F;home&#x2F;steady&#x2F;桌面&#x2F;steady&#x2F;4.pyc</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">import base64</span><br><span class="line"></span><br><span class="line">def encode():</span><br><span class="line">    flag &#x3D; &#39;*************&#39;</span><br><span class="line">    ciphertext &#x3D; []</span><br><span class="line">    for i in range(len(flag)):</span><br><span class="line">        s &#x3D; chr(i ^ ord(flag[i]))</span><br><span class="line">        if i % 2 &#x3D;&#x3D; 0:</span><br><span class="line">            s &#x3D; ord(s) + 10</span><br><span class="line">        else:</span><br><span class="line">            s &#x3D; ord(s) - 10</span><br><span class="line">        ciphertext.append(str(s))</span><br><span class="line"></span><br><span class="line">    return ciphertext[::-1]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">ciphertext &#x3D; [</span><br><span class="line"> &#39;96&#39;, &#39;65&#39;, &#39;93&#39;, &#39;123&#39;, &#39;91&#39;, &#39;97&#39;, &#39;22&#39;, &#39;93&#39;, &#39;70&#39;, &#39;102&#39;, &#39;94&#39;, &#39;132&#39;, &#39;46&#39;, &#39;112&#39;, &#39;64&#39;, &#39;97&#39;, &#39;88&#39;, &#39;80&#39;, &#39;82&#39;, &#39;137&#39;, &#39;90&#39;, &#39;109&#39;, &#39;99&#39;, &#39;112&#39;]</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>写脚本，拿到flag。</p>
<h3 id="BJDCTF-2nd-TARGZ-y1ng"><a href="#BJDCTF-2nd-TARGZ-y1ng" class="headerlink" title="[BJDCTF 2nd]TARGZ-y1ng"></a>[BJDCTF 2nd]TARGZ-y1ng</h3><p>压缩包名字就是压缩密码。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">import zipfile</span><br><span class="line">name &#x3D; &#39;hW1ES89jF&#39;</span><br><span class="line">while True:</span><br><span class="line">    fz &#x3D; zipfile.ZipFile(name + &#39;.zip&#39;, &#39;r&#39;)</span><br><span class="line">    fz.extractall(pwd&#x3D;bytes(name, &#39;utf-8&#39;))</span><br><span class="line">    name &#x3D; fz.filelist[0].filename[0:9]</span><br><span class="line">    fz.close()</span><br></pre></td></tr></table></figure>

<h3 id="GXYCTF2019-gakki"><a href="#GXYCTF2019-gakki" class="headerlink" title="[GXYCTF2019]gakki"></a>[GXYCTF2019]gakki</h3><p>binwalk分析，拿到压缩包，爆破，解压一个txt大量的字符，尝试词频分析。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"># -*- coding: UTF-8 -*-</span><br><span class="line">def processLine(line, CharacterCounts):</span><br><span class="line">    for character in line:</span><br><span class="line">        #if ord(character) in range(97, 123):</span><br><span class="line">        if ord(character) in range(32,126):</span><br><span class="line">            CharacterCounts[character] +&#x3D; 1</span><br><span class="line">  </span><br><span class="line">#创建字母字典</span><br><span class="line">def createCharacterCounts(CharacterCounts):</span><br><span class="line">    #for i in range(97, 123):</span><br><span class="line">    for i in range(32, 126):</span><br><span class="line">        CharacterCounts[chr(i)] &#x3D; 0</span><br><span class="line">  </span><br><span class="line">def main():</span><br><span class="line">    #用户输入一个文件名</span><br><span class="line">    # filename &#x3D; input(&quot;enter a filename:&quot;).strip()</span><br><span class="line">    filename &#x3D; &quot;flag.txt&quot;</span><br><span class="line">    infile &#x3D; open(filename, &quot;r&quot;)</span><br><span class="line">      </span><br><span class="line">    #建立用于计算词频的空字典</span><br><span class="line">    CharacterCounts &#x3D; &#123;&#125;</span><br><span class="line">    #初始化字典键值</span><br><span class="line">    createCharacterCounts(CharacterCounts)</span><br><span class="line">    for line in infile:</span><br><span class="line">        #processLine(line.lower(), CharacterCounts)</span><br><span class="line">        processLine(line, CharacterCounts)</span><br><span class="line">          </span><br><span class="line">    #从字典中获取数据对</span><br><span class="line">    pairs &#x3D; list(CharacterCounts.items())</span><br><span class="line">  </span><br><span class="line">    #列表中的数据对交换位置,数据对排序</span><br><span class="line">    items &#x3D; [[x,y] for (y,x) in pairs] </span><br><span class="line">    items.sort(reverse&#x3D;True)</span><br><span class="line">  </span><br><span class="line">    #输出count个数词频结果</span><br><span class="line">    for i in range(len(items)):</span><br><span class="line">        #print(items[i][1]+&quot;\t&quot;+str(items[i][0]))</span><br><span class="line">        print(items[i][1],end&#x3D;&#39;&#39;)</span><br><span class="line">          </span><br><span class="line">    infile.close()</span><br><span class="line">          </span><br><span class="line">if __name__ &#x3D;&#x3D; &#39;__main__&#39;:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure>

<p>或者</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding:utf-8 -*-</span></span><br><span class="line"><span class="comment">#Author: mochu7</span></span><br><span class="line">alphabet = <span class="string">&quot;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ1234567890!@#$%^&amp;*()_+- =\\&#123;\\&#125;[]&quot;</span></span><br><span class="line">strings = open(<span class="string">&#x27;./flag.txt&#x27;</span>).read()</span><br><span class="line"></span><br><span class="line">result = &#123;&#125;</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> alphabet:</span><br><span class="line">	counts = strings.count(i)</span><br><span class="line">	i = <span class="string">&#x27;&#123;0&#125;&#x27;</span>.format(i)</span><br><span class="line">	result[i] = counts</span><br><span class="line"></span><br><span class="line">res = sorted(result.items(),key=<span class="keyword">lambda</span> item:item[<span class="number">1</span>],reverse=<span class="literal">True</span>)</span><br><span class="line"><span class="keyword">for</span> data <span class="keyword">in</span> res:</span><br><span class="line">	print(data)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> res:</span><br><span class="line">	flag = str(i[<span class="number">0</span>])</span><br><span class="line">	print(flag[<span class="number">0</span>],end=<span class="string">&quot;&quot;</span>)</span><br></pre></td></tr></table></figure>

<h3 id="HBNIS2018-excel破解"><a href="#HBNIS2018-excel破解" class="headerlink" title="[HBNIS2018]excel破解"></a>[HBNIS2018]excel破解</h3><p><code>stings CTF</code></p>
<h3 id="SWPU2019-伟大的侦探"><a href="#SWPU2019-伟大的侦探" class="headerlink" title="[SWPU2019]伟大的侦探"></a>[SWPU2019]伟大的侦探</h3><p>一个压缩包，01editor 选择 EBCDIC编码得到压缩包的密码。</p>
<p>福尔摩斯里面的跳舞的小人加密。</p>
<h3 id="弱口令"><a href="#弱口令" class="headerlink" title="弱口令"></a>弱口令</h3><p>一个压缩包有弱口令，爆破不出来，查看注释，莫斯密码，放入sublim。解码拿到密码。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">.... . .-.. .-.. ----- ..-. --- .-. --</span><br></pre></td></tr></table></figure>

<p>一张png图片。lsb隐写。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">root@root:~&#x2F;桌面&#x2F;cloacked-pixel-master# python .&#x2F;lsb.py extract &#39;&#x2F;root&#x2F;桌面&#x2F;cloacked-pixel-master&#x2F;女神.png&#39;  flag.txt 123456</span><br><span class="line">[+] Image size: 500x500 pixels.</span><br><span class="line">[+] Written extracted data to flag.txt.</span><br></pre></td></tr></table></figure>

<h3 id="ACTF新生赛2020-base64隐写"><a href="#ACTF新生赛2020-base64隐写" class="headerlink" title="[ACTF新生赛2020]base64隐写"></a>[ACTF新生赛2020]base64隐写</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_base64_diff_value</span>(<span class="params">s1, s2</span>):</span></span><br><span class="line">    base64chars = <span class="string">&#x27;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/&#x27;</span></span><br><span class="line">    res = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> xrange(len(s2)):</span><br><span class="line">        <span class="keyword">if</span> s1[i] != s2[i]:</span><br><span class="line">            <span class="keyword">return</span> abs(base64chars.index(s1[i]) - base64chars.index(s2[i]))</span><br><span class="line">    <span class="keyword">return</span> res</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">solve_stego</span>():</span></span><br><span class="line">    <span class="keyword">with</span> open(<span class="string">&#x27;./flag.txt&#x27;</span>, <span class="string">&#x27;rb&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">        file_lines = f.readlines()</span><br><span class="line">        bin_str = <span class="string">&#x27;&#x27;</span></span><br><span class="line">        <span class="keyword">for</span> line <span class="keyword">in</span> file_lines:</span><br><span class="line">            steg_line = line.replace(<span class="string">&#x27;\n&#x27;</span>, <span class="string">&#x27;&#x27;</span>)</span><br><span class="line">            norm_line = line.replace(<span class="string">&#x27;\n&#x27;</span>, <span class="string">&#x27;&#x27;</span>).decode(<span class="string">&#x27;base64&#x27;</span>).encode(<span class="string">&#x27;base64&#x27;</span>).replace(<span class="string">&#x27;\n&#x27;</span>, <span class="string">&#x27;&#x27;</span>)</span><br><span class="line">            diff = get_base64_diff_value(steg_line, norm_line)</span><br><span class="line">            <span class="keyword">print</span> diff</span><br><span class="line">            pads_num = steg_line.count(<span class="string">&#x27;=&#x27;</span>)</span><br><span class="line">            <span class="keyword">if</span> diff:</span><br><span class="line">                bin_str += bin(diff)[<span class="number">2</span>:].zfill(pads_num * <span class="number">2</span>)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                bin_str += <span class="string">&#x27;0&#x27;</span> * pads_num * <span class="number">2</span></span><br><span class="line">            <span class="keyword">print</span> goflag(bin_str)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">goflag</span>(<span class="params">bin_str</span>):</span></span><br><span class="line">    res_str = <span class="string">&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> xrange(<span class="number">0</span>, len(bin_str), <span class="number">8</span>):</span><br><span class="line">        res_str += chr(int(bin_str[i:i + <span class="number">8</span>], <span class="number">2</span>))</span><br><span class="line">    <span class="keyword">return</span> res_str</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    solve_stego()</span><br></pre></td></tr></table></figure>

<h3 id="HBNIS2018-来题中等的吧"><a href="#HBNIS2018-来题中等的吧" class="headerlink" title="[HBNIS2018]来题中等的吧"></a>[HBNIS2018]来题中等的吧</h3><p>只有大横杆和小横杆，猜测摩斯密码，解密拿到flag。</p>
<h3 id="黑客帝国"><a href="#黑客帝国" class="headerlink" title="黑客帝国"></a>黑客帝国</h3><p>一个txt，一串十六进制，开头是<code>526172211a</code>。rar文件头导入01，需要密码，爆破。</p>
<p>解压得到一张png图片，hex分析，没有IHDR，而是JFIF，且为<code>FF D9</code>结尾，篡改了文件头，将<code>89 50 4e 47</code>改为<code>ff d8 ff e0</code>。</p>
<h3 id="WUSTCTF2020-find-me"><a href="#WUSTCTF2020-find-me" class="headerlink" title="[WUSTCTF2020]find_me"></a>[WUSTCTF2020]find_me</h3><p>exif查看信息，盲文密码。解密。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">ExifTool Version Number         : <span class="number">12.07</span></span><br><span class="line">File Name                       : attachment.jpg</span><br><span class="line">Directory                       : /home/steady/桌面/steady</span><br><span class="line">File Size                       : <span class="number">127</span> kB</span><br><span class="line">File Modification Date/Time     : <span class="number">2020</span>:<span class="number">11</span>:<span class="number">05</span> <span class="number">11</span>:<span class="number">39</span>:<span class="number">24</span>+<span class="number">08</span>:<span class="number">00</span></span><br><span class="line">File Access Date/Time           : <span class="number">2020</span>:<span class="number">11</span>:<span class="number">05</span> <span class="number">11</span>:<span class="number">40</span>:<span class="number">28</span>+<span class="number">08</span>:<span class="number">00</span></span><br><span class="line">File Inode Change Date/Time     : <span class="number">2020</span>:<span class="number">11</span>:<span class="number">05</span> <span class="number">11</span>:<span class="number">40</span>:<span class="number">28</span>+<span class="number">08</span>:<span class="number">00</span></span><br><span class="line">File Permissions                : rw-------</span><br><span class="line">File Type                       : JPEG</span><br><span class="line">File Type Extension             : jpg</span><br><span class="line">MIME Type                       : image/jpeg</span><br><span class="line">Exif Byte Order                 : Big-endian (Motorola, MM)</span><br><span class="line">Software                        : Adobe Photoshop CC <span class="number">2018</span> (Windows)</span><br><span class="line">Artist                          : <span class="number">52</span>HeRtz</span><br><span class="line">XP Comment                      : ⡇⡓⡄⡖⠂⠀⠂⠀⡋⡉⠔⠀⠔⡅⡯⡖⠔⠁⠔⡞⠔⡔⠔⡯⡽⠔⡕⠔⡕⠔⡕⠔⡕⠔⡕⡍=</span><br><span class="line">Padding                         : (Binary data <span class="number">1910</span> bytes, use -b option to extract)</span><br><span class="line">XMP Toolkit                     : Adobe XMP Core <span class="number">5.6</span>-c142 <span class="number">79.160924</span>, <span class="number">2017</span>/<span class="number">07</span>/<span class="number">13</span><span class="number">-01</span>:<span class="number">06</span>:<span class="number">39</span></span><br><span class="line">Authors Position                : <span class="number">52</span>HeRtz</span><br><span class="line">Creator Tool                    : Adobe Photoshop CC <span class="number">2018</span> (Windows)</span><br><span class="line">Creator                         : <span class="number">52</span>HeRtz</span><br><span class="line">Current IPTC Digest             : <span class="number">2</span>adef26c2475bb7c4db0fe45a2cbd2bd</span><br><span class="line">Coded Character Set             : UTF8</span><br><span class="line">Application Record Version      : <span class="number">4</span></span><br><span class="line">Object Name                     : Congratulations！</span><br><span class="line">By-line                         : <span class="number">52</span>HeRtz</span><br><span class="line">By-line Title                   : <span class="number">52</span>HeRtz</span><br><span class="line">IPTC Digest                     : <span class="number">2</span>adef26c2475bb7c4db0fe45a2cbd2bd</span><br><span class="line">Image Width                     : <span class="number">482</span></span><br><span class="line">Image Height                    : <span class="number">482</span></span><br><span class="line">Encoding Process                : Baseline DCT, Huffman coding</span><br><span class="line">Bits Per Sample                 : <span class="number">8</span></span><br><span class="line">Color Components                : <span class="number">3</span></span><br><span class="line">Y Cb Cr Sub Sampling            : YCbCr4:<span class="number">4</span>:<span class="number">4</span> (<span class="number">1</span> <span class="number">1</span>)</span><br><span class="line">Image Size                      : <span class="number">482</span>x482</span><br><span class="line">Megapixels                      : <span class="number">0.232</span></span><br></pre></td></tr></table></figure>

<h3 id="MRCTF2020-你能看懂音符吗"><a href="#MRCTF2020-你能看懂音符吗" class="headerlink" title="[MRCTF2020]你能看懂音符吗"></a>[MRCTF2020]你能看懂音符吗</h3><p>压缩包不能打开，修改头部，打开之后，打开之后<code>document.XML</code>发现音符，解码拿到flag。</p>
<h3 id="看网课"><a href="#看网课" class="headerlink" title="看网课"></a>看网课</h3><p>视频分帧，拿到敲击码。</p>
<p>以<code>/</code>为分割。先行，后列。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">..... ..&#x2F;... .&#x2F;... .&#x2F;... ..&#x2F;</span><br><span class="line">  5,3     3,1    3,1    3,2</span><br><span class="line">   W       L      L      M</span><br></pre></td></tr></table></figure>

<p>在第<code>7.36s</code>发现第二段信息：<code>dXBfdXBfdXA=</code>。</p>
<p>使用这个密码解压<code>flag2.zip</code>，解压得到<code>Real flag,jpg</code>，使用<code>010 Ediotr</code>打开搜索关键词<code>ctf</code>即可得到flag。</p>
<h3 id="HBNIS2018-低个头"><a href="#HBNIS2018-低个头" class="headerlink" title="[HBNIS2018]低个头"></a>[HBNIS2018]低个头</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">题目：低个头</span><br><span class="line"></span><br><span class="line">描述：EWAZX RTY TGB IJN IO KL 请破解该密文 f</span><br><span class="line"></span><br><span class="line">lag格式：XXX 明文</span><br><span class="line"></span><br><span class="line">提交：直接提交明文（大写）</span><br></pre></td></tr></table></figure>

<p>键盘密码。</p>
<h3 id="间谍启示录"><a href="#间谍启示录" class="headerlink" title="间谍启示录"></a>间谍启示录</h3><p>运行exe，拿到flag。</p>
<h3 id="我吃三明治"><a href="#我吃三明治" class="headerlink" title="我吃三明治"></a>我吃三明治</h3><p>binwalk分析</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">steady@steady:~/桌面/steady$ binwalk /home/steady/桌面/steady/flag.jpg</span><br><span class="line"></span><br><span class="line">DECIMAL       HEXADECIMAL     DESCRIPTION</span><br><span class="line">--------------------------------------------------------------------------------</span><br><span class="line"><span class="number">0</span>             <span class="number">0x0</span>             JPEG image data, JFIF standard <span class="number">1.01</span></span><br><span class="line"><span class="number">37475</span>         <span class="number">0x9263</span>          JPEG image data, JFIF standard <span class="number">1.01</span></span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">strings 1.jpg</span><br></pre></td></tr></table></figure>

<p>发现一串字符。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">MZWGCZ33GZTDCNZZG5SDIMBYGBRDEOLCGY2GIYJVHA4TONZYGA2DMM3FGMYH2</span><br></pre></td></tr></table></figure>

<p>base32解密。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">import base64</span><br><span class="line"> </span><br><span class="line">print base64.b32encode(&quot;hello world&quot;)</span><br><span class="line">print base64.b32decode(&quot;MZWGCZ33GZTDCNZZG5SDIMBYGBRDEOLCGY2GIYJVHA4TONZYGA2DMM3FGMYH2&#x3D;&#x3D;&#x3D;&quot;)</span><br></pre></td></tr></table></figure>

<p>base32解密一定要注意后面=的个数。</p>
<h3 id="DDCTF2018-╯°□°）╯︵-┻━┻"><a href="#DDCTF2018-╯°□°）╯︵-┻━┻" class="headerlink" title="[DDCTF2018](╯°□°）╯︵ ┻━┻"></a>[DDCTF2018](╯°□°）╯︵ ┻━┻</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">(╯°□°）╯︵ ┻━┻</span><br><span class="line">50pt</span><br><span class="line"></span><br><span class="line">(╯°□°）╯︵ ┻━┻</span><br><span class="line"></span><br><span class="line">d4e8e1f4a0f7e1f3a0e6e1f3f4a1a0d4e8e5a0e6ece1e7a0e9f3baa0c4c4c3d4c6fbb9b2b2e1e2b9b9b7b4e1b4b7e3e4b3b2b2e3e6b4b3e2b5b0b6b1b0e6e1e5e1b5fd</span><br></pre></td></tr></table></figure>

<p>长度为<code>134</code>的字符串，按每两位截取的十六进制</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[&#39;d4&#39;, &#39;e8&#39;, &#39;e1&#39;, &#39;f4&#39;, &#39;a0&#39;, &#39;f7&#39;, &#39;e1&#39;, &#39;f3&#39;, &#39;a0&#39;, &#39;e6&#39;, &#39;e1&#39;, &#39;f3&#39;, &#39;f4&#39;, &#39;a1&#39;, &#39;a0&#39;, &#39;d4&#39;, &#39;e8&#39;, &#39;e5&#39;, &#39;a0&#39;, &#39;e6&#39;, &#39;ec&#39;, &#39;e1&#39;, &#39;e7&#39;, &#39;a0&#39;, &#39;e9&#39;, &#39;f3&#39;, &#39;ba&#39;, &#39;a0&#39;, &#39;c4&#39;, &#39;c4&#39;, &#39;c3&#39;, &#39;d4&#39;, &#39;c6&#39;, &#39;fb&#39;, &#39;b9&#39;, &#39;b2&#39;, &#39;b2&#39;, &#39;e1&#39;, &#39;e2&#39;, &#39;b9&#39;, &#39;b9&#39;, &#39;b7&#39;, &#39;b4&#39;, &#39;e1&#39;, &#39;b4&#39;, &#39;b7&#39;, &#39;e3&#39;, &#39;e4&#39;, &#39;b3&#39;, &#39;b2&#39;, &#39;b2&#39;, &#39;e3&#39;, &#39;e6&#39;, &#39;b4&#39;, &#39;b3&#39;, &#39;e2&#39;, &#39;b5&#39;, &#39;b0&#39;, &#39;b6&#39;, &#39;b1&#39;, &#39;b0&#39;, &#39;e6&#39;, &#39;e1&#39;, &#39;e5&#39;, &#39;e1&#39;, &#39;b5&#39;, &#39;fd&#39;]</span><br><span class="line">1</span><br></pre></td></tr></table></figure>

<p>转换为10进制</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[212, 232, 225, 244, 160, 247, 225, 243, 160, 230, 225, 243, 244, 161, 160, 212, 232, 229, 160, 230, 236, 225, 231, 160, 233, 243, 186, 160, 196, 196, 195, 212, 198, 251, 185, 178, 178, 225, 226, 185, 185, 183, 180, 225, 180, 183, 227, 228, 179, 178, 178, 227, 230, 180, 179, 226, 181, 176, 182, 177, 176, 230, 225, 229, 225, 181, 253]</span><br><span class="line">1</span><br></pre></td></tr></table></figure>

<p>可以发现都是大于128的数，把所有数-128得到ASCII码</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[84, 104, 97, 116, 32, 119, 97, 115, 32, 102, 97, 115, 116, 33, 32, 84, 104, 101, 32, 102, 108, 97, 103, 32, 105, 115, 58, 32, 68, 68, 67, 84, 70, 123, 57, 50, 50, 97, 98, 57, 57, 55, 52, 97, 52, 55, 99, 100, 51, 50, 50, 99, 102, 52, 51, 98, 53, 48, 54, 49, 48, 102, 97, 101, 97, 53, 125]</span><br><span class="line">1</span><br></pre></td></tr></table></figure>

<p>ASCII码转换为字符</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">That was fast! The flag is: DDCTF&#123;922ab9974a47cd322cf43b50610faea5&#125;</span><br></pre></td></tr></table></figure>

<h3 id="百里挑一"><a href="#百里挑一" class="headerlink" title="百里挑一"></a>百里挑一</h3><p>流量分析。导出http，许多图片。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">steady@steady:~/桌面/steady/CTF$ exiftool * | grep <span class="string">&quot;flag&quot;</span></span><br><span class="line">XP Comment                      : 恭喜你！找到一半了，还有另一半哦！flag&#123;ae58d0408e26e8f</span><br></pre></td></tr></table></figure>

<p>另一个在tcp流中找到。</p>
<h3 id="WUSTCTF2020-alison-likes-jojo"><a href="#WUSTCTF2020-alison-likes-jojo" class="headerlink" title="[WUSTCTF2020]alison_likes_jojo"></a>[WUSTCTF2020]alison_likes_jojo</h3><p>As we known, Alison is a pretty girl。</p>
<p>在boki.jpg中发现zip，用binwalk命令分离<br>暴力破解后得到：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">WVRKc2MySkhWbmxqV0Zac1dsYzBQUT09</span><br></pre></td></tr></table></figure>

<p>base64 decode后得到：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">killerqueen</span><br></pre></td></tr></table></figure>

<p>jljy.jpg，outguess隐写</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">outguess -k &quot;killerqueen&quot; -r jljy.jpg out.txt</span><br></pre></td></tr></table></figure>

<h3 id="安洵杯-2019-Attack"><a href="#安洵杯-2019-Attack" class="headerlink" title="[安洵杯 2019]Attack"></a>[安洵杯 2019]Attack</h3><p>流量包，导出http对象。其中有一个<code>lsass.dmp</code>，分析流量发现使用了。procdump.exe这个工具。该工具一般用来抓取windows的lsass进程中的用户明文密码。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">lsass.exe是一个系统重要进程，用于微软Windows系统的安全机制。它用于本地安全和登陆策略。</span><br></pre></td></tr></table></figure>

<p>获取里面的系统administrator密码，使用<code>mimikatz</code>。</p>
<h3 id="USB"><a href="#USB" class="headerlink" title="USB"></a>USB</h3><p>其中一个文件binwalk分析。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">steady@steady:~/桌面/steady$ binwalk -e /home/steady/桌面/steady/key.ftm</span><br><span class="line"></span><br><span class="line">DECIMAL       HEXADECIMAL     DESCRIPTION</span><br><span class="line">--------------------------------------------------------------------------------</span><br><span class="line"><span class="number">34741</span>         <span class="number">0x87B5</span>          Zip archive data, at least v2<span class="number">.0</span> to extract, compressed size: <span class="number">4478</span>, uncompressed size: <span class="number">37254</span>, name: key.pcap</span><br><span class="line"><span class="number">39347</span>         <span class="number">0x99B3</span>          End of Zip archive, footer length: <span class="number">22</span></span><br><span class="line"><span class="number">40037</span>         <span class="number">0x9C65</span>          Zip archive data, at least v2<span class="number">.0</span> to extract, compressed size: <span class="number">4478</span>, uncompressed size: <span class="number">37254</span>, name: key.pcap</span><br><span class="line"><span class="number">44643</span>         <span class="number">0xAE63</span>          End of Zip archive, footer length: <span class="number">22</span></span><br></pre></td></tr></table></figure>

<p>提示usb，就是usb流量。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tshark.exe -r C:\Users\12521\Desktop\key.pcap -T fields -e usb.capdata &gt;flag.txt</span><br></pre></td></tr></table></figure>

<p>使用脚本提取信息，有冒号–<code>int(line[6:8]</code>，如果没有冒号，<code>int(line[4:6])</code>。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">mappings = &#123; <span class="number">0x04</span>:<span class="string">&quot;A&quot;</span>,  <span class="number">0x05</span>:<span class="string">&quot;B&quot;</span>,  <span class="number">0x06</span>:<span class="string">&quot;C&quot;</span>, <span class="number">0x07</span>:<span class="string">&quot;D&quot;</span>, <span class="number">0x08</span>:<span class="string">&quot;E&quot;</span>, <span class="number">0x09</span>:<span class="string">&quot;F&quot;</span>, <span class="number">0x0A</span>:<span class="string">&quot;G&quot;</span>,  <span class="number">0x0B</span>:<span class="string">&quot;H&quot;</span>, <span class="number">0x0C</span>:<span class="string">&quot;I&quot;</span>,  <span class="number">0x0D</span>:<span class="string">&quot;J&quot;</span>, <span class="number">0x0E</span>:<span class="string">&quot;K&quot;</span>, <span class="number">0x0F</span>:<span class="string">&quot;L&quot;</span>, <span class="number">0x10</span>:<span class="string">&quot;M&quot;</span>, <span class="number">0x11</span>:<span class="string">&quot;N&quot;</span>,<span class="number">0x12</span>:<span class="string">&quot;O&quot;</span>,  <span class="number">0x13</span>:<span class="string">&quot;P&quot;</span>, <span class="number">0x14</span>:<span class="string">&quot;Q&quot;</span>, <span class="number">0x15</span>:<span class="string">&quot;R&quot;</span>, <span class="number">0x16</span>:<span class="string">&quot;S&quot;</span>, <span class="number">0x17</span>:<span class="string">&quot;T&quot;</span>, <span class="number">0x18</span>:<span class="string">&quot;U&quot;</span>,<span class="number">0x19</span>:<span class="string">&quot;V&quot;</span>, <span class="number">0x1A</span>:<span class="string">&quot;W&quot;</span>, <span class="number">0x1B</span>:<span class="string">&quot;X&quot;</span>, <span class="number">0x1C</span>:<span class="string">&quot;Y&quot;</span>, <span class="number">0x1D</span>:<span class="string">&quot;Z&quot;</span>, <span class="number">0x1E</span>:<span class="string">&quot;1&quot;</span>, <span class="number">0x1F</span>:<span class="string">&quot;2&quot;</span>, <span class="number">0x20</span>:<span class="string">&quot;3&quot;</span>, <span class="number">0x21</span>:<span class="string">&quot;4&quot;</span>, <span class="number">0x22</span>:<span class="string">&quot;5&quot;</span>,  <span class="number">0x23</span>:<span class="string">&quot;6&quot;</span>, <span class="number">0x24</span>:<span class="string">&quot;7&quot;</span>, <span class="number">0x25</span>:<span class="string">&quot;8&quot;</span>, <span class="number">0x26</span>:<span class="string">&quot;9&quot;</span>, <span class="number">0x27</span>:<span class="string">&quot;0&quot;</span>, <span class="number">0x28</span>:<span class="string">&quot;\n&quot;</span>, <span class="number">0x2a</span>:<span class="string">&quot;[DEL]&quot;</span>,  <span class="number">0X2B</span>:<span class="string">&quot;    &quot;</span>, <span class="number">0x2C</span>:<span class="string">&quot; &quot;</span>,  <span class="number">0x2D</span>:<span class="string">&quot;-&quot;</span>, <span class="number">0x2E</span>:<span class="string">&quot;=&quot;</span>, <span class="number">0x2F</span>:<span class="string">&quot;[&quot;</span>,  <span class="number">0x30</span>:<span class="string">&quot;]&quot;</span>,  <span class="number">0x31</span>:<span class="string">&quot;\\&quot;</span>, <span class="number">0x32</span>:<span class="string">&quot;~&quot;</span>, <span class="number">0x33</span>:<span class="string">&quot;;&quot;</span>,  <span class="number">0x34</span>:<span class="string">&quot;&#x27;&quot;</span>, <span class="number">0x36</span>:<span class="string">&quot;,&quot;</span>,  <span class="number">0x37</span>:<span class="string">&quot;.&quot;</span> &#125;</span><br><span class="line"></span><br><span class="line">nums = []</span><br><span class="line">keys = open(<span class="string">&#x27;out.txt&#x27;</span>)</span><br><span class="line"><span class="keyword">for</span> line <span class="keyword">in</span> keys:</span><br><span class="line">    <span class="keyword">if</span> line[<span class="number">0</span>]!=<span class="string">&#x27;0&#x27;</span> <span class="keyword">or</span> line[<span class="number">1</span>]!=<span class="string">&#x27;0&#x27;</span> <span class="keyword">or</span> line[<span class="number">3</span>]!=<span class="string">&#x27;0&#x27;</span> <span class="keyword">or</span> line[<span class="number">4</span>]!=<span class="string">&#x27;0&#x27;</span> <span class="keyword">or</span> line[<span class="number">9</span>]!=<span class="string">&#x27;0&#x27;</span> <span class="keyword">or</span> line[<span class="number">10</span>]!=<span class="string">&#x27;0&#x27;</span> <span class="keyword">or</span> line[<span class="number">12</span>]!=<span class="string">&#x27;0&#x27;</span> <span class="keyword">or</span> line[<span class="number">13</span>]!=<span class="string">&#x27;0&#x27;</span> <span class="keyword">or</span> line[<span class="number">15</span>]!=<span class="string">&#x27;0&#x27;</span> <span class="keyword">or</span> line[<span class="number">16</span>]!=<span class="string">&#x27;0&#x27;</span> <span class="keyword">or</span> line[<span class="number">18</span>]!=<span class="string">&#x27;0&#x27;</span> <span class="keyword">or</span> line[<span class="number">19</span>]!=<span class="string">&#x27;0&#x27;</span> <span class="keyword">or</span> line[<span class="number">21</span>]!=<span class="string">&#x27;0&#x27;</span> <span class="keyword">or</span> line[<span class="number">22</span>]!=<span class="string">&#x27;0&#x27;</span>:</span><br><span class="line">        <span class="keyword">continue</span></span><br><span class="line">    nums.append(int(line[<span class="number">6</span>:<span class="number">8</span>],<span class="number">16</span>))</span><br><span class="line"></span><br><span class="line">keys.close()</span><br><span class="line"></span><br><span class="line">output = <span class="string">&quot;&quot;</span></span><br><span class="line"><span class="keyword">for</span> n <span class="keyword">in</span> nums:</span><br><span class="line">    <span class="keyword">if</span> n == <span class="number">0</span> :</span><br><span class="line">        <span class="keyword">continue</span></span><br><span class="line">    <span class="keyword">if</span> n <span class="keyword">in</span> mappings:</span><br><span class="line">        output += mappings[n]</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        output += <span class="string">&#x27;[unknown]&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">print</span> <span class="string">&#x27;output :\n&#x27;</span> + output</span><br></pre></td></tr></table></figure>

<p>得到 KEYXINAN<br>维吉尼亚密码：key=<code>XINAN</code>， message = <code>ci&#123;v3erf_0tygidv2_fc0&#125;</code></p>
<p>栅栏密码解密。</p>

      
    </div>
    <div class="article-footer">
      <blockquote class="mt-2x">
  <ul class="post-copyright list-unstyled">
    
    <li class="post-copyright-link hidden-xs">
      <strong>本文链接：</strong>
      <a href="http://s1eady.top/2020/10/16/CTF-%E6%9D%82%E9%A1%B9%E5%88%B7%E9%A2%981/" title="CTF-杂项刷题2" target="_blank" rel="external">http://s1eady.top/2020/10/16/CTF-%E6%9D%82%E9%A1%B9%E5%88%B7%E9%A2%981/</a>
    </li>
    
    <li class="post-copyright-license">
      <strong>版权声明： </strong> 本博客所有文章除特别声明外，均采用 <a href="http://creativecommons.org/licenses/by/4.0/deed.zh" target="_blank" rel="external">CC BY 4.0 CN协议</a> 许可协议。转载请注明出处！
    </li>
  </ul>
</blockquote>


<div class="panel panel-default panel-badger">
  <div class="panel-body">
    <figure class="media">
      <div class="media-left">
        <a href="https://github.com/cofess" target="_blank" class="img-burn thumb-sm visible-lg">
          <img src="/images/1.jpg" class="img-rounded w-full" alt="">
        </a>
      </div>
      <div class="media-body">
        <h3 class="media-heading"><a href="https://github.com/cofess" target="_blank"><span class="text-dark">果冻</span><small class="ml-1x">Penetration Testing</small></a></h3>
        <div>一往情深深几许。</div>
      </div>
    </figure>
  </div>
</div>


    </div>
  </article>
  
    
  <section id="comments">
  	
      <div id="vcomments"></div>
    
  </section>


  
</div>

  <nav class="bar bar-footer clearfix" data-stick-bottom>
  <div class="bar-inner">
  
  <ul class="pager pull-left">
    
    <li class="prev">
      <a href="/2020/10/26/CTF-Crypto%E5%88%B7%E9%A2%981/" title="CTF-Crypto刷题1"><i class="icon icon-angle-left" aria-hidden="true"></i><span>&nbsp;&nbsp;上一篇</span></a>
    </li>
    
    
    <li class="next">
      <a href="/2020/10/07/CTF-%E6%9D%82%E9%A1%B9%E5%88%B7%E9%A2%983/" title="CTF-杂项刷题1"><span>下一篇&nbsp;&nbsp;</span><i class="icon icon-angle-right" aria-hidden="true"></i></a>
    </li>
    
    
    <li class="toggle-toc">
      <a class="toggle-btn collapsed" data-toggle="collapse" href="#collapseToc" aria-expanded="false" title="文章目录" role="button">
        <span>[&nbsp;</span><span>文章目录</span>
        <i class="text-collapsed icon icon-anchor"></i>
        <i class="text-in icon icon-close"></i>
        <span>]</span>
      </a>
    </li>
    
  </ul>
  
  
  <!-- Button trigger modal -->
  <button type="button" class="btn btn-fancy btn-donate pop-onhover bg-gradient-warning" data-toggle="modal" data-target="#donateModal"><span>赏</span></button>
  <!-- <div class="wave-icon wave-icon-danger btn-donate" data-toggle="modal" data-target="#donateModal">
    <div class="wave-circle"><span class="icon"><i class="icon icon-bill"></i></span></div>
  </div> -->
  
  
  <div class="bar-right">
    
    <div class="share-component" data-sites="weibo,qq,wechat,facebook,twitter" data-mobile-sites="weibo,qq,qzone"></div>
    
  </div>
  </div>
</nav>
  
<!-- Modal -->
<div class="modal modal-center modal-small modal-xs-full fade" id="donateModal" tabindex="-1" role="dialog">
  <div class="modal-dialog" role="document">
    <div class="modal-content donate">
      <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
      <div class="modal-body">
        <div class="donate-box">
          <div class="donate-head">
            <p>感谢您的支持，我会继续努力的!</p>
          </div>
          <div class="tab-content">
            <div role="tabpanel" class="tab-pane fade active in" id="alipay">
              <div class="donate-payimg">
                <img src="/images/donate/2.png" alt="扫码支持" title="扫一扫" />
              </div>
              <p class="text-muted mv">扫码打赏，你说多少就多少</p>
              <p class="text-grey">打开支付宝扫一扫，即可进行扫码打赏哦</p>
            </div>
            <div role="tabpanel" class="tab-pane fade" id="wechatpay">
              <div class="donate-payimg">
                <img src="/images/donate/1.png" alt="扫码支持" title="扫一扫" />
              </div>
              <p class="text-muted mv">扫码打赏，你说多少就多少</p>
              <p class="text-grey">打开微信扫一扫，即可进行扫码打赏哦</p>
            </div>
          </div>
          <div class="donate-footer">
            <ul class="nav nav-tabs nav-justified" role="tablist">
              <li role="presentation" class="active">
                <a href="#alipay" id="alipay-tab" role="tab" data-toggle="tab" aria-controls="alipay" aria-expanded="true"><i class="icon icon-alipay"></i> 支付宝</a>
              </li>
              <li role="presentation" class="">
                <a href="#wechatpay" role="tab" id="wechatpay-tab" data-toggle="tab" aria-controls="wechatpay" aria-expanded="false"><i class="icon icon-wepay"></i> 微信支付</a>
              </li>
            </ul>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>



</main>

  <footer class="footer" itemscope itemtype="http://schema.org/WPFooter">
	
	
    <ul class="social-links">
    	
        <li><a href="/GXA111666" target="_blank" title="VX" data-toggle=tooltip data-placement=top><i class="icon icon-VX"></i></a></li>
        
        <li><a href="/1252195810" target="_blank" title="QQ" data-toggle=tooltip data-placement=top><i class="icon icon-QQ"></i></a></li>
        
        <li><a href="/1252195810@qq.com" target="_blank" title="E-Mail" data-toggle=tooltip data-placement=top><i class="icon icon-E-mail"></i></a></li>
        
        <li><a href="/atom.xml" target="_blank" title="Rss" data-toggle=tooltip data-placement=top><i class="icon icon-rss"></i></a></li>
        
    </ul>

    <div class="copyright">
    	
        <div class="publishby">
        	Theme by <a href="https://github.com/cofess" target="_blank"> cofess </a>base on <a href="https://github.com/cofess/hexo-theme-pure" target="_blank">pure</a>.
        </div>
    </div>
</footer>
  <script src="//cdn.jsdelivr.net/npm/jquery@1.12.4/dist/jquery.min.js"></script>
<script>
window.jQuery || document.write('<script src="js/jquery.min.js"><\/script>')
</script>

<script src="/js/plugin.min.js"></script>


<script src="/js/application.js"></script>


    <script>
(function (window) {
    var INSIGHT_CONFIG = {
        TRANSLATION: {
            POSTS: '文章',
            PAGES: '页面',
            CATEGORIES: '分类',
            TAGS: '标签',
            UNTITLED: '(未命名)',
        },
        ROOT_URL: '/',
        CONTENT_URL: '/content.json',
    };
    window.INSIGHT_CONFIG = INSIGHT_CONFIG;
})(window);
</script>

<script src="/js/insight.js"></script>






   




   
    
  <script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script>
  <script src="//cdn.jsdelivr.net/npm/valine"></script>
  <script type="text/javascript">
  var GUEST = ['nick', 'mail', 'link'];
  var meta = 'nick,mail,link';
  meta = meta.split(',').filter(function(item) {
    return GUEST.indexOf(item) > -1;
  });
  new Valine({
    el: '#vcomments',
    verify: false,
    notify: false,
    appId: '',
    appKey: '',
    placeholder: 'Just go go',
    avatar: 'mm',
    meta: meta,
    pageSize: '10' || 10,
    visitor: false
  });
  </script>

     







</body>
</html>